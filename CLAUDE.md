# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

---

# ü§ñ –ß—Ç–æ –±—ã–ª–æ –≤ —á–∞—Ç–µ - Telegram Bot

## üìã –û –ø—Ä–æ–µ–∫—Ç–µ

**Telegram –±–æ—Ç –¥–ª—è AI-—Å–∞–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–æ–≤ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –ª–∏—á–Ω–æ—Å—Ç—è–º–∏.**

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫:
- **Backend**: Python 3.11+, Vercel Serverless Functions
- **Database**: Supabase (PostgreSQL)
- **AI**: Claude API (Anthropic)
- **Bot Framework**: python-telegram-bot
- **Deployment**: Vercel (webhook mode)

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ª–∏—á–Ω–æ—Å—Ç–∏ AI (7 –±–∞–∑–æ–≤—ã—Ö + –∫–∞—Å—Ç–æ–º–Ω—ã–µ)
- –ü—Ä—è–º–æ–µ –æ–±—â–µ–Ω–∏–µ —Å –±–æ—Ç–æ–º (direct chat) –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –ª–∏—á–Ω–æ—Å—Ç–∏
- –°–∞–º–º–∞—Ä–∏–∑–∞—Ü–∏—è —á–∞—Ç–æ–≤ –∑–∞ —Ä–∞–∑–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã
- –°—É–¥–µ–π—Å—Ç–≤–æ —Å–ø–æ—Ä–æ–≤ —á–µ—Ä–µ–∑ /rassudi
- –í—ã–±–æ—Ä —á–∞—Ç–æ–≤ –≤ –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
- Inline-–º–µ–Ω—é –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
- –ê–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (3 –¥–Ω—è)
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö (–ø—Ä–æ–≤–µ—Ä–∫–∏ —á–ª–µ–Ω—Å—Ç–≤–∞, HMAC, sanitization)
- **User-friendly –∞–¥–º–∏–Ω–∫–∞** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏, –ø—Ä–æ–º–æ–∫–æ–¥—ã, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—ã –≤ Telegram (–±–µ–∑ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è!)

---

## üó∫Ô∏è CUSTOMER JOURNEY MAP (CJM)

### –û–±—â–∞—è —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è UX:
1. **–ù–µ—Ç –¥–µ—Ñ–æ–ª—Ç–Ω–æ–π –ª–∏—á–Ω–æ—Å—Ç–∏** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å–µ–≥–¥–∞ –¥–µ–ª–∞–µ—Ç –æ—Å–æ–∑–Ω–∞–Ω–Ω—ã–π –≤—ã–±–æ—Ä
2. **–ò–Ω—Ç—Ä–∏–≥—É—é—â–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è** - –ª–∏—á–Ω–æ—Å—Ç–∏ —Å —è—Ä–∫–∏–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞–º–∏
3. **Inline-–º–µ–Ω—é** - –±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º
4. **–ö–æ–Ω—Ç–µ–∫—Å—Ç 3 –¥–Ω—è** - –∏—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
5. **–ü–æ–¥—Å–∫–∞–∑–∫–∏ –≤–µ–∑–¥–µ** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å–µ–≥–¥–∞ –∑–Ω–∞–µ—Ç, —á—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ

---

### –ü—É—Ç—å 1: –õ–∏—á–Ω—ã–π —á–∞—Ç (Direct Chat —Å –±–æ—Ç–æ–º)

#### 1.1 –ü–µ—Ä–≤—ã–π –∫–æ–Ω—Ç–∞–∫—Ç
**–¢—Ä–∏–≥–≥–µ—Ä:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "Start" –∏–ª–∏ –ø–∏—à–µ—Ç /start

**–§–ª–æ—É:**
```
[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å] ‚Üí /start
    ‚Üì
[–ë–æ—Ç] ‚Üí –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ + Inline-–º–µ–Ω—é
    ‚îú‚îÄ üí¨ –û–±—â–∞—Ç—å—Å—è –Ω–∞–ø—Ä—è–º—É—é
    ‚îú‚îÄ üë• –î–æ–±–∞–≤–∏—Ç—å –≤ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç
    ‚îî‚îÄ üé≠ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–∏—á–Ω–æ—Å—Ç—å
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `modules/commands.py:start()` - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
- Inline-–º–µ–Ω—é —á–µ—Ä–µ–∑ `InlineKeyboardMarkup` —Å callback_query
- HMAC –ø–æ–¥–ø–∏—Å—å –¥–ª—è –≤—Å–µ—Ö callback_data

**–¢–µ–∫—Å—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è:**
```
üëã –ü—Ä–∏–≤–µ—Ç! –Ø –±–æ—Ç —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –ª–∏—á–Ω–æ—Å—Ç—è–º–∏.

–Ø –º–æ–≥—É:
‚Ä¢ –û–±—â–∞—Ç—å—Å—è —Å —Ç–æ–±–æ–π –≤ —Ä–∞–∑–Ω—ã—Ö —Å—Ç–∏–ª—è—Ö
‚Ä¢ –°–∞–º–º–∞—Ä–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≥—Ä—É–ø–ø–æ–≤—ã–µ —á–∞—Ç—ã
‚Ä¢ –†–∞—Å—Å—É–∂–∏–≤–∞—Ç—å —Å–ø–æ—Ä—ã

–ß—Ç–æ –±—É–¥–µ–º –¥–µ–ª–∞—Ç—å?
```

#### 1.2 –í—ã–±–æ—Ä "–û–±—â–∞—Ç—å—Å—è –Ω–∞–ø—Ä—è–º—É—é"
**–¢—Ä–∏–≥–≥–µ—Ä:** –ö–ª–∏–∫ –Ω–∞ –∫–Ω–æ–ø–∫—É "üí¨ –û–±—â–∞—Ç—å—Å—è –Ω–∞–ø—Ä—è–º—É—é"

**–§–ª–æ—É:**
```
[–ö–ª–∏–∫] ‚Üí callback_query: "direct_chat"
    ‚Üì
[–ë–æ—Ç] ‚Üí –ú–µ–Ω—é –≤—ã–±–æ—Ä–∞ –ª–∏—á–Ω–æ—Å—Ç–∏ (7 –±–∞–∑–æ–≤—ã—Ö + –∫–∞—Å—Ç–æ–º–Ω—ã–µ)
    ‚îú‚îÄ üè≠ –ë—ã–¥–ª–∞–Ω
    ‚îú‚îÄ üßô –§–∏–ª–æ—Å–æ—Ñ
    ‚îú‚îÄ üëü –ì–æ–ø–Ω–∏–∫
    ‚îú‚îÄ üíº –û–ª–∏–≥–∞—Ä—Ö
    ‚îú‚îÄ üòÇ –°—Ç–µ–Ω–¥–∞–ø–µ—Ä
    ‚îú‚îÄ üî¨ –£—á—ë–Ω—ã–π
    ‚îú‚îÄ üéì –ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π
    ‚îú‚îÄ [–ö–∞—Å—Ç–æ–º–Ω—ã–µ –ª–∏—á–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è]
    ‚îî‚îÄ ‚ûï –°–æ–∑–¥–∞—Ç—å —Å–≤–æ—é –ª–∏—á–Ω–æ—Å—Ç—å
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `modules/direct_chat.py:show_personality_selection()` - –Ω–æ–≤—ã–π –º–æ–¥—É–ª—å
- –ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ –ª–∏—á–Ω–æ—Å—Ç–∏ –∏–∑ –ë–î (–±–∞–∑–æ–≤—ã–µ + –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ)
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤ 2 –∫–æ–ª–æ–Ω–∫–∏ –¥–ª—è –∫–æ–º–ø–∞–∫—Ç–Ω–æ—Å—Ç–∏

#### 1.3 –í—ã–±–æ—Ä –ª–∏—á–Ω–æ—Å—Ç–∏
**–¢—Ä–∏–≥–≥–µ—Ä:** –ö–ª–∏–∫ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –ª–∏—á–Ω–æ—Å—Ç—å

**–§–ª–æ—É:**
```
[–ö–ª–∏–∫] ‚Üí callback_query: "select_personality:bydlan"
    ‚Üì
[–ë–î] ‚Üí –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—ã–±–æ—Ä –≤ user_settings
    ‚Üì
[–ë–æ—Ç] ‚Üí –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –æ—Ç –ª–∏—á–Ω–æ—Å—Ç–∏
```

**–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–π:**

**–ë—ã–¥–ª–∞–Ω:**
```
–ô–æ—É, –±—Ä–∞—Ç–∞–Ω! –ù—É —á–µ, –ø—Ä–∏–µ—Ö–∞–ª–∏? –ß–µ –Ω–∞–¥–æ?
–ù–µ —Å—Ç–æ–π –∫–∞–∫ —Å—Ç–æ–ª–±, –¥–∞–≤–∞–π –±–∞–∑–∞—Ä—å —á—ë –∫ —á–µ–º—É! üè≠
```

**–§–∏–ª–æ—Å–æ—Ñ:**
```
–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é —Ç–µ–±—è, –ø—É—Ç–Ω–∏–∫. –¢—ã –ø—Ä–∏—à—ë–ª –≤ –ø–æ–∏—Å–∫–∞—Ö –∏—Å—Ç–∏–Ω—ã,
–∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –∑–∞–±–ª—É–¥–∏–ª—Å—è –≤ –ª–∞–±–∏—Ä–∏–Ω—Ç–µ –±—ã—Ç–∏—è? üßô
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `modules/direct_chat.py:set_personality()` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞
- `services/db_service.py:update_user_personality()` - –ë–î –æ–ø–µ—Ä–∞—Ü–∏—è
- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `personalities.greeting_message`
- –ï—Å–ª–∏ `greeting_message` NULL ‚Üí –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —á–µ—Ä–µ–∑ Claude API

#### 1.4 –û–±—â–µ–Ω–∏–µ —Å –±–æ—Ç–æ–º
**–¢—Ä–∏–≥–≥–µ—Ä:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

**–§–ª–æ—É:**
```
[–°–æ–æ–±—â–µ–Ω–∏–µ] ‚Üí "–ü—Ä–∏–≤–µ—Ç, –∫–∞–∫ –¥–µ–ª–∞?"
    ‚Üì
[–ë–î] ‚Üí –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ messages
    ‚Üì
[–ë–î] ‚Üí –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ N —Å–æ–æ–±—â–µ–Ω–∏–π (–∫–æ–Ω—Ç–µ–∫—Å—Ç)
    ‚Üì
[Claude API] ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ –≤ —Å—Ç–∏–ª–µ –ª–∏—á–Ω–æ—Å—Ç–∏
    ‚Üì
[–ë–æ—Ç] ‚Üí –û—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    ‚Üì
[–ë–î] ‚Üí –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Ç–≤–µ—Ç –±–æ—Ç–∞ –≤ messages
```

**–ö–æ–Ω—Ç–µ–∫—Å—Ç –∏ –ª–∏–º–∏—Ç—ã:**
- –•—Ä–∞–Ω–∏–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –¥–Ω—è —Å–æ–æ–±—â–µ–Ω–∏–π (–∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞)
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20-30 —Å–æ–æ–±—â–µ–Ω–∏–π
- –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ —Ç–æ–∫–µ–Ω–æ–≤ ‚Üí —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `modules/direct_chat.py:handle_message()` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
- `services/ai_service.py:generate_chat_response()` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
- `services/db_service.py:get_chat_history()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏

#### 1.5 –°–º–µ–Ω–∞ –ª–∏—á–Ω–æ—Å—Ç–∏
**–¢—Ä–∏–≥–≥–µ—Ä:** –ö–æ–º–∞–Ω–¥–∞ /lichnost –∏–ª–∏ –∫–Ω–æ–ø–∫–∞ –≤ –º–µ–Ω—é

**–§–ª–æ—É:**
```
[–ö–æ–º–∞–Ω–¥–∞] ‚Üí /lichnost
    ‚Üì
[–ë–æ—Ç] ‚Üí –ú–µ–Ω—é –ª–∏—á–Ω–æ—Å—Ç–µ–π (–∫–∞–∫ –≤ 1.2)
    ‚Üì
[–í—ã–±–æ—Ä] ‚Üí –ù–æ–≤–∞—è –ª–∏—á–Ω–æ—Å—Ç—å
    ‚Üì
[–ë–æ—Ç] ‚Üí "–õ–∏—á–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∞ –Ω–∞ [–Ω–∞–∑–≤–∞–Ω–∏–µ]. –ò—Å—Ç–æ—Ä–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞."
    ‚Üì
[–î–∞–ª—å–Ω–µ–π—à–µ–µ –æ–±—â–µ–Ω–∏–µ] ‚Üí –í –Ω–æ–≤–æ–π –ª–∏—á–Ω–æ—Å—Ç–∏ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- –ò—Å—Ç–æ—Ä–∏—è –ù–ï –æ—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–º–µ–Ω–µ –ª–∏—á–Ω–æ—Å—Ç–∏
- –ü—Ä–æ—Å—Ç–æ –º–µ–Ω—è–µ—Ç—Å—è system_prompt –¥–ª—è Claude API
- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç: "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–º–µ–Ω–∏–ª –ª–∏—á–Ω–æ—Å—Ç—å –Ω–∞ X"

#### 1.6 –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–π –ª–∏—á–Ω–æ—Å—Ç–∏
**–¢—Ä–∏–≥–≥–µ—Ä:** –ö–ª–∏–∫ –Ω–∞ "‚ûï –°–æ–∑–¥–∞—Ç—å —Å–≤–æ—é –ª–∏—á–Ω–æ—Å—Ç—å"

**–§–ª–æ—É:**
```
[–ö–ª–∏–∫] ‚Üí callback_query: "create_personality"
    ‚Üì
[–ë–æ—Ç] ‚Üí "–û–ø–∏—à–∏ —Å—Ç–∏–ª—å –ª–∏—á–Ω–æ—Å—Ç–∏ (10-1500 —Å–∏–º–≤–æ–ª–æ–≤):"
    ‚Üì
[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å] ‚Üí "–ì—Ä—É–±—ã–π –º–∞—Ç–µ–º–∞—Ç–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –æ–±—ä—è—Å–Ω—è–µ—Ç —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É–ª—ã"
    ‚Üì
[–í–∞–ª–∏–¥–∞—Ü–∏—è] ‚Üí Sanitization + –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤
    ‚Üì
[–ë–æ—Ç] ‚Üí "–î–∞–π –∏–º—è –ª–∏—á–Ω–æ—Å—Ç–∏:"
    ‚Üì
[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å] ‚Üí "–ú–∞—Ç–µ–º–∞—Ç–∏–∫-–≥—Ä—É–±–∏—è–Ω"
    ‚Üì
[–ë–î] ‚Üí –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ personalities (is_custom=true)
    ‚Üì
[–ë–æ—Ç] ‚Üí –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –æ—Ç –Ω–æ–≤–æ–π –ª–∏—á–Ω–æ—Å—Ç–∏ (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ Claude)
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `modules/personalities.py` - ConversationHandler –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è
- –õ–∏–º–∏—Ç: 5 –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ª–∏—á–Ω–æ—Å—Ç–µ–π –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- Sanitization –æ—Ç prompt injection
- –ó–∞–ø—Ä–µ—Ç –∏–º—ë–Ω —Ä–µ–∞–ª—å–Ω—ã—Ö –ª—é–¥–µ–π/–±—Ä–µ–Ω–¥–æ–≤

---

### –ü—É—Ç—å 2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç

#### 2.1 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø—É
**–¢—Ä–∏–≥–≥–µ—Ä:** –ö–ª–∏–∫ –Ω–∞ "üë• –î–æ–±–∞–≤–∏—Ç—å –≤ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç"

**–§–ª–æ—É:**
```
[–ö–ª–∏–∫] ‚Üí callback_query: "add_to_group"
    ‚Üì
[–ë–æ—Ç] ‚Üí CTA-—Å–æ–æ–±—â–µ–Ω–∏–µ —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º –ø–æ–ª—å–∑—ã
    + Inline-–∫–Ω–æ–ø–∫–∞ "–î–æ–±–∞–≤–∏—Ç—å –≤ –≥—Ä—É–ø–ø—É" (URL)
    ‚Üì
[–ö–ª–∏–∫] ‚Üí Telegram –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—ã–±–æ—Ä –≥—Ä—É–ø–ø—ã
    ‚Üì
[–î–æ–±–∞–≤–ª–µ–Ω–∏–µ] ‚Üí –ë–æ—Ç –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ "my_chat_member"
    ‚Üì
[–ë–î] ‚Üí –°–æ—Ö—Ä–∞–Ω–∏—Ç—å chat_metadata
    ‚Üì
[–ë–æ—Ç] ‚Üí Welcome-—Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø–µ
```

**CTA-—Å–æ–æ–±—â–µ–Ω–∏–µ:**
```
üéâ –î–æ–±–∞–≤—å –º–µ–Ω—è –≤ —Å–≤–æ—é –≥—Ä—É–ø–ø—É!

–Ø —Å–º–æ–≥—É:
‚úÖ –°–∞–º–º–∞—Ä–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±—Å—É–∂–¥–µ–Ω–∏—è
‚úÖ –†–∞—Å—Å—É–∂–∏–≤–∞—Ç—å —Å–ø–æ—Ä—ã
‚úÖ –û–±—â–∞—Ç—å—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö —Å—Ç–∏–ª—è—Ö

üí° –î–∞–π –º–Ω–µ –∞–¥–º–∏–Ω-–ø—Ä–∞–≤–∞ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞!

[–ö–Ω–æ–ø–∫–∞: –î–æ–±–∞–≤–∏—Ç—å –≤ –≥—Ä—É–ø–ø—É ‚Üí]
```

**URL –¥–ª—è –∫–Ω–æ–ø–∫–∏:**
```
https://t.me/YourBot?startgroup=true
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `modules/onboarding.py:show_add_to_group()` - –Ω–æ–≤—ã–π –º–æ–¥—É–ª—å
- `api/index.py:handle_my_chat_member()` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
- `services/db_service.py:create_chat_metadata()` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ

#### 2.2 Welcome-—Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø–µ
**–¢—Ä–∏–≥–≥–µ—Ä:** –ë–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ –≥—Ä—É–ø–ø—É

**–§–ª–æ—É:**
```
[–°–æ–±—ã—Ç–∏–µ] ‚Üí "my_chat_member" (status: member/administrator)
    ‚Üì
[–ë–î] ‚Üí –°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å –≤ chat_metadata
    ‚Üì
[–ë–æ—Ç] ‚Üí Welcome-—Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ + GIF/–∫–∞—Ä—Ç–∏–Ω–∫–∞
```

**Welcome-—Å–æ–æ–±—â–µ–Ω–∏–µ:**
```
üëã –ü—Ä–∏–≤–µ—Ç, –Ω–∞—Ä–æ–¥!

–Ø –∑–¥–µ—Å—å, —á—Ç–æ–±—ã –ø–æ–º–æ—á—å! –í–æ—Ç —á—Ç–æ —è —É–º–µ—é:

üìù /summary - –°–∞–º–º–∞—Ä–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±—Å—É–∂–¥–µ–Ω–∏—è
‚öñÔ∏è /rassudi - –†–∞—Å—Å—É–¥–∏—Ç—å —Å–ø–æ—Ä
üí¨ /chat - –ü–æ–æ–±—â–∞—Ç—å—Å—è –≤ –≥—Ä—É–ø–ø–µ

üí° –î–∞–π—Ç–µ –º–Ω–µ –∞–¥–º–∏–Ω-–ø—Ä–∞–≤–∞, —á—Ç–æ–±—ã —è –º–æ–≥:
‚Ä¢ –ß–∏—Ç–∞—Ç—å –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π
‚Ä¢ –£–¥–∞–ª—è—Ç—å —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)

–ö–æ–º–∞–Ω–¥—ã: /help
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `modules/onboarding.py:send_group_welcome()`
- –ö–∞—Ä—Ç–∏–Ω–∫–∞/GIF —Ö—Ä–∞–Ω–∏—Ç—Å—è –∫–∞–∫ file_id –≤ config.py
- –ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ –±–æ—Ç —É–∂–µ –±—ã–ª –≤ –≥—Ä—É–ø–ø–µ ‚Üí –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å welcome

#### 2.3 –†–∞–±–æ—Ç–∞ —Å –∫–æ–º–∞–Ω–¥–∞–º–∏ –≤ –≥—Ä—É–ø–ø–µ

##### –ö–æ–º–∞–Ω–¥–∞ /summary (–∞–Ω–∞–ª–æ–≥ /sut)
**–¢—Ä–∏–≥–≥–µ—Ä:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç `/summary` –∏–ª–∏ `/summary 100`

**–§–ª–æ—É:**
```
[–ö–æ–º–∞–Ω–¥–∞] ‚Üí /summary [–ø–∞—Ä–∞–º–µ—Ç—Ä]
    ‚Üì
[–ü—Ä–æ–≤–µ—Ä–∫–∏] ‚Üí
    ‚îú‚îÄ Cooldown (60 —Å–µ–∫ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–∞–º–º–∞—Ä–∏)
    ‚îú‚îÄ Rate limiting (10 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω –Ω–∞ —á–∞—Ç)
    ‚îî‚îÄ –ß–ª–µ–Ω—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —á–∞—Ç–µ
    ‚Üì
[–ë–æ—Ç] ‚Üí –ú–µ–Ω—é –≤—ã–±–æ—Ä–∞ –ª–∏—á–Ω–æ—Å—Ç–∏ (inline-–∫–Ω–æ–ø–∫–∏)
    ‚Üì
[–í—ã–±–æ—Ä] ‚Üí callback_query: "summary_personality:bydlan:100"
    ‚Üì
[–ë–î] ‚Üí –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ N —Å–æ–æ–±—â–µ–Ω–∏–π
    ‚Üì
[Claude API] ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∞–º–º–∞—Ä–∏ –≤ —Å—Ç–∏–ª–µ –ª–∏—á–Ω–æ—Å—Ç–∏
    ‚Üì
[–ë–æ—Ç] ‚Üí –û—Ç–≤–µ—Ç –≤ —á–∞—Ç
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `/summary` - –ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å–æ–æ–±—â–µ–Ω–∏–π (–¥–µ—Ñ–æ–ª—Ç)
- `/summary 100` - –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å–æ–æ–±—â–µ–Ω–∏–π
- `/summary 2h` - –ø–æ—Å–ª–µ–¥–Ω–∏–µ 2 —á–∞—Å–∞
- `/summary today` - —Å –Ω–∞—á–∞–ª–∞ –¥–Ω—è

**Inline-–º–µ–Ω—é –ª–∏—á–Ω–æ—Å—Ç–µ–π:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üè≠ –ë—ã–¥–ª–∞–Ω ‚îÇ üßô –§–∏–ª–æ—Å–æ—Ñ ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üëü –ì–æ–ø–Ω–∏–∫ ‚îÇ üíº –û–ª–∏–≥–∞—Ä—Ö ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üòÇ –ö–æ–º–∏–∫  ‚îÇ üî¨ –£—á—ë–Ω—ã–π ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `modules/summaries.py:handle_summary_command()` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
- –û—Ç–ª–∏—á–∏–µ –æ—Ç /sut: –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –º–µ–Ω—é –ª–∏—á–Ω–æ—Å—Ç–µ–π —Å—Ä–∞–∑—É –≤ –≥—Ä—É–ø–ø–µ
- HMAC –ø–æ–¥–ø–∏—Å—å –¥–ª—è callback_data
- Callback —Å–æ–¥–µ—Ä–∂–∏—Ç: personality + –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ/–ø–µ—Ä–∏–æ–¥)

##### –ö–æ–º–∞–Ω–¥–∞ /chat
**–¢—Ä–∏–≥–≥–µ—Ä:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç `/chat` –≤ –≥—Ä—É–ø–ø–µ

**–§–ª–æ—É:**
```
[–ö–æ–º–∞–Ω–¥–∞] ‚Üí /chat
    ‚Üì
[–ü—Ä–æ–≤–µ—Ä–∫–∏] ‚Üí
    ‚îú‚îÄ –£–∂–µ –∞–∫—Ç–∏–≤–Ω–∞ —Å–µ—Å—Å–∏—è –¥–ª—è —ç—Ç–æ–≥–æ —é–∑–µ—Ä–∞?
    ‚îî‚îÄ Cooldown –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (30 —Å–µ–∫)
    ‚Üì
[–ë–æ—Ç] ‚Üí –ú–µ–Ω—é –≤—ã–±–æ—Ä–∞ –ª–∏—á–Ω–æ—Å—Ç–∏
    ‚Üì
[–í—ã–±–æ—Ä] ‚Üí callback_query: "start_chat:bydlan"
    ‚Üì
[–ë–î] ‚Üí –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—É—é —Å–µ—Å—Å–∏—é (user_id + chat_id + personality)
    ‚Üì
[–ë–æ—Ç] ‚Üí "–ü—Ä–∏–≤–µ—Ç –æ—Ç [–ª–∏—á–Ω–æ—Å—Ç—å]! –ü–∏—à–∏ –º–Ω–µ —á–µ—Ä–µ–∑ reply –∏–ª–∏ —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ."
    ‚Üì
[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å] ‚Üí –ü–∏—à–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ (reply –∏–ª–∏ @bot)
    ‚Üì
[–û–±—Ä–∞–±–æ—Ç–∫–∞] ‚Üí –¢–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏—è —ç—Ç–æ–≥–æ —é–∑–µ—Ä–∞ ‚Üí –æ—Ç–≤–µ—Ç –±–æ—Ç–∞
    ‚Üì
[–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ] ‚Üí –ö–æ–º–∞–Ω–¥–∞ /stop –∏–ª–∏ —Ç–∞–π–º–∞—É—Ç 15 –º–∏–Ω—É—Ç
```

**–ê–∫—Ç–∏–≤–Ω–∞—è —Å–µ—Å—Å–∏—è:**
- –•—Ä–∞–Ω–∏—Ç—Å—è –≤ `bot_data` (in-memory) –∏–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ `active_chat_sessions`
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞: `{user_id: {chat_id, personality, started_at, last_activity}}`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 15 –º–∏–Ω—É—Ç –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `modules/direct_chat.py:start_group_chat_session()` - –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è
- `modules/direct_chat.py:handle_group_chat_message()` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π
- –§–∏–ª—å—Ç—Ä: —Ç–æ–ª—å–∫–æ reply –Ω–∞ –±–æ—Ç–∞ –∏–ª–∏ @mention
- –ö–æ–Ω—Ç–µ–∫—Å—Ç: –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10-15 —Å–æ–æ–±—â–µ–Ω–∏–π —Å–µ—Å—Å–∏–∏

##### –ö–æ–º–∞–Ω–¥–∞ /rassudi
**–¢—Ä–∏–≥–≥–µ—Ä:** `/rassudi @user1 @user2 –ö—Ç–æ –ø—Ä–∞–≤ –≤ —Å–ø–æ—Ä–µ?`

**–§–ª–æ—É:**
```
[–ö–æ–º–∞–Ω–¥–∞] ‚Üí /rassudi @user1 @user2 [–æ–ø–∏—Å–∞–Ω–∏–µ]
    ‚Üì
[–í–∞–ª–∏–¥–∞—Ü–∏—è] ‚Üí
    ‚îú‚îÄ –ï—Å—Ç—å –ª–∏ —É–ø–æ–º—è–Ω—É—Ç—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏?
    ‚îú‚îÄ –ï—Å—Ç—å –ª–∏ –æ–ø–∏—Å–∞–Ω–∏–µ —Å–ø–æ—Ä–∞?
    ‚îî‚îÄ Cooldown (60 —Å–µ–∫)
    ‚Üì
[–ë–æ—Ç] ‚Üí –ú–µ–Ω—é –≤—ã–±–æ—Ä–∞ –ª–∏—á–Ω–æ—Å—Ç–∏
    ‚Üì
[–í—ã–±–æ—Ä] ‚Üí callback_query: "judge_personality:bydlan:user1:user2"
    ‚Üì
[–ë–î] ‚Üí –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç @user1 –∏ @user2
    ‚Üì
[Claude API] ‚Üí –ê–Ω–∞–ª–∏–∑ + –≤–µ—Ä–¥–∏–∫—Ç –≤ —Å—Ç–∏–ª–µ –ª–∏—á–Ω–æ—Å—Ç–∏
    ‚Üì
[–ë–æ—Ç] ‚Üí –í–µ—Ä–¥–∏–∫—Ç –≤ —á–∞—Ç
```

**–§–æ—Ä–º–∞—Ç –≤–µ—Ä–¥–∏–∫—Ç–∞ (–ø—Ä–∏–º–µ—Ä "–ë—ã–¥–ª–∞–Ω"):**
```
‚öñÔ∏è –í–ï–†–î–ò–ö–¢ –û–¢ –ë–´–î–õ–ê–ù–ê:

–ù—É –∫–æ—Ä–æ—á–µ —Ç–∞–∫, –ø–∞—Ü–∞–Ω—ã...

@user1 - –±–∞–∑–∞—Ä–∏—Ç –æ–¥–Ω–æ, –Ω–æ –≤ —Å–∞–º–æ–º –¥–µ–ª–µ —Ö*—ë–≤–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∏—Ç.
@user2 - –≤—Ä–æ–¥–µ –ø–æ –¥–µ–ª—É, –Ω–æ —Ç–æ–∂–µ —Ö—É–π–Ω—é –Ω–µ—Å—ë—Ç.

–ò–¢–û–ì: –û–±–∞ –∫–ª–æ—É–Ω—ã, –Ω–æ @user2 —á—É—Ç—å –º–µ–Ω—å—à–µ.

üè≠ –ë—ã–¥–ª–∞–Ω –ø–æ—Å—Ç–∞–Ω–æ–≤–∏–ª. –ë–∞–∑–∞—Ä–∞ –Ω–µ—Ç.
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `modules/judge.py:handle_judge_command()` - —É–∂–µ –µ—Å—Ç—å
- –î–æ–±–∞–≤–∏—Ç—å –º–µ–Ω—é –ª–∏—á–Ω–æ—Å—Ç–µ–π –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π
- –ü–∞—Ä—Å–∏–Ω–≥ @username –∏–∑ —Ç–µ–∫—Å—Ç–∞ –∫–æ–º–∞–Ω–¥—ã
- –§–æ—Ä–º–∞—Ç callback: `judge:personality:user_ids_hash`

#### 2.4 –ö–æ–º–∞–Ω–¥—ã —á–µ—Ä–µ–∑ —Å–ª—ç—à-–º–µ–Ω—é
**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ BotFather:**

```
/setcommands

start - –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
help - –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
summary - –°–∞–º–º–∞—Ä–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±—Å—É–∂–¥–µ–Ω–∏–µ
chat - –ù–∞—á–∞—Ç—å –æ–±—â–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø–µ
rassudi - –†–∞—Å—Å—É–¥–∏—Ç—å —Å–ø–æ—Ä
lichnost - –í—ã–±—Ä–∞—Ç—å/—Å–æ–∑–¥–∞—Ç—å –ª–∏—á–Ω–æ—Å—Ç—å
stats - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- –ö–æ–º–∞–Ω–¥—ã —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ —á–µ—Ä–µ–∑ BotFather
- –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞ "/" —Å –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç–æ–º
- –ü–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ–º–æ–≥–∞—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –ø–æ–Ω—è—Ç—å, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–º–∞–Ω–¥–∞

---

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ –Ω–æ–≤—ã—Ö —Ñ–∏—á

#### –ù–æ–≤—ã–µ –º–æ–¥—É–ª–∏:
```
modules/
‚îú‚îÄ‚îÄ direct_chat.py         # NEW: –ü—Ä—è–º–æ–µ –æ–±—â–µ–Ω–∏–µ —Å –±–æ—Ç–æ–º
‚îú‚îÄ‚îÄ onboarding.py          # NEW: Welcome-—Å–æ–æ–±—â–µ–Ω–∏—è, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—ã
‚îú‚îÄ‚îÄ summaries.py           # UPDATE: –î–æ–±–∞–≤–∏—Ç—å –≤—ã–±–æ—Ä –ª–∏—á–Ω–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ judge.py               # UPDATE: –î–æ–±–∞–≤–∏—Ç—å –≤—ã–±–æ—Ä –ª–∏—á–Ω–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ personalities.py       # –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
```

#### –ù–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã –ë–î:
```sql
-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –¥–ª—è –ª–∏—á–Ω–æ—Å—Ç–µ–π
ALTER TABLE personalities
ADD COLUMN greeting_message TEXT DEFAULT NULL;

-- –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏ —á–∞—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ bot_data)
CREATE TABLE active_chat_sessions (
  id SERIAL PRIMARY KEY,
  user_id BIGINT NOT NULL,
  chat_id BIGINT NOT NULL,
  personality VARCHAR(100) NOT NULL,
  started_at TIMESTAMP DEFAULT NOW(),
  last_activity TIMESTAMP DEFAULT NOW(),
  UNIQUE(user_id, chat_id)
);

-- –ò–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ —Å–µ—Å—Å–∏–π
CREATE INDEX idx_sessions_activity ON active_chat_sessions(last_activity);
```

#### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
```python
# config.py - –Ω–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

# Direct chat settings
DIRECT_CHAT_CONTEXT_MESSAGES = 30  # –°–∫–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
DIRECT_CHAT_SESSION_TIMEOUT = 900  # 15 –º–∏–Ω—É—Ç (–¥–ª—è –≥—Ä—É–ø–ø)

# Group chat settings
GROUP_CHAT_WELCOME_IMAGE_ID = "AgACAgIAAxkBAAI..."  # file_id –∫–∞—Ä—Ç–∏–Ω–∫–∏
GROUP_ADD_URL = "https://t.me/YourBot?startgroup=true"

# Personality settings
DEFAULT_GREETING_ENABLED = True  # –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è —á–µ—Ä–µ–∑ API
NO_DEFAULT_PERSONALITY = True    # –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –ª–∏—á–Ω–æ—Å—Ç–∏

# Rate limiting –¥–ª—è /chat
CHAT_SESSION_COOLDOWN = 30  # 30 —Å–µ–∫ –º–µ–∂–¥—É –∑–∞–ø—É—Å–∫–∞–º–∏ /chat
```

---

### UX-–ø–æ–¥—Å–∫–∞–∑–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

#### –°—Ü–µ–Ω–∞—Ä–∏–∏ –æ—à–∏–±–æ–∫:

**1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç –±–æ—Ç—É –±–µ–∑ –≤—ã–±–æ—Ä–∞ –ª–∏—á–Ω–æ—Å—Ç–∏:**
```
[–°–æ–æ–±—â–µ–Ω–∏–µ] ‚Üí "–ü—Ä–∏–≤–µ—Ç"
    ‚Üì
[–ü—Ä–æ–≤–µ—Ä–∫–∞] ‚Üí selected_personality == NULL
    ‚Üì
[–ë–æ—Ç] ‚Üí "–í—ã–±–µ—Ä–∏ –ª–∏—á–Ω–æ—Å—Ç—å, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –æ–±—â–µ–Ω–∏–µ: /lichnost"
```

**2. –ö–æ–º–∞–Ω–¥–∞ /summary –±–µ–∑ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç–µ:**
```
[–ö–æ–º–∞–Ω–¥–∞] ‚Üí /summary
    ‚Üì
[–ë–î] ‚Üí 0 —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–∞–π–¥–µ–Ω–æ
    ‚Üì
[–ë–æ—Ç] ‚Üí "–í —á–∞—Ç–µ –ø–æ–∫–∞ –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è —Å–∞–º–º–∞—Ä–∏. –ù–∞–ø–∏—à–∏—Ç–µ —Ö–æ—Ç—è –±—ã 10 —Å–æ–æ–±—â–µ–Ω–∏–π!"
```

**3. –ö–æ–º–∞–Ω–¥–∞ /rassudi –±–µ–∑ —É–ø–æ–º–∏–Ω–∞–Ω–∏–π:**
```
[–ö–æ–º–∞–Ω–¥–∞] ‚Üí /rassudi –ö—Ç–æ –ø—Ä–∞–≤?
    ‚Üì
[–ü–∞—Ä—Å–∏–Ω–≥] ‚Üí –ù–µ—Ç @username
    ‚Üì
[–ë–æ—Ç] ‚Üí "–£–∫–∞–∂–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Å–ø–æ—Ä–∞ —á–µ—Ä–µ–∑ @username!\n–ü—Ä–∏–º–µ—Ä: /rassudi @ivan @petya –ö—Ç–æ –ø—Ä–∞–≤?"
```

**4. –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç —Ç–æ–∫–µ–Ω–æ–≤ –≤ direct chat:**
```
[Claude API] ‚Üí Error: context_length_exceeded
    ‚Üì
[–ë–æ—Ç] ‚Üí "–ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω! –Ø –ø–æ–º–Ω—é —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –¥–Ω—è.\n–ù–∞—á–Ω–∏ –Ω–æ–≤—ã–π –¥–∏–∞–ª–æ–≥: /start"
```

**5. Cooldown –∞–∫—Ç–∏–≤–µ–Ω:**
```
[–ö–æ–º–∞–Ω–¥–∞] ‚Üí /summary
    ‚Üì
[–ü—Ä–æ–≤–µ—Ä–∫–∞] ‚Üí –ü–æ—Å–ª–µ–¥–Ω–∏–π —Å–∞–º–º–∞—Ä–∏ 30 —Å–µ–∫ –Ω–∞–∑–∞–¥
    ‚Üì
[–ë–æ—Ç] ‚Üí "–ü–æ–¥–æ–∂–¥–∏ –µ—â—ë 30 —Å–µ–∫—É–Ω–¥ –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º —Å–∞–º–º–∞—Ä–∏ ‚è±Ô∏è"
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- `utils/validators.py:validate_command_input()` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥
- –í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –ë–î (—Ç–∞–±–ª–∏—Ü–∞ `analytics`)
- User-friendly —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ

---

## üèóÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

### –ü—Ä–∏–Ω—Ü–∏–ø—ã:
1. **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å** - –∫–∞–∂–¥–∞—è —Ñ–∏—á–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ
2. **–°–ª–∞–±–∞—è —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å** - –º–∏–Ω–∏–º—É–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
3. **–¢–∏–ø–∏–∑–∞—Ü–∏—è** - type hints –≤–µ–∑–¥–µ
4. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º–æ—Å—Ç—å** - –≤—Å—ë —á–µ—Ä–µ–∑ config.py
5. **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** - –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –º–æ–¥—É–ª–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:

```
vkratse/
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îî‚îÄ‚îÄ index.py              # Webhook entry point (Vercel handler)
‚îÇ
‚îú‚îÄ‚îÄ modules/
‚îÇ   ‚îú‚îÄ‚îÄ direct_chat.py        # NEW: –ü—Ä—è–º–æ–µ –æ–±—â–µ–Ω–∏–µ —Å –±–æ—Ç–æ–º (1-–Ω–∞-1)
‚îÇ   ‚îú‚îÄ‚îÄ onboarding.py         # NEW: Welcome, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—ã
‚îÇ   ‚îú‚îÄ‚îÄ summaries.py          # /sut, /summary + callback handlers
‚îÇ   ‚îú‚îÄ‚îÄ personalities.py      # /lichnost + —Å–æ–∑–¥–∞–Ω–∏–µ –ª–∏—á–Ω–æ—Å—Ç–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ judge.py              # /rassudi - —Å—É–¥–µ–π—Å—Ç–≤–æ —Å–ø–æ—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ commands.py           # /start, /help, /stats
‚îÇ   ‚îú‚îÄ‚îÄ admin.py              # NEW: –ê–¥–º–∏–Ω—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ payments.py           # NEW: –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π (Stars, Crypto, Tribute)
‚îÇ   ‚îî‚îÄ‚îÄ subscription.py       # NEW: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏—Ä–æ–≤, –ª–∏–º–∏—Ç–æ–≤, middleware
‚îÇ
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ ai_service.py         # –û–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ Claude API
‚îÇ   ‚îú‚îÄ‚îÄ db_service.py         # –û–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ Supabase
‚îÇ   ‚îî‚îÄ‚îÄ persistence.py        # User data persistence
‚îÇ
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ message.py            # –ú–æ–¥–µ–ª—å —Å–æ–æ–±—â–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ personality.py        # –ú–æ–¥–µ–ª—å –ª–∏—á–Ω–æ—Å—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ user.py               # –ú–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ chat.py               # –ú–æ–¥–µ–ª—å —á–∞—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ session.py            # NEW: –ú–æ–¥–µ–ª—å –∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏ —á–∞—Ç–∞
‚îÇ
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îú‚îÄ‚îÄ security.py           # HMAC, sanitization
‚îÇ   ‚îú‚îÄ‚îÄ rate_limit.py         # Rate limiting
‚îÇ   ‚îú‚îÄ‚îÄ cooldown.py           # Cooldown —á–∞—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ time_parser.py        # –ü–∞—Ä—Å–∏–Ω–≥ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ validators.py         # –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îÇ
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îî‚îÄ‚îÄ cleanup_old_messages.py  # –û–¥–Ω–æ—Ä–∞–∑–æ–≤–∞—è –æ—á–∏—Å—Ç–∫–∞ –ë–î
‚îÇ
‚îú‚îÄ‚îÄ sql/
‚îÇ   ‚îú‚îÄ‚îÄ init_tables.sql       # –°–æ–∑–¥–∞–Ω–∏–µ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü
‚îÇ   ‚îú‚îÄ‚îÄ seed_personalities.sql # –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –ª–∏—á–Ω–æ—Å—Ç–µ–π
‚îÇ   ‚îî‚îÄ‚îÄ migrations/
‚îÇ       ‚îú‚îÄ‚îÄ 001_add_greetings.sql    # NEW: –î–æ–±–∞–≤–∏—Ç—å greeting_message
‚îÇ       ‚îú‚îÄ‚îÄ 002_chat_sessions.sql    # NEW: –¢–∞–±–ª–∏—Ü–∞ active_chat_sessions
‚îÇ       ‚îú‚îÄ‚îÄ 003_monetization.sql     # NEW: –¢–∞–±–ª–∏—Ü—ã subscriptions, usage_limits
‚îÇ       ‚îî‚îÄ‚îÄ 004_admin.sql            # NEW: –¢–∞–±–ª–∏—Ü—ã promo_codes, promo_usage, admin_logs
‚îÇ
‚îú‚îÄ‚îÄ config.py                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (env vars)
‚îú‚îÄ‚îÄ requirements.txt          # Python dependencies
‚îú‚îÄ‚îÄ vercel.json              # Vercel configuration
‚îú‚îÄ‚îÄ README.md                # –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ README_CLEANUP.md        # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ cleanup —Å–∫—Ä–∏–ø—Ç—É
‚îî‚îÄ‚îÄ CLAUDE.md                # –≠—Ç–æ—Ç —Ñ–∞–π–ª (–¥–ª—è Claude Code)
```

---

## üóÑÔ∏è –°–•–ï–ú–ê –î–ê–ù–ù–´–• (Supabase)

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

#### `messages`
```sql
CREATE TABLE messages (
  id BIGSERIAL PRIMARY KEY,
  chat_id BIGINT NOT NULL,
  user_id BIGINT,
  username TEXT,
  message_text TEXT,
  created_at TIMESTAMP DEFAULT NOW(),
  INDEX idx_chat_time (chat_id, created_at DESC)
);
```
**–ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞:** 3 –¥–Ω—è (–ø—Ä–∏ –∫–∞–∂–¥–æ–º –Ω–æ–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏)

#### `personalities`
```sql
CREATE TABLE personalities (
  id SERIAL PRIMARY KEY,
  name VARCHAR(100) UNIQUE NOT NULL,
  display_name VARCHAR(100) NOT NULL,
  emoji VARCHAR(10) DEFAULT 'üé≠',
  system_prompt TEXT NOT NULL,
  greeting_message TEXT DEFAULT NULL,        -- NEW: –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
  is_custom BOOLEAN DEFAULT FALSE,
  created_by_user_id BIGINT,
  is_active BOOLEAN DEFAULT TRUE,
  created_at TIMESTAMP DEFAULT NOW()
);
```

#### `active_chat_sessions` (NEW)
```sql
CREATE TABLE active_chat_sessions (
  id SERIAL PRIMARY KEY,
  user_id BIGINT NOT NULL,
  chat_id BIGINT NOT NULL,
  personality VARCHAR(100) NOT NULL,
  started_at TIMESTAMP DEFAULT NOW(),
  last_activity TIMESTAMP DEFAULT NOW(),
  UNIQUE(user_id, chat_id),
  INDEX idx_sessions_activity (last_activity)
);
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –•—Ä–∞–Ω–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π /chat –≤ –≥—Ä—É–ø–ø–∞—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 15 –º–∏–Ω—É—Ç –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å = –æ–¥–Ω–∞ —Å–µ—Å—Å–∏—è –Ω–∞ —á–∞—Ç

#### `user_settings`
```sql
CREATE TABLE user_settings (
  user_id BIGINT PRIMARY KEY,
  username TEXT,
  selected_personality VARCHAR(100) DEFAULT 'neutral',
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

#### `chat_metadata`
```sql
CREATE TABLE chat_metadata (
  chat_id BIGINT PRIMARY KEY,
  chat_title TEXT,
  chat_type TEXT,
  bot_added_at TIMESTAMP DEFAULT NOW(),
  last_activity TIMESTAMP DEFAULT NOW()
);
```

#### `cooldowns`
```sql
CREATE TABLE cooldowns (
  chat_id BIGINT PRIMARY KEY,
  last_summary_at TIMESTAMP,
  last_judge_at TIMESTAMP,
  updated_at TIMESTAMP DEFAULT NOW()
);
```

#### `analytics`
```sql
CREATE TABLE analytics (
  id BIGSERIAL PRIMARY KEY,
  user_id BIGINT,
  chat_id BIGINT,
  event_type VARCHAR(50),
  metadata JSONB,
  created_at TIMESTAMP DEFAULT NOW()
);
```

---

### –¢–∞–±–ª–∏—Ü—ã –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏

#### `subscriptions`
```sql
CREATE TABLE subscriptions (
  id SERIAL PRIMARY KEY,
  user_id BIGINT NOT NULL UNIQUE,
  tier VARCHAR(20) NOT NULL,  -- 'free', 'pro', 'premium'
  started_at TIMESTAMP DEFAULT NOW(),
  expires_at TIMESTAMP,  -- NULL –¥–ª—è free tier
  payment_method VARCHAR(50),  -- 'stars', 'ton', 'usdt', 'tribute', 'promo'
  transaction_id VARCHAR(255),  -- –°—Å—ã–ª–∫–∞ –Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
  is_active BOOLEAN DEFAULT TRUE,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_subscriptions_user ON subscriptions(user_id);
CREATE INDEX idx_subscriptions_expiry ON subscriptions(expires_at);
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –•—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `tier` - —Ç–∞—Ä–∏—Ñ: free/pro/premium
- `expires_at` - NULL –¥–ª—è –±–µ—Å—Å—Ä–æ—á–Ω—ã—Ö –∏–ª–∏ free
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ

#### `usage_limits`
```sql
CREATE TABLE usage_limits (
  id SERIAL PRIMARY KEY,
  user_id BIGINT NOT NULL,
  date DATE DEFAULT CURRENT_DATE,
  messages_count INT DEFAULT 0,
  summaries_count INT DEFAULT 0,
  judge_count INT DEFAULT 0,
  UNIQUE(user_id, date)
);

CREATE INDEX idx_usage_date ON usage_limits(user_id, date);
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –¥–Ω–µ–≤–Ω—ã—Ö –ª–∏–º–∏—Ç–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π (>30 –¥–Ω–µ–π)
- –°–±—Ä–æ—Å —Å—á–µ—Ç—á–∏–∫–æ–≤ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 00:00 UTC

---

### –¢–∞–±–ª–∏—Ü—ã –∞–¥–º–∏–Ω–∫–∏

#### `promo_codes`
```sql
CREATE TABLE promo_codes (
  id SERIAL PRIMARY KEY,
  code VARCHAR(50) UNIQUE NOT NULL,
  tier VARCHAR(20) NOT NULL,  -- 'pro', 'premium'
  duration_days INT NOT NULL,
  max_uses INT,  -- NULL = unlimited
  current_uses INT DEFAULT 0,
  is_active BOOLEAN DEFAULT TRUE,
  created_by_admin_id BIGINT,
  created_at TIMESTAMP DEFAULT NOW(),
  expires_at TIMESTAMP  -- NULL = never expires
);

CREATE INDEX idx_promo_code ON promo_codes(code);
CREATE INDEX idx_promo_active ON promo_codes(is_active);
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–º–æ–∫–æ–¥—ã –¥–ª—è –ø–æ–¥–ø–∏—Å–æ–∫
- –°–æ–∑–¥–∞—é—Ç—Å—è –∞–¥–º–∏–Ω–∞–º–∏ —á–µ—Ä–µ–∑ `/admin`
- –ú–æ–≥—É—Ç –∏–º–µ—Ç—å –ª–∏–º–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–∏ –∏—Å—á–µ—Ä–ø–∞–Ω–∏–∏ –ª–∏–º–∏—Ç–∞

#### `promo_usage`
```sql
CREATE TABLE promo_usage (
  id SERIAL PRIMARY KEY,
  promo_code_id INT REFERENCES promo_codes(id),
  user_id BIGINT NOT NULL,
  used_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_promo_usage_user ON promo_usage(user_id);
CREATE INDEX idx_promo_usage_code ON promo_usage(promo_code_id);
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò—Å—Ç–æ—Ä–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
- –û–¥–∏–Ω —é–∑–µ—Ä –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ —Ç–æ–ª—å–∫–æ 1 —Ä–∞–∑
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–∞—Ü–∏–π

#### `admin_logs`
```sql
CREATE TABLE admin_logs (
  id BIGSERIAL PRIMARY KEY,
  admin_id BIGINT NOT NULL,
  action_type VARCHAR(50) NOT NULL,  -- 'grant_subscription', 'create_promo', etc.
  target_user_id BIGINT,  -- –µ—Å–ª–∏ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–∞–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
  details JSONB,
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_admin_logs_admin ON admin_logs(admin_id, created_at DESC);
CREATE INDEX idx_admin_logs_user ON admin_logs(target_user_id);
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê—É–¥–∏—Ç –∞–¥–º–∏–Ω—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∞–¥–º–∏–Ω–æ–≤
- –ü—Ä–æ—Å–º–æ—Ç—Ä —á–µ—Ä–µ–∑ `/admin` ‚Üí –õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π
- –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

---

## üì± –ö–û–ú–ê–ù–î–´ –ë–û–¢–ê

**–í–ê–ñ–ù–û:** –ö–æ–º–∞–Ω–¥—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –õ–ê–¢–ò–ù–°–ö–ò–ï –Ω–∞–∑–≤–∞–Ω–∏—è (Telegram API —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ)

### `/start`
–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ + Inline-–º–µ–Ω—é –≤—ã–±–æ—Ä–∞ –¥–µ–π—Å—Ç–≤–∏—è
- üí¨ –û–±—â–∞—Ç—å—Å—è –Ω–∞–ø—Ä—è–º—É—é
- üë• –î–æ–±–∞–≤–∏—Ç—å –≤ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç
- üé≠ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–∏—á–Ω–æ—Å—Ç—å

**–ö–æ–Ω—Ç–µ–∫—Å—Ç:**
- –í **–õ–°**: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª–Ω–æ–µ –º–µ–Ω—é
- –í **–≥—Ä—É–ø–ø–µ**: –∫—Ä–∞—Ç–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞ + /help

### `/help`
–ü–æ–ª–Ω–∞—è —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –≤—Å–µ–º –∫–æ–º–∞–Ω–¥–∞–º —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏

### `/summary [–ø–µ—Ä–∏–æ–¥]` (NEW)
–°–∞–º–º–∞—Ä–∏–∑–∞—Ü–∏—è —á–∞—Ç–∞ —Å –≤—ã–±–æ—Ä–æ–º –ª–∏—á–Ω–æ—Å—Ç–∏
- –í **–≥—Ä—É–ø–ø–µ**: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–µ–Ω—é –ª–∏—á–Ω–æ—Å—Ç–µ–π ‚Üí –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–∞–º–º–∞—Ä–∏
- –í **–õ–°**: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ —á–∞—Ç–∞ ‚Üí –º–µ–Ω—é –ª–∏—á–Ω–æ—Å—Ç–µ–π

**–ü—Ä–∏–º–µ—Ä—ã:**
- `/summary` - –ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å–æ–æ–±—â–µ–Ω–∏–π
- `/summary 100` - –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å–æ–æ–±—â–µ–Ω–∏–π
- `/summary 2h` - –ø–æ—Å–ª–µ–¥–Ω–∏–µ 2 —á–∞—Å–∞
- `/summary today` - —Å –Ω–∞—á–∞–ª–∞ –¥–Ω—è

**–û—Ç–ª–∏—á–∏–µ –æ—Ç /sut:** –í—Å–µ–≥–¥–∞ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –≤—ã–±–æ—Ä –ª–∏—á–Ω–æ—Å—Ç–∏

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** HMAC –ø–æ–¥–ø–∏—Å—å, –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–ª–µ–Ω—Å—Ç–≤–∞, rate limiting, cooldown

### `/sut [–ø–µ—Ä–∏–æ–¥]`
–°–∞–º–º–∞—Ä–∏–∑–∞—Ü–∏—è —á–∞—Ç–∞ (legacy, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–µ—Ñ–æ–ª—Ç–Ω—É—é –ª–∏—á–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- –í **–≥—Ä—É–ø–ø–µ**: —Å–∞–º–º–∞—Ä–∏ —Ç–µ–∫—É—â–µ–≥–æ —á–∞—Ç–∞
- –í **–õ–°**: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–Ω–æ–ø–∫–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ —á–∞—Ç–∞

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `/summary` –¥–ª—è –±–æ–ª—å—à–µ–π –≥–∏–±–∫–æ—Å—Ç–∏

### `/chat` (NEW)
–ù–∞—á–∞—Ç—å –ø—Ä—è–º–æ–µ –æ–±—â–µ–Ω–∏–µ —Å –±–æ—Ç–æ–º –≤ –≥—Ä—É–ø–ø–µ
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–µ–Ω—é –≤—ã–±–æ—Ä–∞ –ª–∏—á–Ω–æ—Å—Ç–∏
- –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ —ç—Ç–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é (—á–µ—Ä–µ–∑ reply/mention)
- –°–µ—Å—Å–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ 15 –º–∏–Ω—É—Ç –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –ó–∞–≤–µ—Ä—à–∏—Ç—å –≤—Ä—É—á–Ω—É—é: `/stop`

**–¢–æ–ª—å–∫–æ –¥–ª—è –≥—Ä—É–ø–ø!** –í –õ–° –Ω–µ –Ω—É–∂–Ω–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä—è–º–æ–µ –æ–±—â–µ–Ω–∏–µ)

### `/rassudi @user1 @user2 <–æ–ø–∏—Å–∞–Ω–∏–µ>`
–†–∞—Å—Å—É–¥–∏—Ç—å —Å–ø–æ—Ä —Å –≤—ã–±–æ—Ä–æ–º –ª–∏—á–Ω–æ—Å—Ç–∏ —Å—É–¥—å–∏
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç —É–ø–æ–º—è–Ω—É—Ç—ã—Ö @username
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–µ–Ω—é –≤—ã–±–æ—Ä–∞ –ª–∏—á–Ω–æ—Å—Ç–∏
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å–æ–æ–±—â–µ–Ω–∏–π —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- –í—ã–¥–∞—ë—Ç –≤–µ—Ä–¥–∏–∫—Ç –≤ —Å—Ç–∏–ª–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –ª–∏—á–Ω–æ—Å—Ç–∏

**–ü—Ä–∏–º–µ—Ä:**
```
/rassudi @ivan @petya –ö—Ç–æ –ø—Ä–∞–≤ –Ω–∞—Å—á–µ—Ç –≤—ã–±–æ—Ä–∞ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞?
```

### `/lichnost`
–í—ã–±–æ—Ä/—Å–æ–∑–¥–∞–Ω–∏–µ –ª–∏—á–Ω–æ—Å—Ç–∏ AI
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç 7 –±–∞–∑–æ–≤—ã—Ö –ª–∏—á–Ω–æ—Å—Ç–µ–π
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ª–∏—á–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–æ 5 —à—Ç—É–∫)
- –ö–Ω–æ–ø–∫–∞ "‚ûï –°–æ–∑–¥–∞—Ç—å —Å–≤–æ—é –ª–∏—á–Ω–æ—Å—Ç—å"
- –í—ã–±—Ä–∞–Ω–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π

### `/stats`
–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∞–º–º–∞—Ä–∏
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ø–æ—Ä–æ–≤ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–æ
- –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏ —á–∞—Ç–∞
- –õ—é–±–∏–º–∞—è –ª–∏—á–Ω–æ—Å—Ç—å

### `/stop` (NEW)
–ó–∞–≤–µ—Ä—à–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—É—é —Å–µ—Å—Å–∏—é /chat –≤ –≥—Ä—É–ø–ø–µ
- –¢–æ–ª—å–∫–æ –¥–ª—è –≥—Ä—É–ø–ø
- –û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç —Å–µ—Å—Å–∏—é –¥–ª—è –Ω–æ–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ /chat

---

### üîß –ê–¥–º–∏–Ω—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)

#### `/admin`
–ì–ª–∞–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫
- –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
- –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
- –õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π

**–î–æ—Å—Ç—É–ø:** —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ `ADMIN_USER_IDS` –≤ config.py

#### `/promo <–ö–û–î>`
–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ (–¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)

**–ü—Ä–∏–º–µ—Ä—ã:**
```
/promo FRIENDS2025
/promo BETA2025
```

–ü—Ä–æ–º–æ–∫–æ–¥—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–¥–º–∏–Ω–æ–º —á–µ—Ä–µ–∑ `/admin` ‚Üí –ü—Ä–æ–º–æ–∫–æ–¥—ã ‚Üí –°–æ–∑–¥–∞—Ç—å

#### –¢–µ—Å—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)

- `/testpro` - –≤—ã–¥–∞—Ç—å —Å–µ–±–µ Pro –Ω–∞ 1 —á–∞—Å
- `/testpremium` - –≤—ã–¥–∞—Ç—å —Å–µ–±–µ Premium –Ω–∞ 1 —á–∞—Å
- `/testlimit` - –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–µ –ª–∏–º–∏—Ç—ã
- `/testreset` - —Å–±—Ä–æ—Å–∏—Ç—å –ª–∏–º–∏—Ç—ã

**–í–∞–∂–Ω–æ:** –†–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –≤–∫–ª—é—á–µ–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º —á–µ—Ä–µ–∑ `/admin`

---

## üé≠ –õ–ò–ß–ù–û–°–¢–ò AI (7 –±–∞–∑–æ–≤—ã—Ö)

–í—Å–µ –ª–∏—á–Ω–æ—Å—Ç–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ë–î (`personalities` —Ç–∞–±–ª–∏—Ü–∞):

1. **üéì –ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π (neutral)** - –¥–µ—Ñ–æ–ª—Ç, –≤–µ–∂–ª–∏–≤—ã–π –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π
2. **üè≠ –ë—ã–¥–ª–∞–Ω (bydlan)** - –∑–∞–≤–æ–¥—á–∞–Ω–∏–Ω, –º–∞—Ç—é–∫–∞–µ—Ç—Å—è, –ø—Ä–æ –∞–≤—Ç–æ–º–æ–π–∫—É
3. **üßô –§–∏–ª–æ—Å–æ—Ñ (philosopher)** - –º—É–¥—Ä–µ—Ü, –≥–ª—É–±–æ–∫–∏–µ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è
4. **üëü –ì–æ–ø–Ω–∏–∫ (gopnik)** - –ø–∞—Ü–∞–Ω –∏–∑ 2000-—Ö, —Å–ª–µ–Ω–≥, –ø–æ–¥—ä–µ–∑–¥
5. **üíº –û–ª–∏–≥–∞—Ä—Ö (oligarch)** - –±–æ–≥–∞—á, —è—Ö—Ç—ã –∏ –º–∏–ª–ª–∏–æ–Ω—ã
6. **üòÇ –°—Ç–µ–Ω–¥–∞–ø–µ—Ä (comedian)** - –∫–æ–º–∏–∫, –≤—Å—ë –≤ —à—É—Ç–∫—É
7. **üî¨ –£—á—ë–Ω—ã–π (scientist)** - –Ω–∞—É—á–Ω—ã–π –ø–æ–¥—Ö–æ–¥, –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è

**–ö–∞—Å—Ç–æ–º–Ω—ã–µ –ª–∏—á–Ω–æ—Å—Ç–∏:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ (–¥–æ 5 —à—Ç—É–∫)
- Sanitization –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç prompt injection
- –ó–∞–ø—Ä–µ—â–µ–Ω—ã –∏–º–µ–Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –ª—é–¥–µ–π

---

## üîß –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

```bash
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ
TELEGRAM_BOT_TOKEN=123456:ABC-DEF...
ANTHROPIC_API_KEY=sk-ant-...
ANTHROPIC_MODEL=claude-3-7-sonnet-20250219
SUPABASE_URL=https://xxx.supabase.co
SUPABASE_KEY=eyJhbGci...

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ
SECRET_KEY=random_secret_for_hmac_12345

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏
MESSAGE_RETENTION_DAYS=3                    # –ê–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
DEFAULT_SUMMARY_HOURS=24
DEFAULT_PERSONALITY=neutral                 # –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è /sut
COOLDOWN_SECONDS=60
RATE_LIMIT_REQUESTS=10
RATE_LIMIT_WINDOW=60
MAX_MESSAGES_PER_SUMMARY=400
DEFAULT_MESSAGE_LIMIT=50
MAX_CUSTOM_PERSONALITIES_PER_USER=5
MAX_PERSONALITY_DESCRIPTION_LENGTH=1500
MIN_PERSONALITY_DESCRIPTION_LENGTH=10
LOG_LEVEL=INFO

# NEW: Direct chat settings
DIRECT_CHAT_CONTEXT_MESSAGES=30             # –°–∫–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
DIRECT_CHAT_SESSION_TIMEOUT=900             # 15 –º–∏–Ω—É—Ç (–¥–ª—è –≥—Ä—É–ø–ø)
NO_DEFAULT_PERSONALITY=true                 # –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –ª–∏—á–Ω–æ—Å—Ç–∏
DEFAULT_GREETING_ENABLED=true               # –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è —á–µ—Ä–µ–∑ API

# NEW: Group chat settings
GROUP_CHAT_WELCOME_IMAGE_ID=                # file_id –∫–∞—Ä—Ç–∏–Ω–∫–∏ –¥–ª—è welcome
GROUP_ADD_URL=https://t.me/YourBot?startgroup=true
CHAT_SESSION_COOLDOWN=30                    # 30 —Å–µ–∫ –º–µ–∂–¥—É –∑–∞–ø—É—Å–∫–∞–º–∏ /chat

# NEW: Admin settings
ADMIN_USER_IDS=123456789,987654321          # Telegram IDs –∞–¥–º–∏–Ω–æ–≤ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
TEST_MODE=false                             # –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
```

### –í–∞–∂–Ω–æ –¥–ª—è Vercel

**Environment Variables** –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ Vercel Dashboard:
- Settings ‚Üí Environment Variables
- –î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è Production, Preview, Development
- –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å–¥–µ–ª–∞—Ç—å redeploy

---

## üîÑ –ê–í–¢–û–£–î–ê–õ–ï–ù–ò–ï –°–û–û–ë–©–ï–ù–ò–ô

**–ú–µ—Ö–∞–Ω–∏–∑–º:**
- –ü—Ä–∏ –∫–∞–∂–¥–æ–º –Ω–æ–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ –≤ —á–∞—Ç–µ ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è —Å—Ç–∞—Ä—à–µ `MESSAGE_RETENTION_DAYS` (3 –¥–Ω—è)
- –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è —ç—Ç–æ–≥–æ —á–∞—Ç–∞ (–Ω–µ –≥–ª–æ–±–∞–ª—å–Ω–æ)
- –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–¥–∞–ª—ë–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** `services/db_service.py:46-57`

**Cleanup —Å–∫—Ä–∏–ø—Ç:** `scripts/cleanup_old_messages.py`
- –û–¥–Ω–æ—Ä–∞–∑–æ–≤–∞—è –æ—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ (–Ω–µ –Ω–∞ Vercel!)
- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ `README_CLEANUP.md`

---

## üöÄ DEPLOYMENT

### Vercel Setup

```bash
# Deploy
vercel deploy --prod

# Set environment variables —á–µ—Ä–µ–∑ Dashboard:
# Settings ‚Üí Environment Variables

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å webhook
curl "https://api.telegram.org/bot<TOKEN>/setWebhook?url=https://vkratse.vercel.app"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å webhook
curl "https://api.telegram.org/bot<TOKEN>/getWebhookInfo"
```

### Deployment Checklist

**–ü–µ—Ä–µ–¥ deployment:**
- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç –ª–æ–∫–∞–ª—å–Ω–æ
- [ ] –ö–æ–º–∞–Ω–¥—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç Latin –Ω–∞–∑–≤–∞–Ω–∏—è
- [ ] Application.initialize() –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- [ ] Pure WSGI –±–µ–∑ Werkzeug
- [ ] Environment variables —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ Vercel

**–ü–æ—Å–ª–µ deployment:**
- [ ] –õ–æ–≥–∏ Vercel –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç 200 OK
- [ ] Webhook —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ production URL
- [ ] getWebhookInfo –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–æ–∫
- [ ] –ö–æ–º–∞–Ω–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç: /start, /help, /sut

---

## üéØ –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–°

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç (Production Ready - 100%)

**Production bot:** @chto_bilo_v_chate_bot
**URL:** https://vkratse.vercel.app
**Deployment:** Vercel Serverless
**Database:** Supabase PostgreSQL
**–°—Ç–∞—Ç—É—Å:** üü¢ –í—Å–µ —Ñ–∞–∑—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∏—á–∏:**

**–ë–∞–∑–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- ‚úÖ Webhook —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
- ‚úÖ –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã: /start, /help, /summary, /chat, /stop, /rassudi, /lichnost, /stats
- ‚úÖ 7 –±–∞–∑–æ–≤—ã—Ö –ª–∏—á–Ω–æ—Å—Ç–µ–π —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è–º–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ª–∏—á–Ω–æ—Å—Ç–µ–π (—á–µ—Ä–µ–∑ ConversationHandler, –¥–æ 5 –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- ‚úÖ –ê–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (3 –¥–Ω—è)
- ‚úÖ Rate limiting –∏ cooldown
- ‚úÖ HMAC –∑–∞—â–∏—Ç–∞ callback_data
- ‚úÖ Sanitization –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ª–∏—á–Ω–æ—Å—Ç–µ–π (–∑–∞—â–∏—Ç–∞ –æ—Ç prompt injection)
- ‚úÖ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ (—Ç–∞–±–ª–∏—Ü–∞ analytics)
- ‚úÖ User data persistence
- ‚úÖ Cleanup —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–π –æ—á–∏—Å—Ç–∫–∏

**NEW FLOW (–§–∞–∑—ã 1-4 - –∑–∞–≤–µ—Ä—à–µ–Ω—ã):**

**–§–∞–∑–∞ 1: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (100%)**
- ‚úÖ –ë–î –º–∏–≥—Ä–∞—Ü–∏–∏: `sql/migrations/001_add_greetings.sql` - –∫–æ–ª–æ–Ω–∫–∞ `greeting_message`
- ‚úÖ –ë–î –º–∏–≥—Ä–∞—Ü–∏–∏: `sql/migrations/002_chat_sessions.sql` - —Ç–∞–±–ª–∏—Ü–∞ `active_chat_sessions`
- ‚úÖ –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –¥–ª—è –≤—Å–µ—Ö 7 –±–∞–∑–æ–≤—ã—Ö –ª–∏—á–Ω–æ—Å—Ç–µ–π
- ‚úÖ `services/ai_service.py`: `generate_chat_response()` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –¥–∏–∞–ª–æ–≥–∞
- ‚úÖ `services/ai_service.py`: `generate_greeting()` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–π –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ª–∏—á–Ω–æ—Å—Ç–µ–π
- ‚úÖ `services/db_service.py`: `get_chat_history()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

**–§–∞–∑–∞ 2: Direct Chat (100%)**
- ‚úÖ `modules/direct_chat.py` - –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- ‚úÖ `show_personality_selection()` - –ø–æ–∫–∞–∑ –º–µ–Ω—é –ª–∏—á–Ω–æ—Å—Ç–µ–π (2 –∫–æ–ª–æ–Ω–∫–∏, –±–∞–∑–æ–≤—ã–µ + –∫–∞—Å—Ç–æ–º–Ω—ã–µ)
- ‚úÖ `handle_personality_selection()` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞ + –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
- ‚úÖ `handle_direct_message()` - –ø—Ä—è–º–æ–µ –æ–±—â–µ–Ω–∏–µ 1-–Ω–∞-1 –≤ –õ–° —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º (30 —Å–æ–æ–±—â–µ–Ω–∏–π)
- ‚úÖ `handle_create_personality_callback()` - —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /lichnost –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ª–∏—á–Ω–æ—Å—Ç–∏

**–§–∞–∑–∞ 3: –ì—Ä—É–ø–ø–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (100%)**
- ‚úÖ `modules/commands.py` –æ–±–Ω–æ–≤–ª—ë–Ω:
  - `/start` - inline-–º–µ–Ω—é (üí¨ –û–±—â–∞—Ç—å—Å—è / üìä –°–∞–º–º–∞—Ä–∏ / üë• –î–æ–±–∞–≤–∏—Ç—å –≤ –≥—Ä—É–ø–ø—É / üé≠ –õ–∏—á–Ω–æ—Å—Ç—å)
  - `handle_start_menu_callback()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ –º–µ–Ω—é
  - `show_main_menu()` - –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
- ‚úÖ `modules/direct_chat.py`:
  - `chat_command()` - –∫–æ–º–∞–Ω–¥–∞ `/chat` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Å—Å–∏–∏ –≤ –≥—Ä—É–ø–ø–∞—Ö
  - `stop_command()` - –∫–æ–º–∞–Ω–¥–∞ `/stop` –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–µ—Å—Å–∏–∏
  - `handle_start_chat_callback()` - —Å–æ–∑–¥–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏ –≤ bot_data
  - `handle_group_chat_message()` - –æ—Ç–≤–µ—Ç—ã –Ω–∞ reply/mention —Å —Ç–∞–π–º–∞—É—Ç–æ–º 15 –º–∏–Ω—É—Ç
- ‚úÖ `modules/summaries.py` –æ–±–Ω–æ–≤–ª—ë–Ω:
  - `/summary` - –Ω–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞ —Å –≤—ã–±–æ—Ä–æ–º –ª–∏—á–Ω–æ—Å—Ç–∏
  - Inline-–º–µ–Ω—é –ª–∏—á–Ω–æ—Å—Ç–µ–π –≤ –≥—Ä—É–ø–ø–∞—Ö
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: `/summary 100`, `/summary 2h`, `/summary today`
- ‚úÖ `modules/judge.py` –æ–±–Ω–æ–≤–ª—ë–Ω:
  - –ü–µ—Ä–µ–¥–µ–ª–∞–Ω —á–µ—Ä–µ–∑ ConversationHandler
  - –ú–µ–Ω—é –≤—ã–±–æ—Ä–∞ –ª–∏—á–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ –≤–µ—Ä–¥–∏–∫—Ç–æ–º
  - `handle_judge_personality_callback()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞

**–§–∞–∑–∞ 4: Onboarding (100%)**
- ‚úÖ Welcome-—Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤ –≥—Ä—É–ø–ø—É (—á–µ—Ä–µ–∑ `/start`)
- ‚úÖ Inline-–∫–Ω–æ–ø–∫–∏ –¥–ª—è –≥—Ä—É–ø–ø: üìù –°–∞–º–º–∞—Ä–∏ / üí¨ –û–±—â–∞—Ç—å—Å—è / ‚öñÔ∏è –†–∞—Å—Å—É–¥–∏—Ç—å / üé≠ –õ–∏—á–Ω–æ—Å—Ç—å
- ‚úÖ Deep-link –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–∞: `https://t.me/{BOT_USERNAME}?startgroup=true`

### üöß –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2)

**–§–∞–∑–∞ 5: –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è –∏ –ê–¥–º–∏–Ω–∫–∞**
- [ ] **–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è** (—Å–º. —Ä–∞–∑–¥–µ–ª "üí∞ –ú–û–ù–ï–¢–ò–ó–ê–¶–ò–Ø")
  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Telegram Stars (–Ω–∞—Ç–∏–≤–Ω–∞—è –æ–ø–ª–∞—Ç–∞)
  - Crypto –ø–ª–∞—Ç–µ–∂–∏ (TON, USDT)
  - Tribute.to –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- [ ] **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ** (—Å–º. —Ä–∞–∑–¥–µ–ª "üîß –ê–î–ú–ò–ù–ò–°–¢–†–ò–†–û–í–ê–ù–ò–ï")
  - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª—è `modules/admin.py`
  - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª—è `modules/subscription.py`
  - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª—è `modules/payments.py`
  - –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î: subscriptions, usage_limits, promo_codes
  - –ö–æ–º–∞–Ω–¥—ã: /admin, /promo, /testpro, etc.

---

### üîÆ –ë—É–¥—É—â–∏–µ —Ñ–∏—á–∏ (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3)

**–í –ø–ª–∞–Ω–∞—Ö –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ –∏—Ç–µ—Ä–∞—Ü–∏–∏:**
- [ ] –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ –ª–∏—á–Ω–æ—Å—Ç—è–º
- [ ] –≠–∫—Å–ø–æ—Ä—Ç —Å–∞–º–º–∞—Ä–∏ –≤ —Ñ–∞–π–ª—ã (PDF, TXT, MD)
- [ ] Scheduled summaries (–∫—Ä–æ–Ω-–∑–∞–¥–∞—á–∏ —á–µ—Ä–µ–∑ –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å)
- [ ] Premium —Ñ—É–Ω–∫—Ü–∏–∏ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞, —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç)
- [ ] –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (voice ‚Üí text ‚Üí –æ—Ç–≤–µ—Ç)
- [ ] –ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å (EN, RU, etc.)
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞–º–∏ (Discord, Slack)

---

## üí∞ –ú–û–ù–ï–¢–ò–ó–ê–¶–ò–Ø

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏

**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å —É—Å—Ç–æ–π—á–∏–≤—É—é –º–æ–¥–µ–ª—å –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏ —Å –Ω–∏–∑–∫–∏–º –ø–æ—Ä–æ–≥–æ–º –≤—Ö–æ–¥–∞ –∏ –≥–∏–±–∫–∏–º–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –æ–ø–ª–∞—Ç—ã.

**–ü—Ä–∏–Ω—Ü–∏–ø—ã:**
1. **Freemium –º–æ–¥–µ–ª—å** - –±–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã, —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ ‚Äî –ø–ª–∞—Ç–Ω—ã–µ
2. **–ù–∏–∑–∫–∏–π –ø–æ—Ä–æ–≥ –≤—Ö–æ–¥–∞** - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ ~$1-3/–º–µ—Å—è—Ü
3. **–ì–∏–±–∫–∞—è –æ–ø–ª–∞—Ç–∞** - Telegram Stars, –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞, Tribute
4. **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å** - —á—ë—Ç–∫–∏–µ –ª–∏–º–∏—Ç—ã –∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

---

### üìä Pricing Tiers (–¢–∞—Ä–∏—Ñ–Ω—ã–µ –ø–ª–∞–Ω—ã)

#### üÜì Free Tier (–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π)
**–î–æ—Å—Ç—É–ø–Ω–æ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π:**
- ‚úÖ –ü—Ä—è–º–æ–µ –æ–±—â–µ–Ω–∏–µ —Å –±–æ—Ç–æ–º (1-–Ω–∞-1) - –¥–æ 50 —Å–æ–æ–±—â–µ–Ω–∏–π/–¥–µ–Ω—å
- ‚úÖ 1 –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç
- ‚úÖ –°–∞–º–º–∞—Ä–∏–∑–∞—Ü–∏—è: –¥–æ 5 —Å–∞–º–º–∞—Ä–∏/–¥–µ–Ω—å
- ‚úÖ –°—É–¥–µ–π—Å—Ç–≤–æ: –¥–æ 3 –≤–µ—Ä–¥–∏–∫—Ç–æ–≤/–¥–µ–Ω—å
- ‚úÖ 7 –±–∞–∑–æ–≤—ã—Ö –ª–∏—á–Ω–æ—Å—Ç–µ–π
- ‚úÖ 1 –∫–∞—Å—Ç–æ–º–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å
- ‚úÖ –ö–æ–Ω—Ç–µ–∫—Å—Ç: 30 —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è: 3 –¥–Ω—è

**–õ–∏–º–∏—Ç—ã:**
- üîí Cooldown: 60 —Å–µ–∫—É–Ω–¥ –º–µ–∂–¥—É —Å–∞–º–º–∞—Ä–∏
- üîí –ú–∞–∫—Å–∏–º—É–º 50 —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞ —Å–∞–º–º–∞—Ä–∏
- üîí –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞

---

#### ‚≠ê Pro Tier ($2.99/–º–µ—Å—è—Ü –∏–ª–∏ 300 Telegram Stars)
**–í—Å–µ –∏–∑ Free +:**
- ‚ú® –ü—Ä—è–º–æ–µ –æ–±—â–µ–Ω–∏–µ: –¥–æ 500 —Å–æ–æ–±—â–µ–Ω–∏–π/–¥–µ–Ω—å
- ‚ú® –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–æ–≤
- ‚ú® –°–∞–º–º–∞—Ä–∏–∑–∞—Ü–∏—è: –¥–æ 50 —Å–∞–º–º–∞—Ä–∏/–¥–µ–Ω—å
- ‚ú® –°—É–¥–µ–π—Å—Ç–≤–æ: –¥–æ 20 –≤–µ—Ä–¥–∏–∫—Ç–æ–≤/–¥–µ–Ω—å
- ‚ú® –í—Å–µ –±–∞–∑–æ–≤—ã–µ –ª–∏—á–Ω–æ—Å—Ç–∏
- ‚ú® –î–æ 5 –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ª–∏—á–Ω–æ—Å—Ç–µ–π
- ‚ú® –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç: 50 —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚ú® –ò—Å—Ç–æ—Ä–∏—è: 7 –¥–Ω–µ–π
- ‚ú® Cooldown: 30 —Å–µ–∫—É–Ω–¥
- ‚ú® –ú–∞–∫—Å–∏–º—É–º 200 —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞ —Å–∞–º–º–∞—Ä–∏
- ‚ú® –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚ú® –≠–∫—Å–ø–æ—Ä—Ç —Å–∞–º–º–∞—Ä–∏ –≤ —Ñ–∞–π–ª—ã (PDF, TXT, MD)

**–¶–µ–Ω–∞:** $2.99/–º–µ—Å—è—Ü –∏–ª–∏ 300 Telegram Stars (~$3)

---

#### üíé Premium Tier ($9.99/–º–µ—Å—è—Ü –∏–ª–∏ 1000 Telegram Stars)
**–í—Å–µ –∏–∑ Pro +:**
- üíé –ü—Ä—è–º–æ–µ –æ–±—â–µ–Ω–∏–µ: –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ
- üíé –°–∞–º–º–∞—Ä–∏–∑–∞—Ü–∏—è: –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ
- üíé –°—É–¥–µ–π—Å—Ç–≤–æ: –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ
- üíé –î–æ 15 –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ª–∏—á–Ω–æ—Å—Ç–µ–π
- üíé –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç: 100 —Å–æ–æ–±—â–µ–Ω–∏–π
- üíé –ò—Å—Ç–æ—Ä–∏—è: 30 –¥–Ω–µ–π
- üíé –ë–µ–∑ cooldown
- üíé –ú–∞–∫—Å–∏–º—É–º 1000 —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞ —Å–∞–º–º–∞—Ä–∏
- üíé –í—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏
- üíé Scheduled summaries (–∫—Ä–æ–Ω-–∑–∞–¥–∞—á–∏)
- üíé –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (voice ‚Üí text ‚Üí –æ—Ç–≤–µ—Ç)
- üíé –†–∞–Ω–Ω–∏–π –¥–æ—Å—Ç—É–ø –∫ –Ω–æ–≤—ã–º —Ñ–∏—á–∞–º
- üíé –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞

**–¶–µ–Ω–∞:** $9.99/–º–µ—Å—è—Ü –∏–ª–∏ 1000 Telegram Stars (~$10)

---

### üí≥ –°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã

#### 1. Telegram Stars (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1) ‚≠ê
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ù–∞—Ç–∏–≤–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Telegram
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–π API –¥–ª—è –æ–ø–ª–∞—Ç—ã
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤–∞–ª—é—Ç
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- Telegram Bot Payments API
- `python-telegram-bot` –∏–º–µ–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–º–∏—Å—Å–∏—è (~5%)

**–¶–µ–Ω—ã –≤ Stars:**
- Pro: 300 Stars (~$3)
- Premium: 1000 Stars (~$10)

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** https://core.telegram.org/bots/payments

---

#### 2. Crypto –ø–ª–∞—Ç–µ–∂–∏ (TON, USDT) (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2) üíé
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ù–∏–∑–∫–∏–µ –∫–æ–º–∏—Å—Å–∏–∏
- ‚úÖ –î–µ—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è
- ‚úÖ –ì–ª–æ–±–∞–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø
- ‚úÖ TON ‚Äî –Ω–∞—Ç–∏–≤–Ω–∞—è –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞ Telegram

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –º–æ–Ω–µ—Ç—ã:**
- **TON** (The Open Network) - –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
- **USDT** (Tether) - —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –º–æ–Ω–µ—Ç–∞
- **BTC** (Bitcoin) - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ

**–°–µ—Ä–≤–∏—Å—ã –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**
- [@CryptoBot](https://t.me/CryptoBot) - Telegram-–Ω–∞—Ç–∏–≤–Ω—ã–π crypto wallet
- [TON Connect](https://ton.org/dev/payments) - –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π SDK –¥–ª—è TON
- [Cryptomus](https://cryptomus.com/) - –º—É–ª—å—Ç–∏-–∫—Ä–∏–ø—Ç–æ –ø–ª–∞—Ç–µ–∂–∏

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ webhook
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —á–µ—Ä–µ–∑ blockchain explorer
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∫–∏

**–¶–µ–Ω—ã –≤ Crypto:**
- Pro: ~3 USDT –∏–ª–∏ 30 TON
- Premium: ~10 USDT –∏–ª–∏ 100 TON

---

#### 3. Tribute.to (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3) üéÅ
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–æ–≤—ã—Ö –¥–æ–Ω–∞—Ç–æ–≤
- ‚úÖ –ö—Ä–∞—Å–∏–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—è–º–∏
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—É–±–ª–∏—á–Ω—ã—Ö –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–µ–π

**–ú–æ–¥–µ–ª—å:**
- –ù–µ –ø–æ–¥–ø–∏—Å–∫–∞, –∞ **—Ä–∞–∑–æ–≤—ã–µ –¥–æ–Ω–∞—Ç—ã** –∏–ª–∏ **–¥–æ–Ω–∞—Ç-—Ç–∏—Ä**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–æ–Ω–∞—Ç—è—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—É—é —Å—É–º–º—É ‚Üí –ø–æ–ª—É—á–∞—é—Ç –±–æ–Ω—É—Å—ã

**Tribute —Ç–∏—Ä—ã:**
- **$5 –¥–æ–Ω–∞—Ç** ‚Üí Pro –Ω–∞ 2 –º–µ—Å—è—Ü–∞
- **$10 –¥–æ–Ω–∞—Ç** ‚Üí Pro –Ω–∞ 5 –º–µ—Å—è—Ü–µ–≤
- **$25 –¥–æ–Ω–∞—Ç** ‚Üí Premium –Ω–∞ 3 –º–µ—Å—è—Ü–∞
- **$50 –¥–æ–Ω–∞—Ç** ‚Üí Premium –Ω–∞ 7 –º–µ—Å—è—Ü–µ–≤ + –æ—Å–æ–±–∞—è –∫–∞—Å—Ç–æ–º–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- –†—É—á–Ω–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è (–ø–æ–∫–∞ –Ω–µ—Ç API —É Tribute)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–Ω–∞—Ç–∏—Ç ‚Üí –ø—Ä–∏—Å—ã–ª–∞–µ—Ç —Å–∫—Ä–∏–Ω—à–æ—Ç/–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ ‚Üí –∞–¥–º–∏–Ω –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç
- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: webhook —á–µ—Ä–µ–∑ Zapier/Make

**–°—Ç—Ä–∞–Ω–∏—Ü–∞ Tribute:** https://tribute.to/your_bot_page

---

### üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

#### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–¥–ø–∏—Å–æ–∫

**–ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ë–î: `subscriptions`**
```sql
CREATE TABLE subscriptions (
  id SERIAL PRIMARY KEY,
  user_id BIGINT NOT NULL UNIQUE,
  tier VARCHAR(20) NOT NULL,  -- 'free', 'pro', 'premium'
  started_at TIMESTAMP DEFAULT NOW(),
  expires_at TIMESTAMP,  -- NULL –¥–ª—è free tier
  payment_method VARCHAR(50),  -- 'stars', 'ton', 'usdt', 'tribute'
  transaction_id VARCHAR(255),  -- –°—Å—ã–ª–∫–∞ –Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
  is_active BOOLEAN DEFAULT TRUE,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_subscriptions_user ON subscriptions(user_id);
CREATE INDEX idx_subscriptions_expiry ON subscriptions(expires_at);
```

**–ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞: `usage_limits`**
```sql
CREATE TABLE usage_limits (
  id SERIAL PRIMARY KEY,
  user_id BIGINT NOT NULL,
  date DATE DEFAULT CURRENT_DATE,
  messages_count INT DEFAULT 0,
  summaries_count INT DEFAULT 0,
  judge_count INT DEFAULT 0,
  UNIQUE(user_id, date)
);

CREATE INDEX idx_usage_date ON usage_limits(user_id, date);
```

---

#### –ú–æ–¥—É–ª–∏ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**1. `modules/payments.py` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π**
```python
async def handle_payment_stars(update, context):
    """Handle Telegram Stars payment"""
    # Process payment callback
    # Update subscription in DB
    # Send confirmation

async def handle_payment_crypto(update, context):
    """Handle crypto payment verification"""
    # Check transaction on blockchain
    # Update subscription in DB

async def handle_payment_tribute(update, context):
    """Handle Tribute.to donation (manual)"""
    # Show instructions for Tribute
    # Admin verification flow
```

**2. `modules/subscription.py` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏**
```python
async def check_user_tier(user_id: int) -> str:
    """Get user's subscription tier"""
    # Check DB, return 'free', 'pro', or 'premium'

async def check_usage_limit(user_id: int, action: str) -> bool:
    """Check if user exceeded daily limits"""
    # Check usage_limits table
    # Compare with tier limits

async def upgrade_subscription(user_id: int, tier: str, duration_days: int):
    """Upgrade user's subscription"""
    # Update subscriptions table
    # Send confirmation message
```

**3. Middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–∏–º–∏—Ç–æ–≤**
```python
async def check_limits_middleware(update, context):
    """Middleware to check user limits before processing"""
    user_id = update.effective_user.id
    action = determine_action(update)  # 'message', 'summary', 'judge'

    tier = await check_user_tier(user_id)
    can_proceed = await check_usage_limit(user_id, action)

    if not can_proceed:
        await show_upgrade_message(update)
        return False

    return True
```

---

#### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**`/premium` - –ø–æ–∫–∞–∑–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø–ª–∞–Ω—ã**
```
üíé Premium –ø–ª–∞–Ω—ã

üÜì FREE (—Ç–µ–∫—É—â–∏–π –ø–ª–∞–Ω)
‚Ä¢ 50 —Å–æ–æ–±—â–µ–Ω–∏–π/–¥–µ–Ω—å
‚Ä¢ 5 —Å–∞–º–º–∞—Ä–∏/–¥–µ–Ω—å
‚Ä¢ 1 –≥—Ä—É–ø–ø–∞

‚≠ê PRO - $2.99/–º–µ—Å
‚Ä¢ 500 —Å–æ–æ–±—â–µ–Ω–∏–π/–¥–µ–Ω—å
‚Ä¢ 50 —Å–∞–º–º–∞—Ä–∏/–¥–µ–Ω—å
‚Ä¢ –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –≥—Ä—É–ø–ø—ã
‚Ä¢ –≠–∫—Å–ø–æ—Ä—Ç –≤ —Ñ–∞–π–ª—ã

üíé PREMIUM - $9.99/–º–µ—Å
‚Ä¢ –ë–µ–∑ –ª–∏–º–∏—Ç–æ–≤
‚Ä¢ 15 –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ª–∏—á–Ω–æ—Å—Ç–µ–π
‚Ä¢ –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
‚Ä¢ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç

[–ö–Ω–æ–ø–∫–∏: –ö—É–ø–∏—Ç—å Pro | –ö—É–ø–∏—Ç—å Premium | –°—Ä–∞–≤–Ω–∏—Ç—å –ø–ª–∞–Ω—ã]
```

**`/mystatus` - –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å**
```
üìä –¢–≤–æ–π —Å—Ç–∞—Ç—É—Å

–¢–∞—Ä–∏—Ñ: ‚≠ê Pro
–ê–∫—Ç–∏–≤–µ–Ω –¥–æ: 2025-12-17
–û—Å—Ç–∞–ª–æ—Å—å: 30 –¥–Ω–µ–π

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ —Å–µ–≥–æ–¥–Ω—è:
üí¨ –°–æ–æ–±—â–µ–Ω–∏—è: 125/500
üìù –°–∞–º–º–∞—Ä–∏: 12/50
‚öñÔ∏è –°—É–¥–µ–π—Å—Ç–≤–æ: 5/20

[–ö–Ω–æ–ø–∫–∞: –ü—Ä–æ–¥–ª–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É]
```

**`/cancel` - –æ—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É**
```
‚ùå –û—Ç–º–µ–Ω–∞ –ø–æ–¥–ø–∏—Å–∫–∏

–¢—ã —É–≤–µ—Ä–µ–Ω?

–¢–≤–æ–π Pro –ø–ª–∞–Ω –∞–∫—Ç–∏–≤–µ–Ω –¥–æ 2025-12-17.
–ü–æ—Å–ª–µ —ç—Ç–æ–π –¥–∞—Ç—ã –≤–µ—Ä–Ω—ë—à—å—Å—è –Ω–∞ Free –ø–ª–∞–Ω.

[–ö–Ω–æ–ø–∫–∏: –î–∞, –æ—Ç–º–µ–Ω–∏—Ç—å | –ù–µ—Ç, –æ—Å—Ç–∞–≤–∏—Ç—å]
```

---

#### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö:**

1. **`handle_direct_message()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏–π**
```python
tier = await check_user_tier(user_id)
if tier == 'free' and daily_messages >= 50:
    await show_upgrade_message(update, "–õ–∏–º–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–π –∏—Å—á–µ—Ä–ø–∞–Ω")
    return
```

2. **`summary_command()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ —Å–∞–º–º–∞—Ä–∏**
```python
tier = await check_user_tier(user_id)
if tier == 'free' and daily_summaries >= 5:
    await show_upgrade_message(update, "–õ–∏–º–∏—Ç —Å–∞–º–º–∞—Ä–∏ –∏—Å—á–µ—Ä–ø–∞–Ω")
    return
```

3. **`judge_command()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ —Å—É–¥–µ–π—Å—Ç–≤–∞**
```python
tier = await check_user_tier(user_id)
if tier == 'free' and daily_judges >= 3:
    await show_upgrade_message(update, "–õ–∏–º–∏—Ç —Å—É–¥–µ–π—Å—Ç–≤–∞ –∏—Å—á–µ—Ä–ø–∞–Ω")
    return
```

---

### üìà –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

**KPI –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:**
- Conversion rate (free ‚Üí pro): —Ü–µ–ª–µ–≤–æ–π **3-5%**
- Retention rate (—á–µ—Ä–µ–∑ –º–µ—Å—è—Ü): —Ü–µ–ª–µ–≤–æ–π **70%**
- ARPU (Average Revenue Per User): —Ü–µ–ª–µ–≤–æ–π **$1-2**
- Churn rate: —Ü–µ–ª–µ–≤–æ–π **<20%/–º–µ—Å—è—Ü**

**A/B —Ç–µ—Å—Ç—ã:**
- –†–∞–∑–Ω—ã–µ —Ü–µ–Ω—ã ($1.99 vs $2.99 vs $4.99)
- –†–∞–∑–Ω—ã–µ –ª–∏–º–∏—Ç—ã free tier (30 vs 50 vs 100 —Å–æ–æ–±—â–µ–Ω–∏–π)
- –†–∞–∑–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã upgrade —Å–æ–æ–±—â–µ–Ω–∏–π

---

### üöÄ –ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏

**–§–∞–∑–∞ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (1-2 –Ω–µ–¥–µ–ª–∏)**
- [ ] –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã `subscriptions` –∏ `usage_limits`
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `modules/subscription.py` (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏—Ä–æ–≤, –ª–∏–º–∏—Ç–æ–≤)
- [ ] –î–æ–±–∞–≤–∏—Ç—å middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–∏–º–∏—Ç–æ–≤
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã `/premium`, `/mystatus`
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ staging

**–§–∞–∑–∞ 2: Telegram Stars (1 –Ω–µ–¥–µ–ª—è)**
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `modules/payments.py` - Telegram Stars
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Telegram Bot Payments API
- [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å webhook –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π (test mode)
- [ ] Launch –Ω–∞ production

**–§–∞–∑–∞ 3: Crypto (2 –Ω–µ–¥–µ–ª–∏)**
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å @CryptoBot API
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å TON Connect
- [ ] –î–æ–±–∞–≤–∏—Ç—å USDT —á–µ—Ä–µ–∑ Cryptomus
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- [ ] Launch crypto –ø–ª–∞—Ç–µ–∂–µ–π

**–§–∞–∑–∞ 4: Tribute (1 –Ω–µ–¥–µ–ª—è)**
- [ ] –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –Ω–∞ Tribute.to
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä—É—á–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É `/donate`
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å webhook (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)
- [ ] –ü—É–±–ª–∏—á–Ω–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ

**–§–∞–∑–∞ 5: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–ø–æ—Å—Ç–æ—è–Ω–Ω–æ)**
- [ ] –ê–Ω–∞–ª–∏–∑ –º–µ—Ç—Ä–∏–∫ –∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–π
- [ ] A/B —Ç–µ—Å—Ç—ã —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
- [ ] –£–ª—É—á—à–µ–Ω–∏–µ upgrade messaging
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö premium —Ñ–∏—á

---

## üîß –ê–î–ú–ò–ù–ò–°–¢–†–ò–†–û–í–ê–ù–ò–ï

### –§–∏–ª–æ—Å–æ—Ñ–∏—è –∞–¥–º–∏–Ω–∫–∏

**–í–∞–∂–Ω–æ:** –¢—ã –Ω–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç, –ø–æ—ç—Ç–æ–º—É –≤—Å—ë —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ß–ï–†–ï–ó –ë–û–¢–ê –≤ Telegram. –ù–∏–∫–∞–∫–æ–≥–æ SQL, –Ω–∏–∫–∞–∫–æ–≥–æ –∫–æ–¥–∞ - —Ç–æ–ª—å–∫–æ –∫–æ–º–∞–Ω–¥—ã –∏ –∫–Ω–æ–ø–∫–∏.

**–ü—Ä–∏–Ω—Ü–∏–ø—ã:**
1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - —Ç–æ–ª—å–∫–æ —Ç–≤–æ–π Telegram ID –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω–∫–µ
2. **–ü—Ä–æ—Å—Ç–æ—Ç–∞** - –≤—Å—ë —á–µ—Ä–µ–∑ inline-–∫–Ω–æ–ø–∫–∏ –∏ –ø–æ–Ω—è—Ç–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
3. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤—Å–µ —Ç–≤–æ–∏ –¥–µ–π—Å—Ç–≤–∏—è –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è
4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –±–µ–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π
5. **–ü—Ä–æ–º–æ–∫–æ–¥—ã** - –ª–µ–≥–∫–æ –¥–∞–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø –¥—Ä—É–∑—å—è–º

---

### üë§ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–¥–º–∏–Ω–æ–≤

#### –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å —Å–µ–±—è –∞–¥–º–∏–Ω–æ–º

**–®–∞–≥ 1: –£–∑–Ω–∞—Ç—å —Å–≤–æ–π Telegram ID**

–ù–∞–ø–∏—à–∏ –±–æ—Ç—É `/start` –∏ –ø–æ—Å–º–æ—Ç—Ä–∏ –ª–æ–≥–∏ –≤ Vercel. –¢–≤–æ–π ID –±—É–¥–µ—Ç –≤ –ª–æ–≥–µ:
```
INFO: User 123456789 started the bot
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π [@userinfobot](https://t.me/userinfobot) - –æ—Ç–ø—Ä–∞–≤—å –µ–º—É –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.

**–®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å –≤ config.py**

–û—Ç–∫—Ä–æ–π —Ñ–∞–π–ª `config.py` –∏ –¥–æ–±–∞–≤—å —Å–≤–æ–π ID:

```python
# Admin user IDs (–¥–æ–±–∞–≤—å —Å–≤–æ–π ID —Å—é–¥–∞!)
ADMIN_USER_IDS = [
    123456789,      # –¢–≤–æ–π –æ—Å–Ω–æ–≤–Ω–æ–π Telegram ID
    987654321,      # ID –¥—Ä—É–≥–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
]
```

**–®–∞–≥ 3: –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è**

```bash
git add config.py
git commit -m "Add admin user ID"
git push
```

Vercel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è (~2 –º–∏–Ω—É—Ç—ã).

**–®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø**

–ù–∞–ø–∏—à–∏ –±–æ—Ç—É `/admin` - –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è –∞–¥–º–∏–Ω-–º–µ–Ω—é.

---

### üì± –ê–¥–º–∏–Ω—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã

#### `/admin` - –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é

**–ß—Ç–æ –≤–∏–¥–∏—à—å:**
```
üîß –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨

–í—ã–±–µ—Ä–∏ –¥–µ–π—Å—Ç–≤–∏–µ:

[–ö–Ω–æ–ø–∫–∏]
üë§ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫
üéüÔ∏è –ü—Ä–æ–º–æ–∫–æ–¥—ã
üß™ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
üìù –õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π
‚ÑπÔ∏è –°–ø—Ä–∞–≤–∫–∞
```

**–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∞–º!** –û–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É–≤–∏–¥—è—Ç: "–£ —Ç–µ–±—è –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥–µ."

---

#### üë§ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º

**–§–ª–æ—É:**
```
[–ö–ª–∏–∫: "üë§ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º"]
    ‚Üì
[–ë–æ—Ç] ‚Üí "–û—Ç–ø—Ä–∞–≤—å –º–Ω–µ:"
    ‚Ä¢ User ID (–Ω–∞–ø—Ä–∏–º–µ—Ä: 123456789)
    ‚Ä¢ Username (–Ω–∞–ø—Ä–∏–º–µ—Ä: @ivan)
    ‚Ä¢ –ü–µ—Ä–µ—Å–ª–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    ‚Üì
[–û—Ç–ø—Ä–∞–≤–ª—è–µ—à—å] ‚Üí "@ivan"
    ‚Üì
[–ë–æ—Ç] ‚Üí –ö–∞—Ä—Ç–æ—á–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

üìä –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨: @ivan
ID: 123456789

–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:
‚îú‚îÄ –¢–∞—Ä–∏—Ñ: üÜì Free
‚îú‚îÄ –ê–∫—Ç–∏–≤–µ–Ω —Å: 2025-01-15
‚îú‚îÄ –°—Ä–æ–∫: –±–µ—Å—Å—Ä–æ—á–Ω–æ
‚îî‚îÄ –°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã: -

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–µ–≥–æ–¥–Ω—è:
‚îú‚îÄ üí¨ –°–æ–æ–±—â–µ–Ω–∏—è: 12/50
‚îú‚îÄ üìù –°–∞–º–º–∞—Ä–∏: 2/5
‚îî‚îÄ ‚öñÔ∏è –°—É–¥–µ–π—Å—Ç–≤–æ: 0/3

[–ö–Ω–æ–ø–∫–∏]
‚≠ê –í—ã–¥–∞—Ç—å Pro
üíé –í—ã–¥–∞—Ç—å Premium
‚ùå –û—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
üîÑ –°–±—Ä–æ—Å–∏—Ç—å –ª–∏–º–∏—Ç—ã
üìã –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
‚óÄÔ∏è –ù–∞–∑–∞–¥
```

**–î–µ–π—Å—Ç–≤–∏–µ: "‚≠ê –í—ã–¥–∞—Ç—å Pro"**
```
[–ö–ª–∏–∫: "‚≠ê –í—ã–¥–∞—Ç—å Pro"]
    ‚Üì
[–ë–æ—Ç] ‚Üí "–ù–∞ –∫–∞–∫–æ–π —Å—Ä–æ–∫ –≤—ã–¥–∞—Ç—å Pro?"

[–ö–Ω–æ–ø–∫–∏]
7 –¥–Ω–µ–π (—Ç–µ—Å—Ç)
30 –¥–Ω–µ–π (1 –º–µ—Å—è—Ü)
90 –¥–Ω–µ–π (3 –º–µ—Å—è—Ü–∞)
365 –¥–Ω–µ–π (1 –≥–æ–¥)
‚àû –ë–µ—Å—Å—Ä–æ—á–Ω–æ
‚óÄÔ∏è –û—Ç–º–µ–Ω–∞
    ‚Üì
[–ö–ª–∏–∫: "30 –¥–Ω–µ–π"]
    ‚Üì
[–ë–î] ‚Üí –û–±–Ω–æ–≤–∏—Ç—å subscriptions table
    ‚Üì
[–ë–æ—Ç] ‚Üí "‚úÖ –ì–æ—Ç–æ–≤–æ!

@ivan –ø–æ–ª—É—á–∏–ª Pro –Ω–∞ 30 –¥–Ω–µ–π.
–ê–∫—Ç–∏–≤–µ–Ω –¥–æ: 2025-02-17

–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é."
```

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:**
```
üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!

–¢–µ–±–µ –≤—ã–¥–∞–ª–∏ ‚≠ê Pro –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ 30 –¥–Ω–µ–π!

–¢–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω–æ:
‚ú® 500 —Å–æ–æ–±—â–µ–Ω–∏–π/–¥–µ–Ω—å
‚ú® 50 —Å–∞–º–º–∞—Ä–∏/–¥–µ–Ω—å
‚ú® –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –≥—Ä—É–ø–ø—ã
‚ú® –≠–∫—Å–ø–æ—Ä—Ç –≤ —Ñ–∞–π–ª—ã

–ê–∫—Ç–∏–≤–Ω–∞ –¥–æ: 2025-02-17

–°–ø–∞—Å–∏–±–æ –∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞! ‚ù§Ô∏è
```

**–î–µ–π—Å—Ç–≤–∏–µ: "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É"**
```
[–ö–ª–∏–∫: "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É"]
    ‚Üì
[–ë–æ—Ç] ‚Üí "–¢—ã —É–≤–µ—Ä–µ–Ω?

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å @ivan –ø–æ—Ç–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø –∫ Pro.

[–ö–Ω–æ–ø–∫–∏]
‚úÖ –î–∞, –æ—Ç–º–µ–Ω–∏—Ç—å
‚ùå –ù–µ—Ç, –æ—Å—Ç–∞–≤–∏—Ç—å"
    ‚Üì
[–ö–ª–∏–∫: "‚úÖ –î–∞, –æ—Ç–º–µ–Ω–∏—Ç—å"]
    ‚Üì
[–ë–î] ‚Üí tier = 'free', expires_at = NOW()
    ‚Üì
[–ë–æ—Ç] ‚Üí "‚úÖ –ü–æ–¥–ø–∏—Å–∫–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞.

@ivan –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ Free —Ç–∞—Ä–∏—Ñ."
```

**–î–µ–π—Å—Ç–≤–∏–µ: "üîÑ –°–±—Ä–æ—Å–∏—Ç—å –ª–∏–º–∏—Ç—ã"**

–ü–æ–ª–µ–∑–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è - —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç –¥–Ω–µ–≤–Ω—ã–µ –ª–∏–º–∏—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
```
[–ö–ª–∏–∫: "üîÑ –°–±—Ä–æ—Å–∏—Ç—å –ª–∏–º–∏—Ç—ã"]
    ‚Üì
[–ë–î] ‚Üí UPDATE usage_limits SET messages_count=0, summaries_count=0, judge_count=0
    ‚Üì
[–ë–æ—Ç] ‚Üí "‚úÖ –õ–∏–º–∏—Ç—ã —Å–±—Ä–æ—à–µ–Ω—ã!

@ivan –º–æ–∂–µ—Ç —Å–Ω–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏."
```

---

#### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫

**–§–ª–æ—É:**
```
[–ö–ª–∏–∫: "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫"]
    ‚Üì
[–ë–î] ‚Üí –°–æ–±—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ subscriptions
    ‚Üì
[–ë–æ—Ç] ‚Üí

üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–û–î–ü–ò–°–û–ö

–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 1,234

–ü–æ —Ç–∞—Ä–∏—Ñ–∞–º:
‚îú‚îÄ üÜì Free: 1,150 (93%)
‚îú‚îÄ ‚≠ê Pro: 75 (6%)
‚îî‚îÄ üíé Premium: 9 (1%)

–ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏: 84
–ò—Å—Ç—ë–∫—à–∏–µ –∑–∞ 7 –¥–Ω–µ–π: 12

–°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã:
‚îú‚îÄ ‚≠ê Stars: 45 (54%)
‚îú‚îÄ üíé TON: 28 (33%)
‚îú‚îÄ üéüÔ∏è –ü—Ä–æ–º–æ–∫–æ–¥: 8 (10%)
‚îî‚îÄ üéÅ Tribute: 3 (3%)

üí∞ –î–æ—Ö–æ–¥ (–æ—Ü–µ–Ω–∫–∞):
‚îú‚îÄ –≠—Ç–æ—Ç –º–µ—Å—è—Ü: ~$185
‚îî‚îÄ –ü—Ä–æ—à–ª—ã–π –º–µ—Å—è—Ü: ~$120

[–ö–Ω–æ–ø–∫–∏]
üìà –î–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
üì• –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV
‚óÄÔ∏è –ù–∞–∑–∞–¥
```

---

#### üéüÔ∏è –ü—Ä–æ–º–æ–∫–æ–¥—ã

**–ó–∞—á–µ–º –Ω—É–∂–Ω—ã:**
- –î–∞—Ç—å –¥–æ—Å—Ç—É–ø –¥—Ä—É–∑—å—è–º/–±–µ—Ç–∞-—Ç–µ—Å—Ç–µ—Ä–∞–º
- –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ –∞–∫—Ü–∏–∏
- –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –∑–∞ –±–∞–≥–∏
- –ü–æ–¥–∞—Ä–∫–∏ –∞–∫—Ç–∏–≤–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

**–§–ª–æ—É:**
```
[–ö–ª–∏–∫: "üéüÔ∏è –ü—Ä–æ–º–æ–∫–æ–¥—ã"]
    ‚Üì
[–ë–æ—Ç] ‚Üí

üéüÔ∏è –ü–†–û–ú–û–ö–û–î–´

–ê–∫—Ç–∏–≤–Ω—ã–µ –∫–æ–¥—ã: 3

[–°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö]
1. BETA2025
   ‚îú‚îÄ –¢–∞—Ä–∏—Ñ: ‚≠ê Pro (30 –¥–Ω–µ–π)
   ‚îú‚îÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π: 5/20
   ‚îî‚îÄ –°–æ–∑–¥–∞–Ω: 2025-01-10

2. FRIEND
   ‚îú‚îÄ –¢–∞—Ä–∏—Ñ: üíé Premium (90 –¥–Ω–µ–π)
   ‚îú‚îÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π: 2/5
   ‚îî‚îÄ –°–æ–∑–¥–∞–Ω: 2025-01-15

3. BUGFIX
   ‚îú‚îÄ –¢–∞—Ä–∏—Ñ: ‚≠ê Pro (7 –¥–Ω–µ–π)
   ‚îú‚îÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π: 1/1 ‚ùå –∏—Å—á–µ—Ä–ø–∞–Ω
   ‚îî‚îÄ –°–æ–∑–¥–∞–Ω: 2025-01-16

[–ö–Ω–æ–ø–∫–∏]
‚ûï –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥
‚ùå –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥
üìã –ò—Å—Ç–æ—Ä–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π
‚óÄÔ∏è –ù–∞–∑–∞–¥
```

**–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞:**
```
[–ö–ª–∏–∫: "‚ûï –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥"]
    ‚Üì
[–ë–æ—Ç] ‚Üí "–ö–∞–∫–æ–π —Ç–∞—Ä–∏—Ñ –≤—ã–¥–∞–≤–∞—Ç—å?"

[–ö–Ω–æ–ø–∫–∏]
‚≠ê Pro
üíé Premium
‚óÄÔ∏è –û—Ç–º–µ–Ω–∞
    ‚Üì
[–ö–ª–∏–∫: "‚≠ê Pro"]
    ‚Üì
[–ë–æ—Ç] ‚Üí "–ù–∞ –∫–∞–∫–æ–π —Å—Ä–æ–∫?"

[–ö–Ω–æ–ø–∫–∏]
7 –¥–Ω–µ–π
30 –¥–Ω–µ–π
90 –¥–Ω–µ–π
365 –¥–Ω–µ–π
‚óÄÔ∏è –û—Ç–º–µ–Ω–∞
    ‚Üì
[–ö–ª–∏–∫: "30 –¥–Ω–µ–π"]
    ‚Üì
[–ë–æ—Ç] ‚Üí "–°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?"

[–ö–Ω–æ–ø–∫–∏]
1 —Ä–∞–∑ (–æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π)
5 —Ä–∞–∑
10 —Ä–∞–∑
50 —Ä–∞–∑
‚àû –ë–µ–∑ –ª–∏–º–∏—Ç–∞
‚óÄÔ∏è –û—Ç–º–µ–Ω–∞
    ‚Üì
[–ö–ª–∏–∫: "10 —Ä–∞–∑"]
    ‚Üì
[–ë–æ—Ç] ‚Üí "–ü—Ä–∏–¥—É–º–∞–π –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞ (–ª–∞—Ç–∏–Ω–∏—Ü–∞, 4-20 —Å–∏–º–≤–æ–ª–æ–≤):"
    ‚Üì
[–¢—ã –ø–∏—à–µ—à—å] ‚Üí "FRIENDS2025"
    ‚Üì
[–ë–î] ‚Üí –°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å –≤ promo_codes table
    ‚Üì
[–ë–æ—Ç] ‚Üí

‚úÖ –ü–†–û–ú–û–ö–û–î –°–û–ó–î–ê–ù!

–ö–æ–¥: `FRIENDS2025`

–£—Å–ª–æ–≤–∏—è:
‚îú‚îÄ –¢–∞—Ä–∏—Ñ: ‚≠ê Pro
‚îú‚îÄ –°—Ä–æ–∫: 30 –¥–Ω–µ–π
‚îú‚îÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π: 0/10
‚îî‚îÄ –ê–∫—Ç–∏–≤–µ–Ω –¥–æ: –Ω–∞–≤—Å–µ–≥–¥–∞ (–ø–æ–∫–∞ –Ω–µ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ—à—å)

–ß—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç –±–æ—Ç—É: `/promo FRIENDS2025`

[–ö–Ω–æ–ø–∫–∏]
üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –ø—Ä–æ–º–æ–∫–æ–¥–æ–º
üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É
‚óÄÔ∏è –ù–∞–∑–∞–¥
```

**–ö–Ω–æ–ø–∫–∞ "üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –ø—Ä–æ–º–æ–∫–æ–¥–æ–º":**
```
[–ö–ª–∏–∫: "üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –ø—Ä–æ–º–æ–∫–æ–¥–æ–º"]
    ‚Üì
[–ë–æ—Ç] ‚Üí –¢–µ–∫—Å—Ç –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è:

üéÅ –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –ø—Ä–æ–º–æ–∫–æ–¥ –Ω–∞ Pro –ø–æ–¥–ø–∏—Å–∫—É!

–í–≤–µ–¥–∏ –≤ –±–æ—Ç–µ @chto_bilo_v_chate_bot:
`/promo FRIENDS2025`

–ü–æ–ª—É—á–∏—à—å ‚≠ê Pro –Ω–∞ 30 –¥–Ω–µ–π!
–û—Å—Ç–∞–ª–æ—Å—å: 10 –∞–∫—Ç–∏–≤–∞—Ü–∏–π

[Inline-–∫–Ω–æ–ø–∫–∞: –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ ‚Üí]
(—Å—Å—ã–ª–∫–∞: https://t.me/chto_bilo_v_chate_bot?start=promo_FRIENDS2025)
```

---

#### üß™ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º

**–ó–∞—á–µ–º –Ω—É–∂–µ–Ω:**
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—é –±–µ–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –ª–∏–º–∏—Ç–æ–≤
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å UX –∞–ø–≥—Ä–µ–π–¥–∞

**–§–ª–æ—É:**
```
[–ö–ª–∏–∫: "üß™ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º"]
    ‚Üì
[–ë–æ—Ç] ‚Üí

üß™ –¢–ï–°–¢–û–í–´–ô –†–ï–ñ–ò–ú

–¢–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º: ‚ùå –í—ã–∫–ª—é—á–µ–Ω

–ö–æ–≥–¥–∞ –≤–∫–ª—é—á—ë–Ω:
‚úÖ –ú–æ–∂–µ—à—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–ø–∏—Å–∫–∏ –±–µ–∑ –æ–ø–ª–∞—Ç—ã
‚úÖ –í—Å–µ –ø–ª–∞—Ç–µ–∂–∏ –ø–æ–º–µ—á–∞—é—Ç—Å—è –∫–∞–∫ "test"
‚úÖ –õ–∏–º–∏—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –æ–±—ã—á–Ω–æ
‚úÖ –í –ª–æ–≥–∞—Ö –≤–∏–¥–Ω–æ —á—Ç–æ —ç—Ç–æ —Ç–µ—Å—Ç

‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–π —Ç–æ–ª—å–∫–æ –Ω–∞ staging –∏–ª–∏ –¥–ª—è –ª–∏—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è!

[–ö–Ω–æ–ø–∫–∏]
üü¢ –í–∫–ª—é—á–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
‚óÄÔ∏è –ù–∞–∑–∞–¥
    ‚Üì
[–ö–ª–∏–∫: "üü¢ –í–∫–ª—é—á–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º"]
    ‚Üì
[config.TEST_MODE = True]
    ‚Üì
[–ë–æ—Ç] ‚Üí

‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º –í–ö–õ–Æ–ß–Å–ù!

–¢–µ–ø–µ—Ä—å –º–æ–∂–µ—à—å:
‚Ä¢ –í—ã–¥–∞–≤–∞—Ç—å —Å–µ–±–µ –ø–æ–¥–ø–∏—Å–∫–∏: /testpro, /testpremium
‚Ä¢ –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–∞–±–æ—Ç—É –ª–∏–º–∏—Ç–æ–≤: /testlimit
‚Ä¢ –°–±—Ä–∞—Å—ã–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ: /testreset

–ß—Ç–æ–±—ã –≤—ã–∫–ª—é—á–∏—Ç—å: /admin ‚Üí üß™ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º ‚Üí üî¥ –í—ã–∫–ª—é—á–∏—Ç—å
```

**–¢–µ—Å—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
- `/testpro` - –≤—ã–¥–∞—Ç—å —Å–µ–±–µ Pro –Ω–∞ 1 —á–∞—Å (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
- `/testpremium` - –≤—ã–¥–∞—Ç—å —Å–µ–±–µ Premium –Ω–∞ 1 —á–∞—Å
- `/testlimit` - –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–µ –ª–∏–º–∏—Ç—ã
- `/testreset` - —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –ª–∏–º–∏—Ç—ã

---

#### üìù –õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π

**–ó–∞—á–µ–º –Ω—É–∂–Ω—ã:**
- –ü–æ–Ω—è—Ç—å, —á—Ç–æ —Ç—ã –º–µ–Ω—è–ª
- –ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º

**–§–ª–æ—É:**
```
[–ö–ª–∏–∫: "üìù –õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π"]
    ‚Üì
[–ë–î] ‚Üí SELECT * FROM admin_logs ORDER BY created_at DESC LIMIT 50
    ‚Üì
[–ë–æ—Ç] ‚Üí

üìù –õ–û–ì–ò –ê–î–ú–ò–ù–°–ö–ò–• –î–ï–ô–°–¢–í–ò–ô

–ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 –¥–µ–π—Å—Ç–≤–∏–π:

2025-01-17 14:35 | @admin
‚îú‚îÄ –î–µ–π—Å—Ç–≤–∏–µ: –í—ã–¥–∞–Ω–∞ –ø–æ–¥–ø–∏—Å–∫–∞
‚îú‚îÄ –¶–µ–ª—å: @ivan (123456789)
‚îî‚îÄ –î–µ—Ç–∞–ª–∏: Pro, 30 –¥–Ω–µ–π

2025-01-17 14:20 | @admin
‚îú‚îÄ –î–µ–π—Å—Ç–≤–∏–µ: –°–æ–∑–¥–∞–Ω –ø—Ä–æ–º–æ–∫–æ–¥
‚îî‚îÄ –î–µ—Ç–∞–ª–∏: FRIENDS2025, Pro 30d, 10 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π

2025-01-17 14:10 | @admin
‚îú‚îÄ –î–µ–π—Å—Ç–≤–∏–µ: –°–±—Ä–æ—à–µ–Ω—ã –ª–∏–º–∏—Ç—ã
‚îî‚îÄ –¶–µ–ª—å: @petya (987654321)

2025-01-17 13:50 | @admin
‚îú‚îÄ –î–µ–π—Å—Ç–≤–∏–µ: –û—Ç–º–µ–Ω–µ–Ω–∞ –ø–æ–¥–ø–∏—Å–∫–∞
‚îî‚îÄ –¶–µ–ª—å: @vasya (555555555)

[–ö–Ω–æ–ø–∫–∏]
üì• –≠–∫—Å–ø–æ—Ä—Ç –ø–æ–ª–Ω—ã—Ö –ª–æ–≥–æ–≤ (CSV)
üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –ª–æ–≥–∏ (>30 –¥–Ω–µ–π)
‚óÄÔ∏è –ù–∞–∑–∞–¥
```

---

### üóÑÔ∏è –ù–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã –ë–î

#### `promo_codes`
```sql
CREATE TABLE promo_codes (
  id SERIAL PRIMARY KEY,
  code VARCHAR(50) UNIQUE NOT NULL,
  tier VARCHAR(20) NOT NULL,  -- 'pro', 'premium'
  duration_days INT NOT NULL,
  max_uses INT,  -- NULL = unlimited
  current_uses INT DEFAULT 0,
  is_active BOOLEAN DEFAULT TRUE,
  created_by_admin_id BIGINT,
  created_at TIMESTAMP DEFAULT NOW(),
  expires_at TIMESTAMP  -- NULL = never expires
);

CREATE INDEX idx_promo_code ON promo_codes(code);
```

#### `promo_usage`
```sql
CREATE TABLE promo_usage (
  id SERIAL PRIMARY KEY,
  promo_code_id INT REFERENCES promo_codes(id),
  user_id BIGINT NOT NULL,
  used_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_promo_usage_user ON promo_usage(user_id);
```

#### `admin_logs`
```sql
CREATE TABLE admin_logs (
  id BIGSERIAL PRIMARY KEY,
  admin_id BIGINT NOT NULL,
  action_type VARCHAR(50) NOT NULL,  -- 'grant_subscription', 'create_promo', etc.
  target_user_id BIGINT,  -- –µ—Å–ª–∏ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–∞–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
  details JSONB,
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_admin_logs_admin ON admin_logs(admin_id, created_at DESC);
```

---

### üìã –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∫–æ–º–∞–Ω–¥–∞ `/promo`

**–ö–∞–∫ —é–∑–µ—Ä—ã –∞–∫—Ç–∏–≤–∏—Ä—É—é—Ç –ø—Ä–æ–º–æ–∫–æ–¥—ã:**

```
[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å] ‚Üí /promo FRIENDS2025
    ‚Üì
[–ë–î] ‚Üí –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥:
    ‚îú‚îÄ –°—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏?
    ‚îú‚îÄ –ê–∫—Ç–∏–≤–µ–Ω –ª–∏?
    ‚îú‚îÄ –ù–µ –∏—Å—á–µ—Ä–ø–∞–Ω –ª–∏ –ª–∏–º–∏—Ç?
    ‚îî‚îÄ –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ª–∏ —É–∂–µ —ç—Ç–æ—Ç —é–∑–µ—Ä?
    ‚Üì
[–ë–î] ‚Üí –í—ã–¥–∞—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
    ‚Üì
[–ë–æ—Ç] ‚Üí

üéâ –ü–†–û–ú–û–ö–û–î –ê–ö–¢–ò–í–ò–†–û–í–ê–ù!

–¢—ã –ø–æ–ª—É—á–∏–ª ‚≠ê Pro –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ 30 –¥–Ω–µ–π!

–¢–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω–æ:
‚ú® 500 —Å–æ–æ–±—â–µ–Ω–∏–π/–¥–µ–Ω—å
‚ú® 50 —Å–∞–º–º–∞—Ä–∏/–¥–µ–Ω—å
‚ú® –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –≥—Ä—É–ø–ø—ã
‚ú® –≠–∫—Å–ø–æ—Ä—Ç –≤ —Ñ–∞–π–ª—ã

–ê–∫—Ç–∏–≤–Ω–∞ –¥–æ: 2025-02-17

–°–ø–∞—Å–∏–±–æ –∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞! ‚ù§Ô∏è
```

**–ï—Å–ª–∏ –æ—à–∏–±–∫–∞:**
```
‚ùå –ü—Ä–æ–º–æ–∫–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω.

–ü—Ä–æ–≤–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∫–æ–¥–∞ –∏ –ø–æ–ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞.

[–ö–Ω–æ–ø–∫–∞: üíé –ö—É–ø–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É]
```

---

### üõ†Ô∏è –ú–æ–¥—É–ª—å –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

#### `modules/admin.py` - –∞–¥–º–∏–Ω—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã

```python
from telegram import Update, InlineKeyboardButton, InlineKeyboardMarkup
from telegram.ext import ContextTypes
from services import db_service
from config import ADMIN_USER_IDS
import logging

logger = logging.getLogger(__name__)

def is_admin(user_id: int) -> bool:
    """Check if user is admin"""
    return user_id in ADMIN_USER_IDS

async def admin_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Main admin panel - /admin"""
    user_id = update.effective_user.id

    if not is_admin(user_id):
        await update.message.reply_text("‚ùå –£ —Ç–µ–±—è –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥–µ.")
        return

    keyboard = [
        [InlineKeyboardButton("üë§ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º", callback_data="admin_users")],
        [InlineKeyboardButton("üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫", callback_data="admin_stats")],
        [InlineKeyboardButton("üéüÔ∏è –ü—Ä–æ–º–æ–∫–æ–¥—ã", callback_data="admin_promos")],
        [InlineKeyboardButton("üß™ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º", callback_data="admin_test")],
        [InlineKeyboardButton("üìù –õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π", callback_data="admin_logs")],
        [InlineKeyboardButton("‚ÑπÔ∏è –°–ø—Ä–∞–≤–∫–∞", callback_data="admin_help")],
    ]

    reply_markup = InlineKeyboardMarkup(keyboard)
    await update.message.reply_text(
        "üîß *–ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨*\n\n"
        "–í—ã–±–µ—Ä–∏ –¥–µ–π—Å—Ç–≤–∏–µ:",
        parse_mode='Markdown',
        reply_markup=reply_markup
    )

    # Log admin action
    db_service.log_admin_action(user_id, 'opened_admin_panel', {})

async def grant_subscription(admin_id: int, user_id: int, tier: str, days: int):
    """Grant subscription to user"""
    # Update subscriptions table
    success = db_service.grant_subscription(user_id, tier, days)

    if success:
        # Log action
        db_service.log_admin_action(admin_id, 'grant_subscription', {
            'target_user_id': user_id,
            'tier': tier,
            'days': days
        })

        # Notify user
        # ... send notification to user

        return True
    return False

# ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
```

---

### üìñ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –Ω–µ-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞

#### –¢–∏–ø–∏—á–Ω—ã–µ –∑–∞–¥–∞—á–∏ –∏ –∫–∞–∫ –∏—Ö —Ä–µ—à–∞—Ç—å

**–ó–∞–¥–∞—á–∞ 1: –î–∞—Ç—å Pro –ø–æ–¥–ø–∏—Å–∫—É –¥—Ä—É–≥—É**

1. –ù–∞–ø–∏—à–∏ –±–æ—Ç—É `/admin`
2. –ù–∞–∂–º–∏ "üë§ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º"
3. –û—Ç–ø—Ä–∞–≤—å username –¥—Ä—É–≥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `@ivan`)
4. –ù–∞–∂–º–∏ "‚≠ê –í—ã–¥–∞—Ç—å Pro"
5. –í—ã–±–µ—Ä–∏ —Å—Ä–æ–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä: 30 –¥–Ω–µ–π)
6. –ì–æ—Ç–æ–≤–æ! –î—Ä—É–≥ –ø–æ–ª—É—á–∏—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

**–ó–∞–¥–∞—á–∞ 2: –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ –¥–ª—è 10 –¥—Ä—É–∑–µ–π**

1. –ù–∞–ø–∏—à–∏ –±–æ—Ç—É `/admin`
2. –ù–∞–∂–º–∏ "üéüÔ∏è –ü—Ä–æ–º–æ–∫–æ–¥—ã"
3. –ù–∞–∂–º–∏ "‚ûï –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥"
4. –í—ã–±–µ—Ä–∏ —Ç–∞—Ä–∏—Ñ: Pro
5. –í—ã–±–µ—Ä–∏ —Å—Ä–æ–∫: 30 –¥–Ω–µ–π
6. –í—ã–±–µ—Ä–∏ –ª–∏–º–∏—Ç: 10 —Ä–∞–∑
7. –ü—Ä–∏–¥—É–º–∞–π –Ω–∞–∑–≤–∞–Ω–∏–µ: `FRIENDS2025`
8. –ù–∞–∂–º–∏ "üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –ø—Ä–æ–º–æ–∫–æ–¥–æ–º"
9. –û—Ç–ø—Ä–∞–≤—å —Å—Å—ã–ª–∫—É –¥—Ä—É–∑—å—è–º

**–ó–∞–¥–∞—á–∞ 3: –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É**

1. –ù–∞–ø–∏—à–∏ –±–æ—Ç—É `/admin`
2. –ù–∞–∂–º–∏ "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫"
3. –£–≤–∏–¥–∏—à—å –≤—Å–µ —Ü–∏—Ñ—Ä—ã –ø–æ –ø–æ–¥–ø–∏—Å–∫–∞–º

**–ó–∞–¥–∞—á–∞ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—á–µ–º—É —é–∑–µ—Ä –∂–∞–ª—É–µ—Ç—Å—è –Ω–∞ –ª–∏–º–∏—Ç**

1. –ù–∞–ø–∏—à–∏ –±–æ—Ç—É `/admin`
2. –ù–∞–∂–º–∏ "üë§ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º"
3. –û—Ç–ø—Ä–∞–≤—å username –∏–ª–∏ –ø–µ—Ä–µ—à–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. –£–≤–∏–¥–∏—à—å –∫–∞—Ä—Ç–æ—á–∫—É —Å —Ç–µ–∫—É—â–∏–º–∏ –ª–∏–º–∏—Ç–∞–º–∏
5. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ - –Ω–∞–∂–º–∏ "üîÑ –°–±—Ä–æ—Å–∏—Ç—å –ª–∏–º–∏—Ç—ã"

**–ó–∞–¥–∞—á–∞ 5: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å Pro –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ —Å–µ–±–µ**

1. –ù–∞–ø–∏—à–∏ –±–æ—Ç—É `/admin`
2. –ù–∞–∂–º–∏ "üß™ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º"
3. –ù–∞–∂–º–∏ "üü¢ –í–∫–ª—é—á–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º"
4. –ù–∞–ø–∏—à–∏ –±–æ—Ç—É `/testpro`
5. –ü–æ–ª—É—á–∏—à—å Pro –Ω–∞ 1 —á–∞—Å –¥–ª—è —Ç–µ—Å—Ç–æ–≤
6. –ü–æ—Å–ª–µ —Ç–µ—Å—Ç–æ–≤: `/testreset` —á—Ç–æ–±—ã —Å–±—Ä–æ—Å–∏—Ç—å

**–ó–∞–¥–∞—á–∞ 6: –£–∑–Ω–∞—Ç—å –∫—Ç–æ –∫–∞–∫–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª**

1. –ù–∞–ø–∏—à–∏ –±–æ—Ç—É `/admin`
2. –ù–∞–∂–º–∏ "üéüÔ∏è –ü—Ä–æ–º–æ–∫–æ–¥—ã"
3. –ù–∞–∂–º–∏ "üìã –ò—Å—Ç–æ—Ä–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π"
4. –£–≤–∏–¥–∏—à—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–∞—Ü–∏–π

---

### ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- ‚ùå –ù–µ –¥–∞–≤–∞–π —Å–≤–æ–π admin user ID –Ω–∏–∫–æ–º—É
- ‚ùå –ù–µ –¥–µ–ª–∞–π —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –∞–¥–º–∏–Ω–∫–∏ —Å ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–π –ª–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π
- ‚úÖ –î–µ–∞–∫—Ç–∏–≤–∏—Ä—É–π –ø—Ä–æ–º–æ–∫–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ —É—Ç–µ–∫–ª–∏

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º –¥–ª—è –ø—Ä–æ–≤–µ—Ä–æ–∫
- –ù–µ –≤—ã–¥–∞–≤–∞–π —Å–µ–±–µ —Ä–µ–∞–ª—å–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ (—ç—Ç–æ –∏—Å–∫–∞–∑–∏—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É)
- –ü–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–Ω-–∑–∞–ø—É—Å–∫–æ–º –ø—Ä–æ–≤–µ—Ä—å –≤—Å–µ —Ñ–ª–æ—É

**–ü—Ä–æ–º–æ–∫–æ–¥—ã:**
- –î–µ–ª–∞–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è (—á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–ø—É—Ç–∞—Ç—å)
- –ò—Å–ø–æ–ª—å–∑—É–π —Å–º—ã—Å–ª–æ–≤—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è: `BETA2025`, `NEWYEAR`, `BUGFIX`
- –ù–µ –¥–µ–ª–∞–π —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–µ –∫–æ–¥—ã (—Å–ª–æ–∂–Ω–æ –≤–≤–æ–¥–∏—Ç—å)

**–õ–∏–º–∏—Ç—ã:**
- –ù–µ —Å–±—Ä–∞—Å—ã–≤–∞–π –ª–∏–º–∏—Ç—ã –±–µ–∑ –ø—Ä–∏—á–∏–Ω—ã (—é–∑–µ—Ä—ã –º–æ–≥—É—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª—è—Ç—å)
- –ï—Å–ª–∏ —é–∑–µ—Ä —Å—Ç–æ–ª–∫–Ω—É–ª—Å—è —Å –±–∞–≥–æ–º - —Å–±—Ä–æ—Å –ª–∏–º–∏—Ç–∞ —ç—Ç–æ —á–µ—Å—Ç–Ω–∞—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π –ø—Ä–∏—á–∏–Ω—É —Å–±—Ä–æ—Å–∞ –≤ –ª–∏—á–Ω–æ–π –∑–∞–º–µ—Ç–∫–µ

---

### üöÄ –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –∞–¥–º–∏–Ω–∫–∏

**–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞:**
- [ ] –î–æ–±–∞–≤–∏–ª —Å–≤–æ–π Telegram ID –≤ `ADMIN_USER_IDS`
- [ ] –ó–∞–¥–µ–ø–ª–æ–∏–ª –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ Vercel
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —á—Ç–æ `/admin` —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –º–µ–Ω—è
- [ ] –°–æ–∑–¥–∞–ª —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–≤—Ç–æ—Ä–æ–π –∞–∫–∫–∞—É–Ω—Ç)

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- [ ] –í—ã–¥–∞–ª —Ç–µ—Å—Ç–æ–≤–æ–º—É —é–∑–µ—Ä—É Pro —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —á—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–π —é–∑–µ—Ä –ø–æ–ª—É—á–∏–ª —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
- [ ] –°–æ–∑–¥–∞–ª –ø—Ä–æ–º–æ–∫–æ–¥ –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª –µ–≥–æ —Ç–µ—Å—Ç–æ–≤—ã–º —é–∑–µ—Ä–æ–º
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —á—Ç–æ –ª–∏–º–∏—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [ ] –û—Ç–º–µ–Ω–∏–ª –ø–æ–¥–ø–∏—Å–∫—É —Ç–µ—Å—Ç–æ–≤–æ–º—É —é–∑–µ—Ä—É
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª –ª–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π

**Production ready:**
- [ ] –û—Ç–∫–ª—é—á–∏–ª —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
- [ ] –£–¥–∞–ª–∏–ª –≤—Å–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
- [ ] –°–æ–∑–¥–∞–ª 1-2 –ø—Ä–æ–º–æ–∫–æ–¥–∞ –¥–ª—è –ø–µ—Ä–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- [ ] –ì–æ—Ç–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

---

### ‚ö° QuickStart: 5 –º–∏–Ω—É—Ç –¥–æ –∞–¥–º–∏–Ω–∫–∏

**–•–æ—á—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ –Ω–∞—á–∞—Ç—å?**

1. **–£–∑–Ω–∞–π —Å–≤–æ–π Telegram ID:**
   - –ù–∞–ø–∏—à–∏ [@userinfobot](https://t.me/userinfobot) –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
   - –°–∫–æ–ø–∏—Ä—É–π —Å–≤–æ–π ID (–Ω–∞–ø—Ä–∏–º–µ—Ä: 123456789)

2. **–î–æ–±–∞–≤—å —Å–µ–±—è –∞–¥–º–∏–Ω–æ–º:**
   - –û—Ç–∫—Ä–æ–π `config.py`
   - –ù–∞–π–¥–∏ —Å—Ç—Ä–æ–∫—É `ADMIN_USER_IDS = []`
   - –í—Å—Ç–∞–≤—å —Å–≤–æ–π ID: `ADMIN_USER_IDS = [123456789]`
   - –°–æ—Ö—Ä–∞–Ω–∏ —Ñ–∞–π–ª

3. **–ó–∞–¥–µ–ø–ª–æ–π:**
   ```bash
   git add config.py
   git commit -m "Add admin"
   git push
   ```
   –ü–æ–¥–æ–∂–¥–∏ 2 –º–∏–Ω—É—Ç—ã –ø–æ–∫–∞ Vercel –∑–∞–¥–µ–ø–ª–æ–∏—Ç

4. **–ü—Ä–æ–≤–µ—Ä—å –¥–æ—Å—Ç—É–ø:**
   - –ù–∞–ø–∏—à–∏ –±–æ—Ç—É `/admin`
   - –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è –∞–¥–º–∏–Ω-–º–µ–Ω—é —Å –∫–Ω–æ–ø–∫–∞–º–∏

5. **–ì–æ—Ç–æ–≤–æ!**
   –¢–µ–ø–µ—Ä—å —Ç—ã –º–æ–∂–µ—à—å:
   - –í—ã–¥–∞–≤–∞—Ç—å –ø–æ–¥–ø–∏—Å–∫–∏ –¥—Ä—É–∑—å—è–º
   - –°–æ–∑–¥–∞–≤–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥—ã
   - –°–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—é

**–í—Å—ë —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫–∏ –≤ Telegram - –Ω–∏–∫–∞–∫–æ–≥–æ SQL –∏–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è!**

---

### üìö TL;DR: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ß—Ç–æ —ç—Ç–æ?**
–£–¥–æ–±–Ω–∞—è –∞–¥–º–∏–Ω–∫–∞ —á–µ—Ä–µ–∑ Telegram –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–æ–º –±–µ–∑ –∑–Ω–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è.

**–ì–ª–∞–≤–Ω—ã–µ —Ñ–∏—á–∏:**
- üë§ –í—ã–¥–∞—Ç—å/–æ—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É –ª—é–±–æ–º—É —é–∑–µ—Ä—É
- üéüÔ∏è –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ –¥–ª—è –¥—Ä—É–∑–µ–π/—Ç–µ—Å—Ç–µ—Ä–æ–≤
- üìä –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ–¥–ø–∏—Å–æ–∫ –∏ –¥–æ—Ö–æ–¥–∞
- üß™ –ë–µ–∑–æ–ø–∞—Å–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—é
- üìù –õ–æ–≥–∏ –≤—Å–µ—Ö –∞–¥–º–∏–Ω—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π

**–ö–∞–∫ –Ω–∞—á–∞—Ç—å?**
1. –î–æ–±–∞–≤—å —Å–≤–æ–π Telegram ID –≤ `ADMIN_USER_IDS` –≤ config.py
2. –ó–∞–¥–µ–ø–ª–æ–π –∏–∑–º–µ–Ω–µ–Ω–∏—è
3. –ù–∞–ø–∏—à–∏ –±–æ—Ç—É `/admin`
4. –ì–æ—Ç–æ–≤–æ! –í—Å—ë —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ inline-–∫–Ω–æ–ø–∫–∏

**–ì–¥–µ –Ω–∞–π—Ç–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏?**
- –†–∞–∑–¥–µ–ª "üìñ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –Ω–µ-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞" - 6 —Ç–∏–ø–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á
- –ö–æ–º–∞–Ω–¥–∞ `/admin` ‚Üí ‚ÑπÔ∏è –°–ø—Ä–∞–≤–∫–∞ - —Å–ø—Ä–∞–≤–∫–∞ –ø—Ä—è–º–æ –≤ –±–æ—Ç–µ
- CLAUDE.md - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (—ç—Ç–æ—Ç —Ñ–∞–π–ª)

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- –¢–æ–ª—å–∫–æ —Ç–≤–æ–π ID –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø
- –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
- –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º –Ω–µ –ø–æ—Ä—Ç–∏—Ç –ø—Ä–æ–¥–∞–∫—à–Ω

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ù–û–í–û–ì–û —Ñ–ª–æ—É (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1):

**1. –ü–µ—Ä–≤—ã–π –∫–æ–Ω—Ç–∞–∫—Ç –≤ –õ–°:**
- [ ] /start –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ + inline-–º–µ–Ω—é (üí¨ –û–±—â–∞—Ç—å—Å—è / üë• –î–æ–±–∞–≤–∏—Ç—å / üé≠ –õ–∏—á–Ω–æ—Å—Ç—å)
- [ ] –ö–ª–∏–∫ "üí¨ –û–±—â–∞—Ç—å—Å—è –Ω–∞–ø—Ä—è–º—É—é" ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–µ–Ω—é –ª–∏—á–Ω–æ—Å—Ç–µ–π
- [ ] –ö–ª–∏–∫ –Ω–∞ –ª–∏—á–Ω–æ—Å—Ç—å ‚Üí –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ ‚Üí –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –≤ —Å—Ç–∏–ª–µ –ª–∏—á–Ω–æ—Å—Ç–∏
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å –µ—â—ë 10 —Å–æ–æ–±—â–µ–Ω–∏–π ‚Üí –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
- [ ] /lichnost ‚Üí –º–µ–Ω—é —Å–º–µ–Ω—ã –ª–∏—á–Ω–æ—Å—Ç–∏
- [ ] –°–º–µ–Ω–∏—Ç—å –ª–∏—á–Ω–æ—Å—Ç—å ‚Üí –∏—Å—Ç–æ—Ä–∏—è –ù–ï –æ—á–∏—â–∞–µ—Ç—Å—è, —Å—Ç–∏–ª—å –º–µ–Ω—è–µ—Ç—Å—è
- [ ] –ö–ª–∏–∫ "‚ûï –°–æ–∑–¥–∞—Ç—å –ª–∏—á–Ω–æ—Å—Ç—å" ‚Üí ConversationHandler —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –°–æ–∑–¥–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—É—é ‚Üí –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ API

**2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É:**
- [ ] –ö–ª–∏–∫ "üë• –î–æ–±–∞–≤–∏—Ç—å –≤ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç" ‚Üí CTA-—Å–æ–æ–±—â–µ–Ω–∏–µ + –∫–Ω–æ–ø–∫–∞
- [ ] –ö–ª–∏–∫ –∫–Ω–æ–ø–∫–∏ ‚Üí Telegram –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≤—ã–±—Ä–∞—Ç—å –≥—Ä—É–ø–ø—É
- [ ] –î–æ–±–∞–≤–∏—Ç—å –±–æ—Ç–∞ ‚Üí welcome-—Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø–µ
- [ ] Welcome —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–º–∞–Ω–¥—ã: /summary, /chat, /rassudi

**3. –ö–æ–º–∞–Ω–¥—ã –≤ –≥—Ä—É–ø–ø–µ:**
- [ ] /summary –≤ –≥—Ä—É–ø–ø–µ ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–µ–Ω—é –ª–∏—á–Ω–æ—Å—Ç–µ–π
- [ ] –ö–ª–∏–∫ –Ω–∞ –ª–∏—á–Ω–æ—Å—Ç—å ‚Üí —Å–∞–º–º–∞—Ä–∏ –≤ —Å—Ç–∏–ª–µ –ª–∏—á–Ω–æ—Å—Ç–∏
- [ ] /summary 100 ‚Üí —Å–∞–º–º–∞—Ä–∏ 100 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- [ ] /summary 2h ‚Üí —Å–∞–º–º–∞—Ä–∏ –∑–∞ 2 —á–∞—Å–∞
- [ ] /chat ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–µ–Ω—é –ª–∏—á–Ω–æ—Å—Ç–µ–π
- [ ] –ö–ª–∏–∫ –Ω–∞ –ª–∏—á–Ω–æ—Å—Ç—å ‚Üí "–ü–∏—à–∏ –º–Ω–µ —á–µ—Ä–µ–∑ reply/mention"
- [ ] Reply –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç–∞ ‚Üí –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç
- [ ] @bot_mention —Ç–µ–∫—Å—Ç ‚Üí –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç
- [ ] –î—Ä—É–≥–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç ‚Üí –±–æ—Ç –ù–ï –æ—Ç–≤–µ—á–∞–µ—Ç (–Ω–µ –µ–≥–æ —Å–µ—Å—Å–∏—è)
- [ ] –ñ–¥—ë–º 15 –º–∏–Ω—É—Ç ‚Üí —Å–µ—Å—Å–∏—è –∞–≤—Ç–æ–∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è
- [ ] /stop ‚Üí —Å–µ—Å—Å–∏—è –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é
- [ ] /rassudi @user1 @user2 —Å–ø–æ—Ä ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–µ–Ω—é –ª–∏—á–Ω–æ—Å—Ç–µ–π
- [ ] –ö–ª–∏–∫ –Ω–∞ –ª–∏—á–Ω–æ—Å—Ç—å ‚Üí –≤–µ—Ä–¥–∏–∫—Ç –≤ —Å—Ç–∏–ª–µ –ª–∏—á–Ω–æ—Å—Ç–∏

**4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç –±–µ–∑ –≤—ã–±–æ—Ä–∞ –ª–∏—á–Ω–æ—Å—Ç–∏ ‚Üí –ø–æ–¥—Å–∫–∞–∑–∫–∞ "/lichnost"
- [ ] /summary –≤ –ø—É—Å—Ç–æ–º —á–∞—Ç–µ ‚Üí "–ù–∞–ø–∏—à–∏—Ç–µ —Ö–æ—Ç—è –±—ã 10 —Å–æ–æ–±—â–µ–Ω–∏–π"
- [ ] /rassudi –±–µ–∑ @username ‚Üí –ø–æ–¥—Å–∫–∞–∑–∫–∞ —Å –ø—Ä–∏–º–µ—Ä–æ–º
- [ ] /chat –∫–æ–≥–¥–∞ —Å–µ—Å—Å–∏—è –∞–∫—Ç–∏–≤–Ω–∞ ‚Üí "–°–µ—Å—Å–∏—è —É–∂–µ –∑–∞–ø—É—â–µ–Ω–∞, /stop –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è"
- [ ] Cooldown –∞–∫—Ç–∏–≤–µ–Ω ‚Üí "–ü–æ–¥–æ–∂–¥–∏ X —Å–µ–∫—É–Ω–¥"

#### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ LEGACY —Ñ—É–Ω–∫—Ü–∏–π:

5. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –≥—Ä—É–ø–ø—É —Å –¥—Ä—É–∑—å—è–º–∏
6. –î–æ–±–∞–≤–∏—Ç—å –±–æ—Ç–∞
7. –ù–∞–ø–∏—Å–∞—Ç—å 50+ —Å–æ–æ–±—â–µ–Ω–∏–π
8. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã:
   - [ ] /start –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
   - [ ] /help –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø—Ä–∞–≤–∫—É
   - [ ] /sut –≤ –≥—Ä—É–ø–ø–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
   - [ ] /sut –≤ –õ–° –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–Ω–æ–ø–∫–∏ —á–∞—Ç–æ–≤
   - [ ] –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ ‚Üí —Å–∞–º–º–∞—Ä–∏ –≤ –õ–°
   - [ ] /rassudi –≤—ã–¥–∞—ë—Ç –≤–µ—Ä–¥–∏–∫—Ç
   - [ ] /lichnost –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª–∏—á–Ω–æ—Å—Ç–∏
   - [ ] –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–π –ª–∏—á–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
   - [ ] /stats –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
9. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ (–ø–æ–¥–æ–∂–¥–∞—Ç—å 3 –¥–Ω—è)
10. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∑–∞—Å–ø–∞–º–∏—Ç—å (cooldown –¥–æ–ª–∂–µ–Ω —Å—Ä–∞–±–æ—Ç–∞—Ç—å)
11. –£–¥–∞–ª–∏—Ç—å –±–æ—Ç–∞ (–¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –æ—á–∏—Å—Ç–∏—Ç—å—Å—è)

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- [ ] HMAC –ø–æ–¥–ø–∏—Å–∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è
- [ ] –ù–µ–ª—å–∑—è –ø–æ–ª—É—á–∏—Ç—å —Å–∞–º–º–∞—Ä–∏ —á–∞—Ç–∞ –≥–¥–µ –Ω–µ —Å–æ—Å—Ç–æ–∏—à—å
- [ ] Rate limiting –±–ª–æ–∫–∏—Ä—É–µ—Ç —Å–ø–∞–º
- [ ] Cooldown –±–ª–æ–∫–∏—Ä—É–µ—Ç —á–∞—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤ —á–∞—Ç–µ
- [ ] Sanitization –±–ª–æ–∫–∏—Ä—É–µ—Ç prompt injection
- [ ] –ù–µ–ª—å–∑—è —Å–æ–∑–¥–∞—Ç—å –ª–∏—á–Ω–æ—Å—Ç—å —Å –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏

---

## üí° –ö–õ–Æ–ß–ï–í–´–ï –ú–û–ú–ï–ù–¢–´ –î–õ–Ø CLAUDE

### –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –∫–æ–¥–æ–º:

1. **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å** - –∫–∞–∂–¥–∞—è —Ñ–∏—á–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –º–æ–¥—É–ª–µ
2. **–¢–∏–ø–∏–∑–∞—Ü–∏—è** - –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å type hints
3. **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏** - docstrings –≤–µ–∑–¥–µ
4. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** - –≤—Å—ë —á–µ—Ä–µ–∑ config.py
5. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –≤—Å–µ–≥–¥–∞ sanitize –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥
6. **–ü—Ä–æ–≤–µ—Ä–∫–∏** - –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —á–ª–µ–Ω—Å—Ç–≤–æ –ø–µ—Ä–µ–¥ –¥–æ—Å—Ç—É–ø–æ–º –∫ –¥–∞–Ω–Ω—ã–º
7. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (–æ—Å–æ–±–µ–Ω–Ω–æ –∞–¥–º–∏–Ω—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è!)
8. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - try/except –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö API
9. **User-friendly** - –ø–æ–º–Ω–∏, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç - –≤—Å—ë –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —á–µ—Ä–µ–∑ inline-–∫–Ω–æ–ø–∫–∏ –≤ Telegram

### –í–∞–∂–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:

- –ö–æ–º–∞–Ω–¥—ã —Ç–æ–ª—å–∫–æ –Ω–∞ LATIN (Telegram API requirement)
- Pure WSGI (–±–µ–∑ Werkzeug –¥–ª—è Vercel)
- Application.initialize() –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
- Graceful degradation –¥–ª—è –∏–º–ø–æ—Ä—Ç–æ–≤
- HMAC –¥–ª—è callback_data –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- Rate limiting –∏ cooldown –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –∞–±—É–∑–∞

### –°–ø–µ—Ü–∏—Ñ–∏–∫–∞ –ù–û–í–û–ì–û —Ñ–ª–æ—É:

1. **–ù–µ—Ç –¥–µ—Ñ–æ–ª—Ç–Ω–æ–π –ª–∏—á–Ω–æ—Å—Ç–∏** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –í–°–ï–ì–î–ê –≤—ã–±–∏—Ä–∞–µ—Ç —è–≤–Ω–æ
2. **Inline-–º–µ–Ω—é –≤–µ–∑–¥–µ** - –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è —á–µ—Ä–µ–∑ callback_query —Å –∫–Ω–æ–ø–∫–∞–º–∏
3. **–ö–æ–Ω—Ç–µ–∫—Å—Ç –∏—Å—Ç–æ—Ä–∏–∏** - —Ö—Ä–∞–Ω–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ N —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è —Å–≤—è–∑–Ω–æ—Å—Ç–∏ –¥–∏–∞–ª–æ–≥–∞
4. **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è** - –∫–∞–∂–¥–∞—è –ª–∏—á–Ω–æ—Å—Ç—å –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
5. **–°–µ—Å—Å–∏–∏ —á–∞—Ç–∞** - –¥–ª—è /chat –≤ –≥—Ä—É–ø–ø–∞—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É –∏–ª–∏ bot_data
6. **User-friendly –æ—à–∏–±–∫–∏** - –≤—Å–µ–≥–¥–∞ –¥–∞–≤–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫–∏, —á—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ
7. **HMAC –¥–ª—è –≤—Å–µ–≥–æ** - –ª—é–±–æ–π callback_data –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–¥–ø–∏—Å–∞–Ω
8. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ API** - –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ª–∏—á–Ω–æ—Å—Ç–µ–π –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏
9. **–ê–¥–º–∏–Ω–∫–∞ –¥–ª—è –Ω–µ-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–æ–≤** - –≤—Å—ë —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—ã, –Ω–∏–∫–∞–∫–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –ë–î –∏–ª–∏ –∫–æ–¥—É

### –°–ø–µ—Ü–∏—Ñ–∏–∫–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è:

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤** - –∫–∞–∂–¥–∞—è –∞–¥–º–∏–Ω—Å–∫–∞—è –∫–æ–º–∞–Ω–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `user_id in ADMIN_USER_IDS`
2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –∞–¥–º–∏–Ω–∞ –ø–∏—à—É—Ç—Å—è –≤ `admin_logs`
3. **ConversationHandler** - –¥–ª—è –º–Ω–æ–≥–æ—à–∞–≥–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (—Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞)
4. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - –∫–æ–≥–¥–∞ –∞–¥–º–∏–Ω –≤—ã–¥–∞—ë—Ç –ø–æ–¥–ø–∏—Å–∫—É, —é–∑–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
5. **–¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º** - —Ñ–ª–∞–≥ –≤ config, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –ø–ª–∞—Ç–µ–∂–∞–º–∏
6. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –ø—Ä–æ–º–æ–∫–æ–¥—ã –Ω–µ —Ö—Ä–∞–Ω—è—Ç –ø–∞—Ä–æ–ª–∏, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è secure random
7. **–í–∞–ª–∏–¥–∞—Ü–∏—è** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö (—Å—Ä–æ–∫ –ø–æ–¥–ø–∏—Å–∫–∏, –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞)
8. **User-friendly –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - –ø–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ –∫–∞–∂–¥–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏

### –ü–æ—Ä—è–¥–æ–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ —Ñ–ª–æ—É:

**–§–∞–∑–∞ 1: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–ë–î + —Å–µ—Ä–≤–∏—Å—ã)**
1. SQL –º–∏–≥—Ä–∞—Ü–∏–∏ (–¥–æ–±–∞–≤–∏—Ç—å greeting_message, active_chat_sessions)
2. –û–±–Ω–æ–≤–∏—Ç—å `db_service.py` (chat history, sessions)
3. –û–±–Ω–æ–≤–∏—Ç—å `ai_service.py` (chat response, greetings)

**–§–∞–∑–∞ 2: –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (direct chat)**
1. –°–æ–∑–¥–∞—Ç—å `direct_chat.py` (personality selection, message handling)
2. –û–±–Ω–æ–≤–∏—Ç—å `/start` –≤ `commands.py` (inline-–º–µ–Ω—é)
3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ 1-–Ω–∞-1 –æ–±—â–µ–Ω–∏—è –≤ –õ–°

**–§–∞–∑–∞ 3: –ì—Ä—É–ø–ø–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª**
1. –°–æ–∑–¥–∞—Ç—å `onboarding.py` (welcome messages)
2. –î–æ–±–∞–≤–∏—Ç—å `/summary` –≤ `summaries.py`
3. –î–æ–±–∞–≤–∏—Ç—å `/chat` –≤ `direct_chat.py`
4. –û–±–Ω–æ–≤–∏—Ç—å `/rassudi` –≤ `judge.py` (–º–µ–Ω—é –ª–∏—á–Ω–æ—Å—Ç–µ–π)
5. –î–æ–±–∞–≤–∏—Ç—å `/stop` –≤ `commands.py`

**–§–∞–∑–∞ 4: –ü–æ–ª–∏—Ä–æ–≤–∫–∞**
1. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –¥–ª—è –≤—Å–µ—Ö 7 –ª–∏—á–Ω–æ—Å—Ç–µ–π
2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ñ–ª–æ—É
3. –û–±—Ä–∞–±–æ—Ç–∫–∞ edge cases
4. Deployment

### –ü—Ä–∏–º–µ—Ä—ã callback_data —Å—Ç—Ä—É–∫—Ç—É—Ä:

```python
# –í—ã–±–æ—Ä –ª–∏—á–Ω–æ—Å—Ç–∏ –¥–ª—è –ø—Ä—è–º–æ–≥–æ —á–∞—Ç–∞
callback_data = "select_personality:bydlan"

# –í—ã–±–æ—Ä –ª–∏—á–Ω–æ—Å—Ç–∏ –¥–ª—è —Å–∞–º–º–∞—Ä–∏
callback_data = "summary_personality:bydlan:100"  # bydlan, 100 messages

# –í—ã–±–æ—Ä –ª–∏—á–Ω–æ—Å—Ç–∏ –¥–ª—è —Å—É–¥–µ–π—Å—Ç–≤–∞
callback_data = "judge_personality:gopnik:user_hash"

# –ó–∞–ø—É—Å–∫ —Å–µ—Å—Å–∏–∏ —á–∞—Ç–∞ –≤ –≥—Ä—É–ø–ø–µ
callback_data = "start_chat:philosopher"

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É (URL button)
url = "https://t.me/YourBot?startgroup=true"
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ direct chat:

```python
# –ü—Å–µ–≤–¥–æ–∫–æ–¥ –¥–ª—è handle_message()
def handle_message(update, context):
    user_id = update.effective_user.id
    chat_id = update.effective_chat.id
    message = update.message.text

    # 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—ã–±—Ä–∞–Ω–∞ –ª–∏ –ª–∏—á–Ω–æ—Å—Ç—å
    personality = db.get_user_personality(user_id)
    if not personality:
        return "–í—ã–±–µ—Ä–∏ –ª–∏—á–Ω–æ—Å—Ç—å: /lichnost"

    # 2. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ —é–∑–µ—Ä–∞
    db.save_message(chat_id, user_id, message)

    # 3. –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 —Å–æ–æ–±—â–µ–Ω–∏–π)
    history = db.get_chat_history(chat_id, user_id, limit=30)

    # 4. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞
    response = ai_service.generate_chat_response(
        personality=personality,
        history=history,
        message=message
    )

    # 5. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å
    update.message.reply_text(response)
    db.save_message(chat_id, bot_id, response)
```

---

## ‚ùì FAQ: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ

### –û–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã

**Q: –Ø –Ω–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç, —Å–º–æ–≥—É –ª–∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –±–æ—Ç–æ–º?**
A: –î–∞! –í—Å—è –∞–¥–º–∏–Ω–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—ã –≤ Telegram. –¢–µ–±–µ –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –¥–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–π ID –≤ config.py –∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å - –¥–∞–ª—å—à–µ –≤—Å—ë —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫–∏.

**Q: –ö–∞–∫ —É–∑–Ω–∞—Ç—å —Å–≤–æ–π Telegram ID?**
A: –ù–∞–ø–∏—à–∏ [@userinfobot](https://t.me/userinfobot) –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –æ–Ω –ø–æ–∫–∞–∂–µ—Ç —Ç–≤–æ–π ID.

**Q: –ú–æ–∂–Ω–æ –ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–æ–≤?**
A: –î–∞! –í config.py: `ADMIN_USER_IDS = [123456789, 987654321, 555555555]`

**Q: –ß—Ç–æ –±—É–¥–µ—Ç –µ—Å–ª–∏ –ø–æ—Ç–µ—Ä—è—é –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω-–∞–∫–∫–∞—É–Ω—Ç—É?**
A: –ù—É–∂–Ω–æ –±—É–¥–µ—Ç —á–µ—Ä–µ–∑ Vercel Dashboard –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å `ADMIN_USER_IDS` –≤ config.py –∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å.

---

### –ü–æ–¥–ø–∏—Å–∫–∏ –∏ –ª–∏–º–∏—Ç—ã

**Q: –ö–∞–∫ –¥–∞—Ç—å –¥—Ä—É–≥—É –±–µ—Å–ø–ª–∞—Ç–Ω—É—é –ø–æ–¥–ø–∏—Å–∫—É?**
A: `/admin` ‚Üí üë§ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º ‚Üí –û—Ç–ø—Ä–∞–≤—å username –¥—Ä—É–≥–∞ ‚Üí ‚≠ê –í—ã–¥–∞—Ç—å Pro ‚Üí –í—ã–±–µ—Ä–∏ —Å—Ä–æ–∫

**Q: –ú–æ–∂–Ω–æ –ª–∏ –¥–∞–≤–∞—Ç—å –±–µ—Å—Å—Ä–æ—á–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏?**
A: –î–∞! –ü—Ä–∏ –≤—ã–¥–∞—á–µ –ø–æ–¥–ø–∏—Å–∫–∏ –µ—Å—Ç—å –æ–ø—Ü–∏—è "‚àû –ë–µ—Å—Å—Ä–æ—á–Ω–æ"

**Q: –ö–∞–∫ —Å–±—Ä–æ—Å–∏—Ç—å –ª–∏–º–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –µ—Å–ª–∏ –æ–Ω —Å—Ç–æ–ª–∫–Ω—É–ª—Å—è —Å –±–∞–≥–æ–º?**
A: `/admin` ‚Üí üë§ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º ‚Üí –û—Ç–ø—Ä–∞–≤—å username ‚Üí üîÑ –°–±—Ä–æ—Å–∏—Ç—å –ª–∏–º–∏—Ç—ã

**Q: –õ–∏–º–∏—Ç—ã —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏?**
A: –î–∞, –≤ 00:00 UTC —Å—á–µ—Ç—á–∏–∫–∏ –æ–±–Ω—É–ª—è—é—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

---

### –ü—Ä–æ–º–æ–∫–æ–¥—ã

**Q: –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ –¥–ª—è 10 –¥—Ä—É–∑–µ–π?**
A: `/admin` ‚Üí üéüÔ∏è –ü—Ä–æ–º–æ–∫–æ–¥—ã ‚Üí ‚ûï –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ ‚Üí –í—ã–±–µ—Ä–∏ —Ç–∞—Ä–∏—Ñ/—Å—Ä–æ–∫/–ª–∏–º–∏—Ç ‚Üí –ü—Ä–∏–¥—É–º–∞–π –Ω–∞–∑–≤–∞–Ω–∏–µ

**Q: –ú–æ–∂–µ—Ç –ª–∏ –æ–¥–∏–Ω —á–µ–ª–æ–≤–µ–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ –¥–≤–∞–∂–¥—ã?**
A: –ù–µ—Ç, –∫–∞–∂–¥—ã–π –ø—Ä–æ–º–æ–∫–æ–¥ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ 1 —Ä–∞–∑ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**Q: –ß—Ç–æ –µ—Å–ª–∏ –ø—Ä–æ–º–æ–∫–æ–¥ "—É—Ç—ë–∫" –∏ –∏–º –Ω–∞—á–∞–ª–∏ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª—è—Ç—å?**
A: `/admin` ‚Üí üéüÔ∏è –ü—Ä–æ–º–æ–∫–æ–¥—ã ‚Üí ‚ùå –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ ‚Üí –í—ã–±–µ—Ä–∏ –ø—Ä–æ–º–æ–∫–æ–¥ ‚Üí –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å

**Q: –ú–æ–∂–Ω–æ –ª–∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø—Ä–æ–º–æ–∫–æ–¥?**
A: –î–∞! `/admin` ‚Üí üéüÔ∏è –ü—Ä–æ–º–æ–∫–æ–¥—ã ‚Üí üìã –ò—Å—Ç–æ—Ä–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π

---

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**Q: –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å Pro –ø–æ–¥–ø–∏—Å–∫—É –Ω–µ –ø–æ—Ä—Ç—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É?**
A: `/admin` ‚Üí üß™ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º ‚Üí üü¢ –í–∫–ª—é—á–∏—Ç—å ‚Üí –ù–∞–ø–∏—à–∏ `/testpro` ‚Üí –ü–æ–ª—É—á–∏—à—å Pro –Ω–∞ 1 —á–∞—Å

**Q: –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º?**
A: –ü–æ–º–µ—á–∞–µ—Ç –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –∫–∞–∫ "test", —á—Ç–æ–±—ã –æ–Ω–∏ –Ω–µ –ø–æ–ø–∞–ª–∏ –≤ —Ä–µ–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É. –õ–∏–º–∏—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –æ–±—ã—á–Ω–æ.

**Q: –ó–∞–±—ã–ª –≤—ã–∫–ª—é—á–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–Ω–æ–º!**
A: –ù–∏—á–µ–≥–æ —Å—Ç—Ä–∞—à–Ω–æ–≥–æ - –ø—Ä–æ—Å—Ç–æ –≤—ã–∫–ª—é—á–∏ —á–µ—Ä–µ–∑ `/admin` ‚Üí üß™ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º ‚Üí üî¥ –í—ã–∫–ª—é—á–∏—Ç—å

---

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –ª–æ–≥–∏

**Q: –ö–∞–∫ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–∫–æ–ª—å–∫–æ –¥–µ–Ω–µ–≥ –∑–∞—Ä–∞–±–æ—Ç–∞–ª?**
A: `/admin` ‚Üí üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫ ‚Üí –í–Ω–∏–∑—É –±—É–¥–µ—Ç "üí∞ –î–æ—Ö–æ–¥ (–æ—Ü–µ–Ω–∫–∞)"

**Q: –ü–æ—á–µ–º—É –æ—Ü–µ–Ω–∫–∞ –¥–æ—Ö–æ–¥–∞ –Ω–µ —Ç–æ—á–Ω–∞—è?**
A: –ë–æ—Ç –Ω–µ –∑–Ω–∞–µ—Ç —Ç–æ—á–Ω—ã–µ –∫–æ–º–∏—Å—Å–∏–∏ –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö —Å–∏—Å—Ç–µ–º. –û—Ü–µ–Ω–∫–∞ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ç–∞—Ä–∏—Ñ–∞–º –±–µ–∑ —É—á–µ—Ç–∞ –∫–æ–º–∏—Å—Å–∏–π.

**Q: –ú–æ–∂–Ω–æ –ª–∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π?**
A: –î–∞! `/admin` ‚Üí üìù –õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π ‚Üí üì• –≠–∫—Å–ø–æ—Ä—Ç –ø–æ–ª–Ω—ã—Ö –ª–æ–≥–æ–≤ (CSV)

**Q: –ó–∞—á–µ–º –≤–æ–æ–±—â–µ –Ω—É–∂–Ω—ã –ª–æ–≥–∏?**
A: –î–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–∫—Ç–æ —á—Ç–æ –¥–µ–ª–∞–ª) –∏ –æ—Ç–ª–∞–¥–∫–∏ (—á—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫).

---

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**Q: –ú–æ–∂–µ—Ç –ª–∏ –∫—Ç–æ-—Ç–æ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω–∫–µ?**
A: –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ —É–∑–Ω–∞–µ—Ç —Ç–≤–æ–π Telegram ID –ò –ø–æ–ª—É—á–∏—Ç –¥–æ—Å—Ç—É–ø –∫ config.py. –ó–∞—â–∏—â–∞–π—Å—è: –Ω–µ –¥–∞–≤–∞–π ID, –Ω–µ –¥–µ–ª–∞–π —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –∞–¥–º–∏–Ω–∫–∏.

**Q: –ß—Ç–æ –±—É–¥–µ—Ç –µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ —É–∑–Ω–∞–µ—Ç –º–æ–π admin user ID?**
A: –ù–∏—á–µ–≥–æ, –µ—Å–ª–∏ —É –Ω–µ–≥–æ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–≤–æ–µ–º—É Telegram –∞–∫–∫–∞—É–Ω—Ç—É. ID —Å–∞–º –ø–æ —Å–µ–±–µ –Ω–µ –¥–∞—ë—Ç –¥–æ—Å—Ç—É–ø–∞.

**Q: –ú–æ–∂–Ω–æ –ª–∏ —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –ª–æ–≥–∏?**
A: –î–∞! `/admin` ‚Üí üìù –õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π ‚Üí üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –ª–æ–≥–∏ (>30 –¥–Ω–µ–π)

---

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã

**Q: –ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –ø–æ–¥–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π?**
A: –í —Ç–∞–±–ª–∏—Ü–µ `subscriptions` –≤ Supabase. –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥—ã –∏–ª–∏ –Ω–∞–ø—Ä—è–º—É—é –≤ Supabase Dashboard.

**Q: –ß—Ç–æ –µ—Å–ª–∏ —è —Å–ª—É—á–∞–π–Ω–æ –≤—ã–¥–∞–ª –Ω–µ —Ç—É –ø–æ–¥–ø–∏—Å–∫—É?**
A: `/admin` ‚Üí üë§ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º ‚Üí –û—Ç–ø—Ä–∞–≤—å username ‚Üí ‚ùå –û—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É ‚Üí –í—ã–¥–∞–π –ø—Ä–∞–≤–∏–ª—å–Ω—É—é

**Q: –ú–æ–∂–Ω–æ –ª–∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ —á–µ—Ä–µ–∑ Supabase –Ω–∞–ø—Ä—è–º—É—é?**
A: –î–∞, –Ω–æ –ù–ï —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è - –ª–æ–≥–∏ –∞–¥–º–∏–Ω—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π –Ω–µ –∑–∞–ø–∏—à—É—Ç—Å—è. –ò—Å–ø–æ–ª—å–∑—É–π `/admin`.

**Q: –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å—Ç–µ—á–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–æ–∫?**
A: –ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è `expires_at` - –µ—Å–ª–∏ –∏—Å—Ç—ë–∫, —é–∑–µ—Ä –æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–∞ Free.

---

### Troubleshooting

**Q: –ù–∞–ø–∏—Å–∞–ª `/admin` –Ω–æ –±–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç**
A: –ü—Ä–æ–≤–µ—Ä—å:
1. –¢–≤–æ–π ID –¥–æ–±–∞–≤–ª–µ–Ω –≤ `ADMIN_USER_IDS` –≤ config.py?
2. –ò–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–¥–µ–ø–ª–æ–µ–Ω—ã –Ω–∞ Vercel?
3. –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö Vercel?

**Q: –°–æ–∑–¥–∞–ª –ø—Ä–æ–º–æ–∫–æ–¥ –Ω–æ –æ–Ω –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç**
A: –ü—Ä–æ–≤–µ—Ä—å:
1. –ü—Ä–æ–º–æ–∫–æ–¥ –∞–∫—Ç–∏–≤–µ–Ω? (`is_active = true`)
2. –ù–µ –∏—Å—á–µ—Ä–ø–∞–Ω –ª–∏–º–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π?
3. –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ —é–∑–µ—Ä –≤–≤–æ–¥–∏—Ç –∫–æ–¥ (—Ä–µ–≥–∏—Å—Ç—Ä –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ)?

**Q: –í—ã–¥–∞–ª –ø–æ–¥–ø–∏—Å–∫—É –Ω–æ —é–∑–µ—Ä –µ—ë –Ω–µ –ø–æ–ª—É—á–∏–ª**
A: –ü—Ä–æ–≤–µ—Ä—å:
1. –õ–æ–≥–∏ –∞–¥–º–∏–Ω—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π - –∑–∞–ø–∏—Å–∞–ª–æ—Å—å –ª–∏ –¥–µ–π—Å—Ç–≤–∏–µ?
2. –¢–∞–±–ª–∏—Ü—É `subscriptions` –≤ Supabase - –ø–æ—è–≤–∏–ª–∞—Å—å –ª–∏ –∑–∞–ø–∏—Å—å?
3. –ù–µ—Ç –ª–∏ –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö Vercel –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è?

---

## üìö –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø

- **README.md** - –æ—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
- **README_CLEANUP.md** - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ cleanup —Å–∫—Ä–∏–ø—Ç—É
- **CLAUDE.md** - —ç—Ç–æ—Ç —Ñ–∞–π–ª, –¥–ª—è Claude Code
- **sql/*.sql** - SQL —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –ë–î

---

## üêõ –ò–ó–í–ï–°–¢–ù–´–ï –û–°–û–ë–ï–ù–ù–û–°–¢–ò

### Vercel Serverless Limitations

1. **No background tasks** - –Ω–µ–ª—å–∑—è –∑–∞–ø—É—Å–∫–∞—Ç—å —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏
2. **Stateless** - –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –Ω–µ–∑–∞–≤–∏—Å–∏–º
3. **Timeout** - –º–∞–∫—Å–∏–º—É–º 10 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∑–∞–ø—Ä–æ—Å
4. **No cron jobs** - –¥–ª—è scheduled tasks –Ω—É–∂–µ–Ω –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å

### –†–µ—à–µ–Ω–∏—è:

- **–ê–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ** - –ø—Ä–∏ –∫–∞–∂–¥–æ–º –Ω–æ–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏
- **Cleanup —Å–∫—Ä–∏–ø—Ç** - –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
- **User data** - —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ bot_data —á–µ—Ä–µ–∑ persistence
- **Cooldown** - in-memory, –ø–µ—Ä–µ–∂–∏–≤–∞–µ—Ç –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ –±–ª–∞–≥–æ–¥–∞—Ä—è bot_data

---

## üîó –ü–û–õ–ï–ó–ù–´–ï –°–°–´–õ–ö–ò

- [python-telegram-bot docs](https://docs.python-telegram-bot.org/)
- [Anthropic Claude API](https://docs.anthropic.com/)
- [Supabase docs](https://supabase.com/docs)
- [Vercel Python runtime](https://vercel.com/docs/runtimes#official-runtimes/python)

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-11-17
**–í–µ—Ä—Å–∏—è –±–æ—Ç–∞:** Production v2.0 (NEW FLOW –∑–∞–≤–µ—Ä—à—ë–Ω - 100%)
**–°—Ç–∞—Ç—É—Å:** üü¢ –í—Å–µ —Ñ–∞–∑—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã, –≥–æ—Ç–æ–≤ –∫ –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏

---

## üìù CHANGELOG

### 2025-11-17 (–≤–µ—á–µ—Ä): –î–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ üîß
**User-friendly —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–æ–º –±–µ–∑ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è!**

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- üìã –î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª "üîß –ê–î–ú–ò–ù–ò–°–¢–†–ò–†–û–í–ê–ù–ò–ï"
  - –§–∏–ª–æ—Å–æ—Ñ–∏—è: –≤—Å—ë —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—ã –≤ Telegram, –Ω–∏–∫–∞–∫–æ–≥–æ SQL
  - –ü–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –Ω–µ-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–æ–≤
  - Inline-–∫–Ω–æ–ø–∫–∏ –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

**–ù–æ–≤—ã–µ —Ñ–∏—á–∏:**
- üë§ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏**
  - –í—ã–¥–∞—Ç—å/–æ—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É –ª—é–±–æ–º—É —é–∑–µ—Ä—É
  - –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ª–∏–º–∏—Ç–∞–º–∏
  - –°–±—Ä–æ—Å –¥–Ω–µ–≤–Ω—ã—Ö –ª–∏–º–∏—Ç–æ–≤
  - –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π

- üéüÔ∏è **–ü—Ä–æ–º–æ–∫–æ–¥—ã**
  - –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ —á–µ—Ä–µ–∑ –±–æ—Ç–∞
  - –õ–∏–º–∏—Ç—ã –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π
  - Deep-links –¥–ª—è —à–∞—Ä–∏–Ω–≥–∞
  - –ò—Å—Ç–æ—Ä–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–π

- üß™ **–¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º**
  - –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏
  - –ö–æ–º–∞–Ω–¥—ã: /testpro, /testpremium, /testlimit, /testreset
  - –ù–µ –ø–æ—Ä—Ç–∏—Ç –ø—Ä–æ–¥–∞–∫—à–Ω-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

- üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**
  - –†–∞–∑–±–∏–≤–∫–∞ –ø–æ —Ç–∞—Ä–∏—Ñ–∞–º
  - –°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã
  - –û—Ü–µ–Ω–∫–∞ –¥–æ—Ö–æ–¥–∞
  - –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV

- üìù **–õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π**
  - –ê—É–¥–∏—Ç –≤—Å–µ—Ö –∞–¥–º–∏–Ω—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
  - –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –æ—Ç–ª–∞–¥–∫–∞
  - –≠–∫—Å–ø–æ—Ä—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

**–ù–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã –ë–î:**
- `promo_codes` - –ø—Ä–æ–º–æ–∫–æ–¥—ã
- `promo_usage` - –∏—Å—Ç–æ—Ä–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–π
- `admin_logs` - –ª–æ–≥–∏ –∞–¥–º–∏–Ω–æ–≤

**–ù–æ–≤—ã–µ –º–æ–¥—É–ª–∏:**
- `modules/admin.py` - –∞–¥–º–∏–Ω—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã
- –û–±–Ω–æ–≤–ª–µ–Ω—ã: `payments.py`, `subscription.py`

**–ù–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
- `/admin` - –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
- `/promo <–ö–û–î>` - –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ (–¥–ª—è –≤—Å–µ—Ö)
- `/testpro`, `/testpremium`, `/testlimit`, `/testreset` - —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã

**–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:**
- 6 —Ç–∏–ø–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á —Å –ø–æ—à–∞–≥–æ–≤—ã–º–∏ —Ä–µ—à–µ–Ω–∏—è–º–∏
- –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –∞–¥–º–∏–Ω–∫–∏
- –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–¶–µ–ª—å:** –î–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–ø—Ä–∞–≤–ª—è—Ç—å –±–æ—Ç–æ–º –±–µ–∑ –∑–Ω–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è - –≤—Å—ë —á–µ—Ä–µ–∑ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ Telegram.

---

### 2025-11-17: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –≤—Å–µ—Ö —Ñ–∞–∑ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (v2.0) üéâ
**–í–°–ï –§–ê–ó–´ –ó–ê–í–ï–†–®–ï–ù–´ - PRODUCTION READY!**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- ‚úÖ **–§–∞–∑–∞ 1: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (100%)**
  - –ë–î –º–∏–≥—Ä–∞—Ü–∏–∏: `greeting_message`, `active_chat_sessions`
  - –û–±–Ω–æ–≤–ª–µ–Ω—ã —Å–µ—Ä–≤–∏—Å—ã: `ai_service.py`, `db_service.py`
  - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –¥–ª—è –≤—Å–µ—Ö 7 –±–∞–∑–æ–≤—ã—Ö –ª–∏—á–Ω–æ—Å—Ç–µ–π

- ‚úÖ **–§–∞–∑–∞ 2: Direct Chat (100%)**
  - –ú–æ–¥—É–ª—å `direct_chat.py` –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
  - –ü—Ä—è–º–æ–µ –æ–±—â–µ–Ω–∏–µ 1-–Ω–∞-1 —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º (30 —Å–æ–æ–±—â–µ–Ω–∏–π)
  - –í—ã–±–æ—Ä –ª–∏—á–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ inline-–º–µ–Ω—é
  - –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è

- ‚úÖ **–§–∞–∑–∞ 3: –ì—Ä—É–ø–ø–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (100%)**
  - –ö–æ–º–∞–Ω–¥—ã `/chat`, `/stop` –¥–ª—è –≥—Ä—É–ø–ø–æ–≤—ã—Ö —Å–µ—Å—Å–∏–π
  - –û–±–Ω–æ–≤–ª–µ–Ω—ã `/summary`, `/rassudi` —Å –≤—ã–±–æ—Ä–æ–º –ª–∏—á–Ω–æ—Å—Ç–∏
  - Inline-–º–µ–Ω—é –≤–æ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥–∞—Ö
  - –¢–∞–π–º–∞—É—Ç —Å–µ—Å—Å–∏–π 15 –º–∏–Ω—É—Ç

- ‚úÖ **–§–∞–∑–∞ 4: Onboarding (100%)**
  - Welcome-—Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `/start` –≤ –≥—Ä—É–ø–ø–∞—Ö
  - Deep-link –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–∞
  - Inline-–∫–Ω–æ–ø–∫–∏ –¥–ª—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- üìã –î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª "üí∞ –ú–û–ù–ï–¢–ò–ó–ê–¶–ò–Ø"
  - 3 —Ç–∞—Ä–∏—Ñ–Ω—ã—Ö –ø–ª–∞–Ω–∞: Free, Pro ($2.99), Premium ($9.99)
  - 3 —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã: Telegram Stars, Crypto (TON/USDT), Tribute
  - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–¥–ø–∏—Å–æ–∫: —Ç–∞–±–ª–∏—Ü—ã `subscriptions`, `usage_limits`
  - –ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏ (5 —Ñ–∞–∑)
  - –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞ –∏ KPI

**–ì–æ—Ç–æ–≤–æ –∫:**
- üöÄ Production deployment v2.0
- üí∞ –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏ (—Å–ª–µ–¥—É—é—â–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è)
- üìä –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

### 2025-11-12: –î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è –Ω–æ–≤–æ–≥–æ —Ñ–ª–æ—É
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª **Customer Journey Map (CJM)**
- ‚úÖ –î–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã 2 –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø—É—Ç–∏: –ª–∏—á–Ω—ã–π —á–∞—Ç + –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç
- ‚úÖ –û–ø–∏—Å–∞–Ω—ã –Ω–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã: `/summary`, `/chat`, `/stop`
- ‚úÖ –°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π: `direct_chat.py`, `onboarding.py`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã –ë–î: `active_chat_sessions`, `greeting_message`
- ‚úÖ –û–ø–∏—Å–∞–Ω—ã –≤—Å–µ UX-—Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –°–æ–∑–¥–∞–Ω TODO-–ª–∏—Å—Ç –¥–ª—è –ø–æ—ç—Ç–∞–ø–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (4 —Ñ–∞–∑—ã)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ –∏ callback_data —Å—Ç—Ä—É–∫—Ç—É—Ä

### 2025-11-14: –ü—Ä–µ–¥—ã–¥—É—â–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ cleanup —Å–∫—Ä–∏–ø—Ç—É
- –°–æ–∫—Ä–∞—â—ë–Ω retention –¥–æ 2 –¥–Ω–µ–π
