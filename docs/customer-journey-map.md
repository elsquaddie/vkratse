# Customer Journey Map - Neuroslav Bot

## –ü–æ–ª–Ω–∞—è –∫–∞—Ä—Ç–∞ –ø—É—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```mermaid
journey
    title Customer Journey Map - Neuroslav Bot (–ü–æ–ª–Ω—ã–π –ø—É—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
    section –ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å –±–æ—Ç–æ–º
      –£–∑–Ω–∞–ª –æ –±–æ—Ç–µ –æ—Ç –¥—Ä—É–∑–µ–π: 3: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      –ù–∞—à–µ–ª –±–æ—Ç–∞ –≤ Telegram: 4: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      –ó–∞–ø—É—Å—Ç–∏–ª /start: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –ë–æ—Ç
      –ü—Ä–æ—á–∏—Ç–∞–ª –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ: 4: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      –ò–∑—É—á–∏–ª –∫–æ–º–∞–Ω–¥—ã —á–µ—Ä–µ–∑ /help: 4: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –ë–æ—Ç

    section –ü–µ—Ä–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
      –î–æ–±–∞–≤–∏–ª –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      –£–≤–∏–¥–µ–ª welcome —Å–æ–æ–±—â–µ–Ω–∏–µ: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –ë–æ—Ç
      –ù–∞–ø–∏—Å–∞–ª –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç–µ: 4: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –£—á–∞—Å—Ç–Ω–∏–∫–∏
      –í—ã–∑–≤–∞–ª /sut –≤ –≥—Ä—É–ø–ø–µ: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      –ñ–¥–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏—é (‚è≥ –ì–µ–Ω–µ—Ä–∏—Ä—É—é —Å–∞–º–º–∞—Ä–∏...): 3: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –ë–æ—Ç
      –ü–æ–ª—É—á–∏–ª –ø–µ—Ä–≤–æ–µ —Å–∞–º–º–∞—Ä–∏: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –ë–æ—Ç
      –ü–æ–¥–µ–ª–∏–ª—Å—è —Å –¥—Ä—É–∑—å—è–º–∏: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –£—á–∞—Å—Ç–Ω–∏–∫–∏

    section –ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å –ª–∏—á–Ω–æ—Å—Ç—è–º–∏
      –£–∑–Ω–∞–ª –ø—Ä–æ –ª–∏—á–Ω–æ—Å—Ç–∏ AI: 4: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      –í—ã–∑–≤–∞–ª /lichnost: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      –£–≤–∏–¥–µ–ª –≤—ã–±–æ—Ä –∏–∑ 7 –±–∞–∑–æ–≤—ã—Ö –ª–∏—á–Ω–æ—Å—Ç–µ–π: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –ë–æ—Ç
      –í—ã–±—Ä–∞–ª "–ë—ã–¥–ª–∞–Ω üè≠": 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      –ü–æ–ø—Ä–æ–±–æ–≤–∞–ª /sut —Å –Ω–æ–≤–æ–π –ª–∏—á–Ω–æ—Å—Ç—å—é: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –ë–æ—Ç
      –ü–æ—Å–º–µ—è–ª—Å—è –Ω–∞–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –£—á–∞—Å—Ç–Ω–∏–∫–∏

    section –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –õ–°
      –û—Ç–∫—Ä—ã–ª –õ–° —Å –±–æ—Ç–æ–º: 4: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      –í—ã–∑–≤–∞–ª /sut –≤ –õ–°: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      –£–≤–∏–¥–µ–ª –∫–Ω–æ–ø–∫–∏ —Å —á–∞—Ç–∞–º–∏: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –ë–æ—Ç
      –í—ã–±—Ä–∞–ª –Ω—É–∂–Ω—ã–π —á–∞—Ç: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      –ü–æ–ª—É—á–∏–ª —Å–∞–º–º–∞—Ä–∏ –≤ –õ–°: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –ë–æ—Ç

    section –°–æ–∑–¥–∞–Ω–∏–µ —Å–≤–æ–µ–π –ª–∏—á–Ω–æ—Å—Ç–∏
      –†–µ—à–∏–ª —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ—é –ª–∏—á–Ω–æ—Å—Ç—å: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      –í—ã–∑–≤–∞–ª /lichnost ‚Üí –°–æ–∑–¥–∞—Ç—å —Å–≤–æ—é: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      –í–≤–µ–ª –Ω–∞–∑–≤–∞–Ω–∏–µ (–ü–∏—Ä–∞—Ç): 4: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      –í–≤–µ–ª –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ç–∏–ª—è: 4: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      –ü–æ–ª—É—á–∏–ª –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –ë–æ—Ç
      –ü–æ–ø—Ä–æ–±–æ–≤–∞–ª –Ω–æ–≤—É—é –ª–∏—á–Ω–æ—Å—Ç—å: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –ë–æ—Ç
      –ü–æ–∫–∞–∑–∞–ª –¥—Ä—É–∑—å—è–º: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –£—á–∞—Å—Ç–Ω–∏–∫–∏

    section –†–∞—Å—Å—É–∂–¥–µ–Ω–∏–µ —Å–ø–æ—Ä–æ–≤
      –£–≤–∏–¥–µ–ª —Å–ø–æ—Ä –≤ —á–∞—Ç–µ: 3: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –£—á–∞—Å—Ç–Ω–∏–∫–∏
      –í—ã–∑–≤–∞–ª /rassudi —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º —Å–ø–æ—Ä–∞: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      –ñ–¥–µ—Ç –≤–µ—Ä–¥–∏–∫—Ç (‚öñÔ∏è –†–∞–∑–º—ã—à–ª—è—é...): 4: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –ë–æ—Ç
      –ü–æ–ª—É—á–∏–ª –≤–µ—Ä–¥–∏–∫—Ç –æ—Ç AI —Å—É–¥—å–∏: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –ë–æ—Ç, –£—á–∞—Å—Ç–Ω–∏–∫–∏
      –û–±—Å—É–¥–∏–ª–∏ –≤–µ—Ä–¥–∏–∫—Ç: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –£—á–∞—Å—Ç–Ω–∏–∫–∏

    section –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
      –ó–∞—Ö–æ—Ç–µ–ª —É–∑–Ω–∞—Ç—å —Å–≤–æ—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É: 4: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      –í—ã–∑–≤–∞–ª /stats: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      –£–≤–∏–¥–µ–ª –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∞–º–º–∞—Ä–∏ –∏ —Å–ø–æ—Ä–æ–≤: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –ë–æ—Ç
      –î–æ–≤–æ–ª–µ–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

    section –ü—Ä–æ–±–ª–µ–º—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
      –ü–æ–ø—Ä–æ–±–æ–≤–∞–ª –≤—ã–∑–≤–∞—Ç—å /sut —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ: 2: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      –ü–æ–ª—É—á–∏–ª cooldown –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: 2: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –ë–æ—Ç
      –ü–æ–¥–æ–∂–¥–∞–ª 60 —Å–µ–∫—É–Ω–¥: 3: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      –£—Å–ø–µ—à–Ω–æ –≤—ã–∑–≤–∞–ª –∫–æ–º–∞–Ω–¥—É —Å–Ω–æ–≤–∞: 5: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –ë–æ—Ç
```

## –î–µ—Ç–∞–ª—å–Ω—ã–µ User Flows

### 1. –û–Ω–±–æ—Ä–¥–∏–Ω–≥ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```mermaid
flowchart TD
    A[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∑–Ω–∞–ª –æ –±–æ—Ç–µ] --> B[–û—Ç–∫—Ä—ã–ª Telegram]
    B --> C[–ù–∞—à–µ–ª @chto_bilo_v_chate_bot]
    C --> D[–ù–∞–∂–∞–ª Start]
    D --> E[–ü–æ–ª—É—á–∏–ª welcome —Å–æ–æ–±—â–µ–Ω–∏–µ]
    E --> F{–ü–æ–Ω—è–ª –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?}
    F -->|–ù–µ—Ç| G[–í—ã–∑–≤–∞–ª /help]
    G --> H[–ò–∑—É—á–∏–ª –∫–æ–º–∞–Ω–¥—ã]
    F -->|–î–∞| I[–î–æ–±–∞–≤–∏–ª –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø—É]
    H --> I
    I --> J[–ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª welcome –≤ –≥—Ä—É–ø–ø–µ]
    J --> K[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≥–æ—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å]

    style A fill:#e1f5ff
    style K fill:#c8e6c9
```

### 2. –°–∞–º–º–∞—Ä–∏–∑–∞—Ü–∏—è –≤ –≥—Ä—É–ø–ø–µ

```mermaid
sequenceDiagram
    participant U as –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    participant B as –ë–æ—Ç
    participant DB as –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
    participant AI as Claude API
    participant C as –ß–∞—Ç (—É—á–∞—Å—Ç–Ω–∏–∫–∏)

    U->>C: –û–±—â–∞–µ—Ç—Å—è –≤ –≥—Ä—É–ø–ø–æ–≤–æ–º —á–∞—Ç–µ
    B->>DB: –õ–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è

    Note over U: –ß–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è...

    U->>B: /sut (–∏–ª–∏ /sut 6—á)
    B->>B: –ü—Ä–æ–≤–µ—Ä–∫–∞ rate limit
    B->>B: –ü—Ä–æ–≤–µ—Ä–∫–∞ cooldown
    B->>DB: –ó–∞–ø—Ä–æ—Å —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞ –ø–µ—Ä–∏–æ–¥
    DB-->>B: –í–æ–∑–≤—Ä–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π
    B->>DB: –ü–æ–ª—É—á–∏—Ç—å –ª–∏—á–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    DB-->>B: –õ–∏—á–Ω–æ—Å—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ë—ã–¥–ª–∞–Ω)
    B->>U: ‚è≥ –ì–µ–Ω–µ—Ä–∏—Ä—É—é —Å–∞–º–º–∞—Ä–∏...
    B->>AI: –ó–∞–ø—Ä–æ—Å –Ω–∞ —Å–∞–º–º–∞—Ä–∏–∑–∞—Ü–∏—é
    AI-->>B: –°–∞–º–º–∞—Ä–∏ –≤ —Å—Ç–∏–ª–µ –ª–∏—á–Ω–æ—Å—Ç–∏
    B->>U: üìù –°–∞–º–º–∞—Ä–∏ —á–∞—Ç–∞
    B->>DB: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
    B->>B: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ cooldown
```

### 3. –°–∞–º–º–∞—Ä–∏–∑–∞—Ü–∏—è –≤ –õ–° (–≤—ã–±–æ—Ä —á–∞—Ç–∞)

```mermaid
sequenceDiagram
    participant U as –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    participant B as –ë–æ—Ç
    participant DB as –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
    participant TG as Telegram API
    participant AI as Claude API

    U->>B: /sut (–≤ –õ–°)
    B->>DB: –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —á–∞—Ç—ã –±–æ—Ç–∞
    DB-->>B: –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤

    loop –î–ª—è –∫–∞–∂–¥–æ–≥–æ —á–∞—Ç–∞
        B->>TG: getChatMember(bot)
        TG-->>B: –°—Ç–∞—Ç—É—Å –±–æ—Ç–∞
        B->>TG: getChatMember(user)
        TG-->>B: –°—Ç–∞—Ç—É—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        Note over B: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —á–∞—Ç–æ–≤
    end

    B->>U: üìã –í—ã–±–µ—Ä–∏ —á–∞—Ç –¥–ª—è —Å–∞–º–º–∞—Ä–∏:<br/>[–ö–Ω–æ–ø–∫–∏ —Å —á–∞—Ç–∞–º–∏]
    U->>B: –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ —á–∞—Ç–∞
    B->>B: –ü—Ä–æ–≤–µ—Ä–∫–∞ HMAC –ø–æ–¥–ø–∏—Å–∏
    B->>TG: –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–ª–µ–Ω—Å—Ç–≤–∞
    TG-->>B: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞
    B->>DB: –ü–æ–ª—É—á–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è
    DB-->>B: –°–æ–æ–±—â–µ–Ω–∏—è
    B->>DB: –ü–æ–ª—É—á–∏—Ç—å –ª–∏—á–Ω–æ—Å—Ç—å
    DB-->>B: –õ–∏—á–Ω–æ—Å—Ç—å
    B->>U: ‚è≥ –ì–µ–Ω–µ—Ä–∏—Ä—É—é —Å–∞–º–º–∞—Ä–∏...
    B->>AI: –ó–∞–ø—Ä–æ—Å –Ω–∞ —Å–∞–º–º–∞—Ä–∏–∑–∞—Ü–∏—é
    AI-->>B: –°–∞–º–º–∞—Ä–∏
    B->>U: üìù –°–∞–º–º–∞—Ä–∏ —á–∞—Ç–∞
    B->>DB: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
```

### 4. –°–º–µ–Ω–∞ –ª–∏—á–Ω–æ—Å—Ç–∏

```mermaid
stateDiagram-v2
    [*] --> –í—ã–±–æ—Ä: /lichnost
    –í—ã–±–æ—Ä --> –ü–æ–∫–∞–∑–ö–Ω–æ–ø–æ–∫: –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ª–∏—á–Ω–æ—Å—Ç–∏
    –ü–æ–∫–∞–∑–ö–Ω–æ–ø–æ–∫ --> –û–∂–∏–¥–∞–Ω–∏–µ–í—ã–±–æ—Ä–∞: –ü–æ–∫–∞–∑–∞—Ç—å –±–∞–∑–æ–≤—ã–µ + –∫–∞—Å—Ç–æ–º–Ω—ã–µ

    –û–∂–∏–¥–∞–Ω–∏–µ–í—ã–±–æ—Ä–∞ --> –í—ã–±–æ—Ä–ë–∞–∑–æ–≤–æ–π: –ö–ª–∏–∫ –Ω–∞ –±–∞–∑–æ–≤—É—é –ª–∏—á–Ω–æ—Å—Ç—å
    –û–∂–∏–¥–∞–Ω–∏–µ–í—ã–±–æ—Ä–∞ --> –í—ã–±–æ—Ä–ö–∞—Å—Ç–æ–º–Ω–æ–π: –ö–ª–∏–∫ –Ω–∞ —Å–≤–æ—é –ª–∏—á–Ω–æ—Å—Ç—å
    –û–∂–∏–¥–∞–Ω–∏–µ–í—ã–±–æ—Ä–∞ --> –°–æ–∑–¥–∞–Ω–∏–µ–ù–æ–≤–æ–π: –ö–ª–∏–∫ "‚ûï –°–æ–∑–¥–∞—Ç—å"
    –û–∂–∏–¥–∞–Ω–∏–µ–í—ã–±–æ—Ä–∞ --> –£–¥–∞–ª–µ–Ω–∏–µ–õ–∏—á–Ω–æ—Å—Ç–∏: –ö–ª–∏–∫ "üóëÔ∏è" –Ω–∞ –∫–∞—Å—Ç–æ–º–Ω–æ–π

    –í—ã–±–æ—Ä–ë–∞–∑–æ–≤–æ–π --> –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–í–ë–î: –û–±–Ω–æ–≤–∏—Ç—å user_settings
    –í—ã–±–æ—Ä–ö–∞—Å—Ç–æ–º–Ω–æ–π --> –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–í–ë–î
    –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–í–ë–î --> –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ: ‚úÖ –õ–∏—á–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∞
    –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ --> [*]

    –£–¥–∞–ª–µ–Ω–∏–µ–õ–∏—á–Ω–æ—Å—Ç–∏ --> –ü—Ä–æ–≤–µ—Ä–∫–∞–í–ª–∞–¥–µ–ª—å—Ü–∞: –ü—Ä–æ–≤–µ—Ä–∫–∞ created_by_user_id
    –ü—Ä–æ–≤–µ—Ä–∫–∞–í–ª–∞–¥–µ–ª—å—Ü–∞ --> –£–¥–∞–ª–µ–Ω–∏–µ–ò–∑–ë–î: DELETE FROM personalities
    –£–¥–∞–ª–µ–Ω–∏–µ–ò–∑–ë–î --> –°–±—Ä–æ—Å–î–µ—Ñ–æ–ª—Ç: –ï—Å–ª–∏ –±—ã–ª–∞ –≤—ã–±—Ä–∞–Ω–∞ - —Å–±—Ä–æ—Å
    –°–±—Ä–æ—Å–î–µ—Ñ–æ–ª—Ç --> [*]

    –°–æ–∑–¥–∞–Ω–∏–µ–ù–æ–≤–æ–π --> –í–≤–æ–¥–ò–º–µ–Ω–∏: –ó–∞–ø—Ä–æ—Å–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ
    –í–≤–æ–¥–ò–º–µ–Ω–∏ --> –í–≤–æ–¥–û–ø–∏—Å–∞–Ω–∏—è: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ context
    –í–≤–æ–¥–û–ø–∏—Å–∞–Ω–∏—è --> Sanitization: –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
    Sanitization --> –°–æ–∑–¥–∞–Ω–∏–µ–í–ë–î: INSERT INTO personalities
    –°–æ–∑–¥–∞–Ω–∏–µ–í–ë–î --> –ê–≤—Ç–æ–í—ã–±–æ—Ä: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±—Ä–∞—Ç—å
    –ê–≤—Ç–æ–í—ã–±–æ—Ä --> [*]
```

### 5. –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–π –ª–∏—á–Ω–æ—Å—Ç–∏ (Conversation Flow)

```mermaid
flowchart TD
    Start([–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å]) --> A[/lichnost]
    A --> B[–ü–æ–∫–∞–∑–∞–Ω—ã –≤—Å–µ –ª–∏—á–Ω–æ—Å—Ç–∏]
    B --> C[–ö–ª–∏–∫: ‚ûï –°–æ–∑–¥–∞—Ç—å —Å–≤–æ—é –ª–∏—á–Ω–æ—Å—Ç—å]
    C --> D[–ë–æ—Ç: –®–∞–≥ 1/2 - –ö–∞–∫ –Ω–∞–∑–æ–≤—ë–º?]

    D --> E[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ]
    E --> F{–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è}
    F -->|–ù–µ–≤–∞–ª–∏–¥–Ω–æ| G[–ë–æ—Ç: ‚ùå –û—à–∏–±–∫–∞]
    G --> D
    F -->|–°—É—â–µ—Å—Ç–≤—É–µ—Ç| H[–ë–æ—Ç: ‚ùå –£–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç]
    H --> D
    F -->|–õ–∏–º–∏—Ç –¥–æ—Å—Ç–∏–≥–Ω—É—Ç| I[–ë–æ—Ç: ‚ùå –õ–∏–º–∏—Ç MAX_CUSTOM_PERSONALITIES]
    I --> End1([–ö–æ–Ω–µ—Ü])

    F -->|–í–∞–ª–∏–¥–Ω–æ| J[–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ context]
    J --> K[–ë–æ—Ç: –®–∞–≥ 2/2 - –û–ø–∏—à–∏ —Å—Ç–∏–ª—å]

    K --> L[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –æ–ø–∏—Å–∞–Ω–∏–µ]
    L --> M{Sanitization}
    M -->|–ò–Ω—ä–µ–∫—Ü–∏—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞| N[–ë–æ—Ç: ‚ùå –ó–∞–ø—Ä–µ—â—ë–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞]
    N --> K
    M -->|–°–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ/–¥–ª–∏–Ω–Ω–æ–µ| O[–ë–æ—Ç: ‚ùå –ù–µ–≤–µ—Ä–Ω–∞—è –¥–ª–∏–Ω–∞]
    O --> K
    M -->|–ó–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–µ –∏–º–µ–Ω–∞| P[–ë–æ—Ç: ‚ùå –ù–µ–ª—å–∑—è —ç–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –ª—é–¥–µ–π]
    P --> K

    M -->|–í–∞–ª–∏–¥–Ω–æ| Q[–°–æ–∑–¥–∞–Ω–∏–µ safe_prompt]
    Q --> R[INSERT INTO personalities]
    R --> S[UPDATE user_settings]
    S --> T[–ë–æ—Ç: ‚úÖ –õ–∏—á–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∞ –∏ –≤—ã–±—Ä–∞–Ω–∞!]
    T --> End2([–ö–æ–Ω–µ—Ü])

    style Start fill:#e1f5ff
    style End1 fill:#ffcdd2
    style End2 fill:#c8e6c9
    style M fill:#fff9c4
    style F fill:#fff9c4
```

### 6. –†–∞—Å—Å—É–∂–¥–µ–Ω–∏–µ —Å–ø–æ—Ä–∞

```mermaid
flowchart TD
    A[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Å–ø–æ—Ä –≤ —á–∞—Ç–µ] --> B[/rassudi –æ–ø–∏—Å–∞–Ω–∏–µ —Å–ø–æ—Ä–∞]
    B --> C{–ü—Ä–æ–≤–µ—Ä–∫–∞ cooldown}
    C -->|–ù–µ –ø—Ä–æ—à–µ–ª| D[‚ùå –ü–æ–¥–æ–∂–¥–∏ N —Å–µ–∫—É–Ω–¥]
    D --> End1([–ö–æ–Ω–µ—Ü])

    C -->|–ü—Ä–æ—à–µ–ª| E[–ü–∞—Ä—Å–∏–Ω–≥ —É–ø–æ–º–∏–Ω–∞–Ω–∏–π @username]
    E --> F{–ï—Å—Ç—å —É–ø–æ–º–∏–Ω–∞–Ω–∏—è?}
    F -->|–î–∞| G[–ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Å–æ–æ–±—â–µ–Ω–∏–π —É–ø–æ–º—è–Ω—É—Ç—ã—Ö]
    F -->|–ù–µ—Ç| H[–ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Å–æ–æ–±—â–µ–Ω–∏–π —á–∞—Ç–∞]

    G --> I[–ü–æ–ª—É—á–∏—Ç—å –ª–∏—á–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è]
    H --> I
    I --> J[–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è —Å—É–¥—å–∏]
    J --> K[–ë–æ—Ç: ‚öñÔ∏è –†–∞–∑–º—ã—à–ª—è—é...]
    K --> L[AI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≤–µ—Ä–¥–∏–∫—Ç]
    L --> M[–ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤–µ—Ä–¥–∏–∫—Ç –≤ —á–∞—Ç]
    M --> N[–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å cooldown]
    N --> O[–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ analytics]
    O --> End2([–ö–æ–Ω–µ—Ü])

    style A fill:#e1f5ff
    style End1 fill:#ffcdd2
    style End2 fill:#c8e6c9
```

### 7. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∑–∞—â–∏—Ç–∞

```mermaid
flowchart TD
    subgraph "Rate Limiting"
        RL1[–ó–∞–ø—Ä–æ—Å –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è]
        RL2{–ü—Ä–æ–≤–µ—Ä–∫–∞ REQUEST_HISTORY}
        RL3[>= RATE_LIMIT –∑–∞–ø—Ä–æ—Å–æ–≤?]
        RL4[‚ùå –ü–æ–¥–æ–∂–¥–∏ N —Å–µ–∫—É–Ω–¥]
        RL5[‚úÖ –†–∞–∑—Ä–µ—à–∏—Ç—å –∑–∞–ø—Ä–æ—Å]
        RL6[–î–æ–±–∞–≤–∏—Ç—å timestamp]

        RL1 --> RL2
        RL2 --> RL3
        RL3 -->|–î–∞| RL4
        RL3 -->|–ù–µ—Ç| RL5
        RL5 --> RL6
    end

    subgraph "Cooldown"
        CD1[–ö–æ–º–∞–Ω–¥–∞ –≤ —á–∞—Ç–µ]
        CD2{–ü—Ä–æ–≤–µ—Ä–∫–∞ COOLDOWNS}
        CD3[–ü—Ä–æ—à–ª–æ < 60 —Å–µ–∫—É–Ω–¥?]
        CD4[‚ùå –ß–∞—Ç –Ω–∞ –∫—É–ª–¥–∞—É–Ω–µ]
        CD5[‚úÖ –†–∞–∑—Ä–µ—à–∏—Ç—å –∫–æ–º–∞–Ω–¥—É]
        CD6[–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å timestamp]

        CD1 --> CD2
        CD2 --> CD3
        CD3 -->|–î–∞| CD4
        CD3 -->|–ù–µ—Ç| CD5
        CD5 --> CD6
    end

    subgraph "HMAC Signature"
        HM1[–°–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–æ–ø–∫–∏]
        HM2[–ì–µ–Ω–µ—Ä–∞—Ü–∏—è HMAC: sha256 chat_id:user_id]
        HM3[callback_data: summary:chat_id:signature]
        HM4[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–ª–∏–∫–∞–µ—Ç]
        HM5[–ü—Ä–æ–≤–µ—Ä–∫–∞ HMAC]
        HM6{–ü–æ–¥–ø–∏—Å—å –≤–∞–ª–∏–¥–Ω–∞?}
        HM7[‚ùå –ù–µ–≤–µ—Ä–Ω–∞—è –ø–æ–¥–ø–∏—Å—å]
        HM8[‚úÖ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å]

        HM1 --> HM2
        HM2 --> HM3
        HM3 --> HM4
        HM4 --> HM5
        HM5 --> HM6
        HM6 -->|–ù–µ—Ç| HM7
        HM6 -->|–î–∞| HM8
    end

    subgraph "Sanitization"
        SN1[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç –ª–∏—á–Ω–æ—Å—Ç—å]
        SN2[–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤]
        SN3{–ù–∞–π–¥–µ–Ω—ã –∏–Ω—ä–µ–∫—Ü–∏–∏?}
        SN4[‚ùå –ó–∞–ø—Ä–µ—â—ë–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞]
        SN5[Escape —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª–æ–≤]
        SN6[–û–±—ë—Ä—Ç–∫–∞ –≤ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø—Ä–æ–º–ø—Ç]
        SN7[‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π prompt]

        SN1 --> SN2
        SN2 --> SN3
        SN3 -->|–î–∞| SN4
        SN3 -->|–ù–µ—Ç| SN5
        SN5 --> SN6
        SN6 --> SN7
    end

    style RL4 fill:#ffcdd2
    style RL5 fill:#c8e6c9
    style CD4 fill:#ffcdd2
    style CD5 fill:#c8e6c9
    style HM7 fill:#ffcdd2
    style HM8 fill:#c8e6c9
    style SN4 fill:#ffcdd2
    style SN7 fill:#c8e6c9
```

### 8. –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –¥–∞–Ω–Ω—ã—Ö

```mermaid
flowchart LR
    subgraph "–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö"
        A1[–°–æ–æ–±—â–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø–µ]
        A2[log_message_handler]
        A3[INSERT INTO messages]
        A4[UPDATE chat_metadata]
    end

    subgraph "–•—Ä–∞–Ω–µ–Ω–∏–µ"
        B1[(Supabase PostgreSQL)]
        B2[messages: 7 –¥–Ω–µ–π]
        B3[personalities: –ø–æ—Å—Ç–æ—è–Ω–Ω–æ]
        B4[user_settings: –ø–æ—Å—Ç–æ—è–Ω–Ω–æ]
        B5[analytics: –ø–æ—Å—Ç–æ—è–Ω–Ω–æ]
    end

    subgraph "–ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞"
        C1[–ü—Ä–∏ –∫–∞–∂–¥–æ–º save_message]
        C2[DELETE WHERE created_at < NOW - 7 days]
        C3[–¢–æ–ª—å–∫–æ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ chat_id]
    end

    subgraph "–£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ"
        D1[–ë–æ—Ç —É–¥–∞–ª–µ–Ω –∏–∑ —á–∞—Ç–∞]
        D2[handle_bot_removed_from_chat]
        D3[DELETE FROM messages WHERE chat_id]
        D4[DELETE FROM chat_metadata WHERE chat_id]
    end

    A1 --> A2
    A2 --> A3
    A3 --> A4
    A4 --> B1

    B1 --> B2
    B1 --> B3
    B1 --> B4
    B1 --> B5

    A3 --> C1
    C1 --> C2
    C2 --> C3

    D1 --> D2
    D2 --> D3
    D3 --> D4

    style A1 fill:#e1f5ff
    style B1 fill:#fff9c4
    style C2 fill:#ffcdd2
    style D3 fill:#ffcdd2
```

## –ö–ª—é—á–µ–≤—ã–µ —Ç–æ—á–∫–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è (Touchpoints)

```mermaid
mindmap
  root((Neuroslav Bot))
    –ö–æ–º–∞–Ω–¥—ã
      /start - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
      /help - –°–ø—Ä–∞–≤–∫–∞
      /sut - –°–∞–º–º–∞—Ä–∏–∑–∞—Ü–∏—è
      /rassudi - –°—É–¥–µ–π—Å—Ç–≤–æ
      /lichnost - –õ–∏—á–Ω–æ—Å—Ç–∏
      /stats - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    –ö–∞–Ω–∞–ª—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
      –ì—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç
        –ü—É–±–ª–∏—á–Ω—ã–µ —Å–∞–º–º–∞—Ä–∏
        –°—É–¥–µ–π—Å—Ç–≤–æ —Å–ø–æ—Ä–æ–≤
        –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
      –õ–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
        –í—ã–±–æ—Ä —á–∞—Ç–∞
        –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ —Å–∞–º–º–∞—Ä–∏
        –°–æ–∑–¥–∞–Ω–∏–µ –ª–∏—á–Ω–æ—Å—Ç–µ–π
    –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
      üòä –†–∞–¥–æ—Å—Ç—å –æ—Ç –ø–µ—Ä–≤–æ–≥–æ —Å–∞–º–º–∞—Ä–∏
      üòÇ –°–º–µ—Ö –æ—Ç –ª–∏—á–Ω–æ—Å—Ç–∏ –ë—ã–¥–ª–∞–Ω
      ü§î –ò–Ω—Ç–µ—Ä–µ—Å –∫ —Å–æ–∑–¥–∞–Ω–∏—é —Å–≤–æ–µ–π –ª–∏—á–Ω–æ—Å—Ç–∏
      üò§ –§—Ä—É—Å—Ç—Ä–∞—Ü–∏—è –æ—Ç cooldown
      ‚è∞ –û–∂–∏–¥–∞–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
      ‚úÖ –£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–∏–µ –æ—Ç –≤–µ—Ä–¥–∏–∫—Ç–∞
    –ë–∞—Ä—å–µ—Ä—ã
      Cooldown 60 —Å–µ–∫—É–Ω–¥
      Rate limit 10 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω
      –õ–∏–º–∏—Ç –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ª–∏—á–Ω–æ—Å—Ç–µ–π
      –°–ª–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –ª–∏—á–Ω–æ—Å—Ç–∏
```

## Pain Points & Moments of Delight

```mermaid
graph TD
    subgraph "üò§ Pain Points"
        P1[Cooldown –±–ª–æ–∫–∏—Ä—É–µ—Ç —á–∞—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã]
        P2[–ù—É–∂–Ω–æ –∂–¥–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ AI]
        P3[–°–ª–æ–∂–Ω–æ –æ–ø–∏—Å–∞—Ç—å –ª–∏—á–Ω–æ—Å—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ]
        P4[–ó–∞–±—ã–ª –∫–∞–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã –¥–æ—Å—Ç—É–ø–Ω—ã]
        P5[–ù–µ—Ç –æ–±—â–∏—Ö —á–∞—Ç–æ–≤ —Å –±–æ—Ç–æ–º –≤ –õ–°]
    end

    subgraph "‚ú® Moments of Delight"
        D1[–ü–µ—Ä–≤–æ–µ —Å–∞–º–º–∞—Ä–∏ - WOW —ç—Ñ—Ñ–µ–∫—Ç]
        D2[–°–º–µ—à–Ω–æ–π –æ—Ç–≤–µ—Ç –æ—Ç –ë—ã–¥–ª–∞–Ω–∞]
        D3[–°–≤–æ—è –ª–∏—á–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç!]
        D4[–í–µ—Ä–¥–∏–∫—Ç —Å—É–¥—å–∏ —Ä–∞–∑—Ä–µ—à–∏–ª —Å–ø–æ—Ä]
        D5[–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å]
        D6[–ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –õ–° - —É–¥–æ–±–Ω–æ!]
    end

    P1 -.—Ä–µ—à–µ–Ω–∏–µ.-> S1[–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏]
    P2 -.—Ä–µ—à–µ–Ω–∏–µ.-> S2[‚è≥ –ì–µ–Ω–µ—Ä–∏—Ä—É—é... - feedback]
    P3 -.—Ä–µ—à–µ–Ω–∏–µ.-> S3[–ü—Ä–∏–º–µ—Ä—ã –≤ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏]
    P4 -.—Ä–µ—à–µ–Ω–∏–µ.-> S4[/help –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–µ–Ω]
    P5 -.—Ä–µ—à–µ–Ω–∏–µ.-> S5[–ü–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ]

    style P1 fill:#ffcdd2
    style P2 fill:#ffcdd2
    style P3 fill:#ffcdd2
    style P4 fill:#ffcdd2
    style P5 fill:#ffcdd2

    style D1 fill:#c8e6c9
    style D2 fill:#c8e6c9
    style D3 fill:#c8e6c9
    style D4 fill:#c8e6c9
    style D5 fill:#c8e6c9
    style D6 fill:#c8e6c9

    style S1 fill:#fff9c4
    style S2 fill:#fff9c4
    style S3 fill:#fff9c4
    style S4 fill:#fff9c4
    style S5 fill:#fff9c4
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –∫–∞—Ä—Ç–∞ —Å–∏—Å—Ç–µ–º—ã

```mermaid
graph TB
    subgraph "Frontend (Telegram)"
        TG[Telegram Client]
        U[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å]
    end

    subgraph "Backend (Vercel Serverless)"
        WH[Webhook Handler<br/>api/index.py]

        subgraph "Modules"
            CMD[commands.py<br/>/start /help /stats]
            SUM[summaries.py<br/>/sut]
            JUD[judge.py<br/>/rassudi]
            PER[personalities.py<br/>/lichnost]
        end

        subgraph "Services"
            DBS[db_service.py<br/>Supabase client]
            AIS[ai_service.py<br/>Claude client]
        end

        subgraph "Utils"
            SEC[security.py<br/>HMAC, sanitization]
            RL[rate_limit.py<br/>Rate limiting]
            CD[cooldown.py<br/>Cooldown]
            VAL[validators.py<br/>Validation]
        end
    end

    subgraph "External Services"
        DB[(Supabase<br/>PostgreSQL)]
        AI[Claude API<br/>Anthropic]
        TGAPI[Telegram Bot API]
    end

    U -->|–ö–æ–º–∞–Ω–¥—ã| TG
    TG -->|Webhook| WH

    WH --> CMD
    WH --> SUM
    WH --> JUD
    WH --> PER

    CMD --> DBS
    SUM --> DBS
    SUM --> AIS
    JUD --> DBS
    JUD --> AIS
    PER --> DBS

    SUM --> SEC
    SUM --> RL
    SUM --> CD
    PER --> SEC
    PER --> VAL
    JUD --> CD

    DBS --> DB
    AIS --> AI
    WH --> TGAPI

    style TG fill:#e1f5ff
    style WH fill:#fff9c4
    style DB fill:#ffecb3
    style AI fill:#f8bbd0
    style TGAPI fill:#e1f5ff
```

## –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

```mermaid
graph LR
    subgraph "User Engagement"
        E1[DAU - Daily Active Users]
        E2[–ö–æ–º–∞–Ω–¥ –≤ –¥–µ–Ω—å]
        E3[Retention rate]
    end

    subgraph "Feature Usage"
        F1[/sut –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ]
        F2[–õ–∏—á–Ω–æ—Å—Ç–∏: –±–∞–∑–æ–≤—ã–µ vs –∫–∞—Å—Ç–æ–º–Ω—ã–µ]
        F3[/rassudi –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ]
        F4[/stats –ø—Ä–æ—Å–º–æ—Ç—Ä—ã]
    end

    subgraph "Quality Metrics"
        Q1[–í—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∞–º–º–∞—Ä–∏]
        Q2[–û—à–∏–±–∫–∏ AI]
        Q3[Rate limit hits]
        Q4[Cooldown hits]
    end

    subgraph "Growth"
        G1[–ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏]
        G2[–ù–æ–≤—ã–µ —á–∞—Ç—ã]
        G3[–ö–∞—Å—Ç–æ–º–Ω—ã—Ö –ª–∏—á–Ω–æ—Å—Ç–µ–π —Å–æ–∑–¥–∞–Ω–æ]
    end

    E1 --> Analytics[(Analytics Table)]
    E2 --> Analytics
    E3 --> Analytics
    F1 --> Analytics
    F2 --> Analytics
    F3 --> Analytics
    F4 --> Analytics

    style Analytics fill:#ffecb3
```

---

## –í—ã–≤–æ–¥—ã –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è UX

### –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã
1. ‚úÖ –ü—Ä–æ—Å—Ç–æ–π –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ —Å /start
2. ‚úÖ –ì–∏–±–∫–æ—Å—Ç—å: —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –≥—Ä—É–ø–ø–∞—Ö –∏ –õ–°
3. ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: HMAC, sanitization, rate limiting
4. ‚úÖ –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –ª–∏—á–Ω–æ—Å—Ç–∏
5. ‚úÖ –ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö (privacy)

### –¢–æ—á–∫–∏ —Ä–æ—Å—Ç–∞
1. üî® –î–æ–±–∞–≤–∏—Ç—å onboarding tour –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
2. üî® –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ AI (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)
3. üî® –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã –ª–∏—á–Ω–æ—Å—Ç–µ–π –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏
4. üî® –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ cooldown –∑–∞—Ä–∞–Ω–µ–µ
5. üî® –ò—Å—Ç–æ—Ä–∏—è —Å–∞–º–º–∞—Ä–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
6. üî® –≠–∫—Å–ø–æ—Ä—Ç —Å–∞–º–º–∞—Ä–∏ –≤ —Ñ–∞–π–ª

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã
- **P0**: –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚úÖ
- **P1**: –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (—Å–∞–º–º–∞—Ä–∏, –ª–∏—á–Ω–æ—Å—Ç–∏, —Å—É–¥–µ–π—Å—Ç–≤–æ) ‚úÖ
- **P2**: UX —É–ª—É—á—à–µ–Ω–∏—è (–ø—Ä–æ–≥—Ä–µ—Å—Å, –∏—Å—Ç–æ—Ä–∏—è)
- **P3**: –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è (–ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
