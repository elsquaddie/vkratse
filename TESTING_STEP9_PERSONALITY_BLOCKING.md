# üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –®–∞–≥–∞ 9: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ë–æ–Ω—É—Å–Ω—ã—Ö –õ–∏—á–Ω–æ—Å—Ç–µ–π

**–î–∞—Ç–∞:** 2025-11-17
**–ó–∞–¥–∞—á–∞:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –±–æ–Ω—É—Å–Ω—ã—Ö –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ª–∏—á–Ω–æ—Å—Ç–µ–π –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ –≥—Ä—É–ø–ø—ã
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

---

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 1. –£–±–µ–¥–∏—Å—å, —á—Ç–æ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –º–∏–≥—Ä–∞—Ü–∏–∏

```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ–ª—è –¥–æ–±–∞–≤–ª–µ–Ω—ã
SELECT column_name, data_type, is_nullable, column_default
FROM information_schema.columns
WHERE table_name = 'personalities'
  AND column_name IN ('is_group_bonus', 'is_blocked');
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
column_name      | data_type | is_nullable | column_default
-----------------+-----------+-------------+----------------
is_group_bonus   | boolean   | YES         | false
is_blocked       | boolean   | YES         | false
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∏ PROJECT_TELEGRAM_GROUP_ID

–í Vercel Dashboard ‚Üí Environment Variables:
```
PROJECT_TELEGRAM_GROUP_ID = <ID —Ç–≤–æ–µ–π —Ç–µ—Å—Ç–æ–≤–æ–π –≥—Ä—É–ø–ø—ã>
```

**–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å ID –≥—Ä—É–ø–ø—ã:**
- –î–æ–±–∞–≤—å –±–æ—Ç–∞ [@getidsbot](https://t.me/getidsbot) –≤ —Å–≤–æ—é –≥—Ä—É–ø–ø—É
- –û–Ω –æ—Ç–ø—Ä–∞–≤–∏—Ç ID –≥—Ä—É–ø–ø—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `-1001234567890`)
- –°–∫–æ–ø–∏—Ä—É–π —ç—Ç–æ—Ç ID (–≤–º–µ—Å—Ç–µ —Å –º–∏–Ω—É—Å–æ–º!)

### 3. –í–∫–ª—é—á–∏ chat_member –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

–ß–µ—Ä–µ–∑ [@BotFather](https://t.me/BotFather):
```
/mybots ‚Üí @—Ç–≤–æ–π_–±–æ—Ç ‚Üí Bot Settings ‚Üí Group Privacy ‚Üí Turn off
```

---

## üéØ –¢–µ—Å—Ç—ã

### –¢–µ—Å—Ç 1: –°–æ–∑–¥–∞–Ω–∏–µ –±–æ–Ω—É—Å–Ω–æ–π –ª–∏—á–Ω–æ—Å—Ç–∏ (Free + –≥—Ä—É–ø–ø–∞)

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –±–æ–Ω—É—Å–Ω–æ–π –ª–∏—á–Ω–æ—Å—Ç–∏ –¥–ª—è Free-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø–µ

**–®–∞–≥–∏:**
1. –£–±–µ–¥–∏—Å—å, —á—Ç–æ —É —Ç–µ–±—è –Ω–µ—Ç Pro-–ø–æ–¥–ø–∏—Å–∫–∏ (Free-—Ç–∞—Ä–∏—Ñ)
   ```sql
   -- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
   SELECT tier, is_active, expires_at FROM subscriptions WHERE user_id = <—Ç–≤–æ–π_user_id>;

   -- –ï—Å–ª–∏ –µ—Å—Ç—å Pro - —É–¥–∞–ª–∏—Ç—å
   DELETE FROM subscriptions WHERE user_id = <—Ç–≤–æ–π_user_id>;
   ```

2. –í—Å—Ç—É–ø–∏ –≤ –≥—Ä—É–ø–ø—É –ø—Ä–æ–µ–∫—Ç–∞ (–µ—Å–ª–∏ –µ—â—ë –Ω–µ –≤ –Ω–µ–π)

3. –û—Ç–ø—Ä–∞–≤—å –±–æ—Ç—É `/lichnost`

4. –ù–∞–∂–º–∏ "‚ûï –°–æ–∑–¥–∞—Ç—å —Å–≤–æ—é –ª–∏—á–Ω–æ—Å—Ç—å"

5. –°–æ–∑–¥–∞–π —Ç–µ—Å—Ç–æ–≤—É—é –ª–∏—á–Ω–æ—Å—Ç—å:
   - –û–ø–∏—Å–∞–Ω–∏–µ: "–ì—Ä—É–±—ã–π –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–±—ä—è—Å–Ω—è–µ—Ç —á–µ—Ä–µ–∑ –∫–æ–¥"
   - –ò–º—è: "–ö–æ–¥–µ—Ä-–≥—Ä—É–±–∏—è–Ω"

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –õ–∏—á–Ω–æ—Å—Ç—å —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞
- ‚úÖ –í –ë–î `is_group_bonus = true`
- ‚úÖ –í –ë–î `is_blocked = false`

**SQL-–ø—Ä–æ–≤–µ—Ä–∫–∞:**
```sql
SELECT
    id,
    display_name,
    is_group_bonus,
    is_blocked,
    created_by_user_id
FROM personalities
WHERE created_by_user_id = <—Ç–≤–æ–π_user_id>
  AND is_custom = true;
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
id | display_name     | is_group_bonus | is_blocked | created_by_user_id
---+------------------+----------------+------------+-------------------
123| –ö–æ–¥–µ—Ä-–≥—Ä—É–±–∏—è–Ω    | true           | false      | <—Ç–≤–æ–π_user_id>
```

---

### –¢–µ—Å—Ç 2: –í—ã—Ö–æ–¥ –∏–∑ –≥—Ä—É–ø–ø—ã ‚Üí –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ª–∏—á–Ω–æ—Å—Ç–∏

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ –≥—Ä—É–ø–ø—ã

**–®–∞–≥–∏:**
1. –í—ã–π–¥–∏ –∏–∑ –≥—Ä—É–ø–ø—ã –ø—Ä–æ–µ–∫—Ç–∞ (Leave group –≤ Telegram)

2. –ü–æ–¥–æ–∂–¥–∏ 5-10 —Å–µ–∫—É–Ω–¥ (–æ–±—Ä–∞–±–æ—Ç–∫–∞ webhook)

3. –ü—Ä–æ–≤–µ—Ä—å –ª–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –±–æ—Ç–∞ - –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:
   ```
   ‚ö†Ô∏è –¢—ã –≤—ã—à–µ–ª –∏–∑ –≥—Ä—É–ø–ø—ã –ø—Ä–æ–µ–∫—Ç–∞.

   –¢–≤–æ—è –±–æ–Ω—É—Å–Ω–∞—è –∫–∞—Å—Ç–æ–º–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å –≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞.
   –í–µ—Ä–Ω–∏—Å—å –≤ –≥—Ä—É–ø–ø—É, —á—Ç–æ–±—ã —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –µ—ë!
   ```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ü—Ä–∏—à–ª–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ
- ‚úÖ –í –ë–î `is_blocked = true`
- ‚úÖ –í –ë–î `group_membership_cache.is_member = false`

**SQL-–ø—Ä–æ–≤–µ—Ä–∫–∞:**
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ª–∏—á–Ω–æ—Å—Ç–∏
SELECT display_name, is_group_bonus, is_blocked
FROM personalities
WHERE created_by_user_id = <—Ç–≤–æ–π_user_id> AND is_group_bonus = true;

-- –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
-- –ö–æ–¥–µ—Ä-–≥—Ä—É–±–∏—è–Ω | true | true

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–µ—à —á–ª–µ–Ω—Å—Ç–≤–∞
SELECT is_member, checked_at
FROM group_membership_cache
WHERE user_id = <—Ç–≤–æ–π_user_id>;

-- –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
-- false | <timestamp>
```

---

### –¢–µ—Å—Ç 3: –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å –Ω–µ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ª–∏—á–Ω–æ—Å—Ç—å –Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

**–®–∞–≥–∏:**
1. –û—Ç–ø—Ä–∞–≤—å `/lichnost`

2. –ü—Ä–æ–≤–µ—Ä—å –º–µ–Ω—é –ª–∏—á–Ω–æ—Å—Ç–µ–π - –±–æ–Ω—É—Å–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å –¥–æ–ª–∂–Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è —Å –∑–∞–º–∫–æ–º:
   ```
   üîí –ö–æ–¥–µ—Ä-–≥—Ä—É–±–∏—è–Ω
   ```

3. –ü–æ–ø—Ä–æ–±—É–π –∫–ª–∏–∫–Ω—É—Ç—å –Ω–∞ –Ω–µ—ë

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –õ–∏—á–Ω–æ—Å—Ç—å –ø–æ–∫–∞–∑–∞–Ω–∞ —Å –∑–∞–º–∫–æ–º üîí
- ‚úÖ –ü—Ä–∏ –∫–ª–∏–∫–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è alert:
   ```
   ‚ö†Ô∏è –≠—Ç–∞ –ª–∏—á–Ω–æ—Å—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞.

   –ü—Ä–∏—á–∏–Ω–∞: —Ç—ã –≤—ã—à–µ–ª –∏–∑ –≥—Ä—É–ø–ø—ã –ø—Ä–æ–µ–∫—Ç–∞.
   –í–µ—Ä–Ω–∏—Å—å –≤ –≥—Ä—É–ø–ø—É, —á—Ç–æ–±—ã —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –µ—ë!
   ```
- ‚úÖ –õ–∏—á–Ω–æ—Å—Ç—å –ù–ï –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è

---

### –¢–µ—Å—Ç 4: –ü–æ–ø—ã—Ç–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ª–∏—á–Ω–æ—Å—Ç—å

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –≤–æ –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### 4.1 –ü—Ä—è–º–æ–π —á–∞—Ç (Direct Chat)

**–®–∞–≥–∏:**
1. –ï—Å–ª–∏ —É —Ç–µ–±—è –≤—ã–±—Ä–∞–Ω–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å - –ø–æ–ø—Ä–æ–±—É–π –Ω–∞–ø–∏—Å–∞—Ç—å –±–æ—Ç—É —Å–æ–æ–±—â–µ–Ω–∏–µ

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç:
   ```
   ‚ö†Ô∏è –í—ã–±—Ä–∞–Ω–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞.

   –ü—Ä–∏—á–∏–Ω–∞: —Ç—ã –≤—ã—à–µ–ª –∏–∑ –≥—Ä—É–ø–ø—ã –ø—Ä–æ–µ–∫—Ç–∞.
   –í–µ—Ä–Ω–∏—Å—å –≤ –≥—Ä—É–ø–ø—É, —á—Ç–æ–±—ã —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –µ—ë, –∏–ª–∏ –≤—ã–±–µ—Ä–∏ –¥—Ä—É–≥—É—é: /lichnost
   ```

#### 4.2 Summary

**–®–∞–≥–∏:**
1. –í –≥—Ä—É–ø–ø–µ (–≥–¥–µ –±–æ—Ç –µ—Å—Ç—å) –ø–æ–ø—Ä–æ–±—É–π `/summary`
2. –í—ã–±–µ—Ä–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ª–∏—á–Ω–æ—Å—Ç—å (–æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å üîí)

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ü—Ä–∏ –∫–ª–∏–∫–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è alert –æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ
- ‚úÖ Summary –ù–ï –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è

#### 4.3 Judge

**–®–∞–≥–∏:**
1. –í –≥—Ä—É–ø–ø–µ –ø–æ–ø—Ä–æ–±—É–π `/rassudi <—Å–ø–æ—Ä>`
2. –í—ã–±–µ—Ä–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ª–∏—á–Ω–æ—Å—Ç—å

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ü—Ä–∏ –∫–ª–∏–∫–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è alert –æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ
- ‚úÖ –í–µ—Ä–¥–∏–∫—Ç –ù–ï –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è

---

### –¢–µ—Å—Ç 5: –í–æ–∑–≤—Ä–∞—Ç –≤ –≥—Ä—É–ø–ø—É ‚Üí –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ª–∏—á–Ω–æ—Å—Ç–∏

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫—É –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –≤ –≥—Ä—É–ø–ø—É

**–®–∞–≥–∏:**
1. –í—Å—Ç—É–ø–∏ –æ–±—Ä–∞—Ç–Ω–æ –≤ –≥—Ä—É–ø–ø—É –ø—Ä–æ–µ–∫—Ç–∞

2. –ü–æ–¥–æ–∂–¥–∏ 5-10 —Å–µ–∫—É–Ω–¥ (–æ–±—Ä–∞–±–æ—Ç–∫–∞ webhook)

3. –ü—Ä–æ–≤–µ—Ä—å –ª–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –±–æ—Ç–∞ - –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:
   ```
   üéâ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –≥—Ä—É–ø–ø—É –ø—Ä–æ–µ–∫—Ç–∞!

   –¢–µ–ø–µ—Ä—å —Ç—ã –º–æ–∂–µ—à—å —Å–æ–∑–¥–∞—Ç—å 1 –±–æ–Ω—É—Å–Ω—É—é –∫–∞—Å—Ç–æ–º–Ω—É—é –ª–∏—á–Ω–æ—Å—Ç—å.
   –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–º–∞–Ω–¥—É /lichnost –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è.
   ```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ü—Ä–∏—à–ª–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–µ
- ‚úÖ –í –ë–î `is_blocked = false`
- ‚úÖ –í –ë–î `group_membership_cache.is_member = true`

**SQL-–ø—Ä–æ–≤–µ—Ä–∫–∞:**
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ª–∏—á–Ω–æ—Å—Ç–∏
SELECT display_name, is_group_bonus, is_blocked
FROM personalities
WHERE created_by_user_id = <—Ç–≤–æ–π_user_id> AND is_group_bonus = true;

-- –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
-- –ö–æ–¥–µ—Ä-–≥—Ä—É–±–∏—è–Ω | true | false

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–µ—à —á–ª–µ–Ω—Å—Ç–≤–∞
SELECT is_member, checked_at
FROM group_membership_cache
WHERE user_id = <—Ç–≤–æ–π_user_id>;

-- –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
-- true | <timestamp>
```

---

### –¢–µ—Å—Ç 6: –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ—Å–ª–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ª–∏—á–Ω–æ—Å—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞

**–®–∞–≥–∏:**
1. –û—Ç–ø—Ä–∞–≤—å `/lichnost`

2. –í—ã–±–µ—Ä–∏ –±–æ–Ω—É—Å–Ω—É—é –ª–∏—á–Ω–æ—Å—Ç—å (—Ç–µ–ø–µ—Ä—å –±–µ–∑ üîí):
   ```
   üé® –ö–æ–¥–µ—Ä-–≥—Ä—É–±–∏—è–Ω
   ```

3. –ü–æ–ø—Ä–æ–±—É–π –Ω–∞–ø–∏—Å–∞—Ç—å –±–æ—Ç—É —Å–æ–æ–±—â–µ–Ω–∏–µ

4. –ü–æ–ø—Ä–æ–±—É–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ `/summary`

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –õ–∏—á–Ω–æ—Å—Ç—å –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
- ‚úÖ –ü—Ä—è–º–æ–π —á–∞—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ Summary –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è
- ‚úÖ Judge —Ä–∞–±–æ—Ç–∞–µ—Ç

---

### –¢–µ—Å—Ç 7: Pro-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Ç–µ—Ä—è–µ—Ç –ª–∏—á–Ω–æ—Å—Ç–∏

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ Pro-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ù–ï —Ç–µ—Ä—è—é—Ç –ª–∏—á–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ –≥—Ä—É–ø–ø—ã

**–®–∞–≥–∏:**
1. –°–æ–∑–¥–∞–π Pro-–ø–æ–¥–ø–∏—Å–∫—É —Å–µ–±–µ:
   ```bash
   # –ß–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥—É
   /grantpro <—Ç–≤–æ–π_user_id> 30
   ```

2. –°–æ–∑–¥–∞–π 3 –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ª–∏—á–Ω–æ—Å—Ç–∏ (—É Pro –ª–∏–º–∏—Ç = 3 –±–µ–∑ –≥—Ä—É–ø–ø—ã)

3. –í—ã–π–¥–∏ –∏–∑ –≥—Ä—É–ø–ø—ã

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –õ–∏—á–Ω–æ—Å—Ç–∏ –ù–ï –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã (is_blocked = false)
- ‚úÖ –ù–∏–∫–∞–∫–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ
- ‚úÖ –í—Å–µ –ª–∏—á–Ω–æ—Å—Ç–∏ –æ—Å—Ç–∞—é—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏

**–ü–æ—á–µ–º—É?**
Pro-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–º–µ—é—Ç –ª–∏–º–∏—Ç 3 –ª–∏—á–Ω–æ—Å—Ç–∏ –ë–ï–ó –≥—Ä—É–ø–ø—ã. –¢–æ–ª—å–∫–æ 4-—è –ª–∏—á–Ω–æ—Å—Ç—å (–±–æ–Ω—É—Å –∑–∞ –≥—Ä—É–ø–ø—É) –±—É–¥–µ—Ç –∏–º–µ—Ç—å `is_group_bonus = true` –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ.

---

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–±–ª–µ–º–∞: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ –Ω–µ –ø—Ä–∏—à–ª–æ

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. Privacy mode –≤–∫–ª—é—á–µ–Ω (chat_member –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç)
2. PROJECT_TELEGRAM_GROUP_ID –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
3. Webhook –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è

**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
```bash
# –í –ª–æ–≥–∞—Ö Vercel –∏—â–∏:
Group membership changed for user <user_id>: is_member=false
Blocked bonus personalities for user <user_id>
```

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å BotFather ‚Üí Group Privacy ‚Üí –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å OFF
- –ü—Ä–æ–≤–µ—Ä—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é PROJECT_TELEGRAM_GROUP_ID –≤ Vercel
- –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ –≤ Vercel Dashboard

---

### –ü—Ä–æ–±–ª–µ–º–∞: –õ–∏—á–Ω–æ—Å—Ç—å –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –≤ –ë–î

**SQL-–ø—Ä–æ–≤–µ—Ä–∫–∞:**
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –≤—ã–∑—ã–≤–∞–ª–∏—Å—å –ª–∏ –º–µ—Ç–æ–¥—ã –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
SELECT * FROM analytics
WHERE event_type LIKE '%block%'
  AND user_id = <—Ç–≤–æ–π_user_id>
ORDER BY created_at DESC
LIMIT 10;
```

**–†–µ—à–µ–Ω–∏–µ:**
- –í—Ä—É—á–Ω—É—é –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è —Ç–µ—Å—Ç–∞:
  ```sql
  UPDATE personalities
  SET is_blocked = true
  WHERE created_by_user_id = <—Ç–≤–æ–π_user_id>
    AND is_group_bonus = true;
  ```

---

### –ü—Ä–æ–±–ª–µ–º–∞: –õ–∏—á–Ω–æ—Å—Ç—å –≤—Å—ë –µ—â—ë –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ—Å–ª–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

**–ü—Ä–æ–≤–µ—Ä—å:**
- –í –º–æ–¥—É–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `if personality.is_blocked`
- –ú–æ–¥–µ–ª—å Personality –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–µ `is_blocked`

**SQL-–ø—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–¥–µ–ª–∏:**
```sql
SELECT
    id,
    display_name,
    is_blocked,
    is_group_bonus
FROM personalities
WHERE id = <personality_id>;
```

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è

- [ ] –¢–µ—Å—Ç 1: –ë–æ–Ω—É—Å–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∞ (is_group_bonus=true)
- [ ] –¢–µ—Å—Ç 2: –ü—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ –≥—Ä—É–ø–ø—ã –ª–∏—á–Ω–æ—Å—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ (is_blocked=true)
- [ ] –¢–µ—Å—Ç 3: –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å –ø–æ–∫–∞–∑–∞–Ω–∞ —Å üîí
- [ ] –¢–µ—Å—Ç 4.1: –ü—Ä—è–º–æ–π —á–∞—Ç –±–ª–æ–∫–∏—Ä—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
- [ ] –¢–µ—Å—Ç 4.2: Summary –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—ã–±–æ—Ä
- [ ] –¢–µ—Å—Ç 4.3: Judge –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—ã–±–æ—Ä
- [ ] –¢–µ—Å—Ç 5: –ü—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –≤ –≥—Ä—É–ø–ø—É –ª–∏—á–Ω–æ—Å—Ç—å —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ (is_blocked=false)
- [ ] –¢–µ—Å—Ç 6: –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –¢–µ—Å—Ç 7: Pro-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ —Ç–µ—Ä—è—é—Ç –ª–∏—á–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ

---

## üìä SQL-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

```sql
-- –í—Å–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–∏—á–Ω–æ—Å—Ç–∏
SELECT
    p.id,
    p.display_name,
    p.created_by_user_id,
    p.is_group_bonus,
    p.is_blocked,
    g.is_member,
    g.checked_at
FROM personalities p
LEFT JOIN group_membership_cache g ON p.created_by_user_id = g.user_id
WHERE p.is_blocked = true;

-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º
SELECT
    COUNT(*) FILTER (WHERE is_blocked = true) AS blocked_count,
    COUNT(*) FILTER (WHERE is_blocked = false AND is_group_bonus = true) AS active_bonus,
    COUNT(*) FILTER (WHERE is_group_bonus = true) AS total_bonus
FROM personalities
WHERE is_custom = true;

-- –ò—Å—Ç–æ—Ä–∏—è —Å–æ–±—ã—Ç–∏–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
SELECT
    created_at,
    user_id,
    event_type,
    metadata
FROM analytics
WHERE event_type IN ('personality_blocked', 'personality_unblocked', 'group_left', 'group_joined')
ORDER BY created_at DESC
LIMIT 20;
```

---

**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é üöÄ
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é TODO_MONETIZATION_v2.1.md
