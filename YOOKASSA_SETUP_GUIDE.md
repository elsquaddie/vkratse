# üí≥ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ YooKassa

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-11-17
**–î–ª—è –∫–æ–≥–æ:** –í–ª–∞–¥–µ–ª–µ—Ü –±–æ—Ç–∞ (–Ω–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç)
**–í—Ä–µ–º—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:** ~30-60 –º–∏–Ω—É—Ç

---

## üìã –ß—Ç–æ —ç—Ç–æ?

YooKassa (–ÆKassa, –±—ã–≤—à–∞—è –Ø–Ω–¥–µ–∫—Å.–ö–∞—Å—Å–∞) ‚Äî –ø–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –ø—Ä–∏–µ–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π –±–∞–Ω–∫–æ–≤—Å–∫–∏–º–∏ –∫–∞—Ä—Ç–∞–º–∏, —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–º–∏ –∫–æ—à–µ–ª—å–∫–∞–º–∏ –∏ –¥—Ä—É–≥–∏–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏.

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–º–æ–≥—É—Ç –ø–æ–∫—É–ø–∞—Ç—å Pro-–ø–æ–¥–ø–∏—Å–∫—É –ø—Ä—è–º–æ –≤ –±–æ—Ç–µ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É "üí≥ –ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞".

---

## üéØ –®–∞–≥ 1: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ YooKassa

### 1.1 –°–æ–∑–¥–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞

1. –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ https://yookassa.ru/
2. –ù–∞–∂–º–∏ **"–ü–æ–¥–∫–ª—é—á–∏—Ç—å –ÆKassa"**
3. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Å—è:
   - –£–∫–∞–∂–∏ email
   - –ü—Ä–∏–¥—É–º–∞–π –ø–∞—Ä–æ–ª—å
   - –ü–æ–¥—Ç–≤–µ—Ä–¥–∏ email

### 1.2 –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –±–∏–∑–Ω–µ—Å–µ

YooKassa —Ç—Ä–µ–±—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –∫–æ–º–ø–∞–Ω–∏–∏ –∏–ª–∏ –ò–ü:

**–í–∞—Ä–∏–∞–Ω—Ç –ê: –£ —Ç–µ–±—è –µ—Å—Ç—å –ò–ü/–û–û–û**
- –£–∫–∞–∂–∏ –ò–ù–ù
- –ó–∞–≥—Ä—É–∑–∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã (—Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ –ò–ü, —É—Å—Ç–∞–≤ –∏ —Ç.–¥.)
- –î–æ–∂–¥–∏—Å—å –ø—Ä–æ–≤–µ—Ä–∫–∏ (1-3 –¥–Ω—è)

**–í–∞—Ä–∏–∞–Ω—Ç –ë: –¢—ã —Ñ–∏–∑–ª–∏—Ü–æ (—Å–∞–º–æ–∑–∞–Ω—è—Ç—ã–π)**
- –£–∫–∞–∂–∏ —Å—Ç–∞—Ç—É—Å "–°–∞–º–æ–∑–∞–Ω—è—Ç—ã–π"
- –í–≤–µ–¥–∏ –Ω–æ–º–µ—Ä –Ω–∞–ª–æ–≥–æ–≤–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- –ó–∞–≥—Ä—É–∑–∏ —á–µ–∫ –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è "–ú–æ–π –Ω–∞–ª–æ–≥"

**–í–∞–∂–Ω–æ:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 1-3 —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è
- YooKassa –º–æ–∂–µ—Ç –∑–∞–ø—Ä–æ—Å–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- –ö–æ–º–∏—Å—Å–∏—è YooKassa: ~3-5% –æ—Ç –ø–ª–∞—Ç–µ–∂–∞

### 1.3 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–ø–æ—Å–æ–±–æ–≤ –æ–ø–ª–∞—Ç—ã

–ü–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞:

1. –ó–∞–π–¥–∏ –≤ **"–ù–∞—Å—Ç—Ä–æ–π–∫–∏" ‚Üí "–°–ø–æ—Å–æ–±—ã –ø—Ä–∏–µ–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π"**
2. –í–∫–ª—é—á–∏ –Ω—É–∂–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã:
   - ‚úÖ **–ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ä—Ç—ã** (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
   - ‚úÖ –ÆMoney (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - ‚úÖ QIWI (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - ‚úÖ WebMoney (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üîë –®–∞–≥ 2: –ü–æ–ª—É—á–µ–Ω–∏–µ API-–∫–ª—é—á–µ–π

### 2.1 –°–æ–∑–¥–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞

1. –ü–µ—Ä–µ–π–¥–∏ –≤ **"–ù–∞—Å—Ç—Ä–æ–π–∫–∏" ‚Üí "–ú–∞–≥–∞–∑–∏–Ω—ã"**
2. –ù–∞–∂–º–∏ **"–°–æ–∑–¥–∞—Ç—å –º–∞–≥–∞–∑–∏–Ω"**
3. –ó–∞–ø–æ–ª–Ω–∏ –¥–∞–Ω–Ω—ã–µ:
   - **–ù–∞–∑–≤–∞–Ω–∏–µ:** "Telegram Bot - Pro Subscription"
   - **–û–ø–∏—Å–∞–Ω–∏–µ:** "–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ Pro-—Ñ—É–Ω–∫—Ü–∏–∏ –±–æ—Ç–∞"
   - **URL —Å–∞–π—Ç–∞:** `https://t.me/—Ç–≤–æ–π_–±–æ—Ç_username`

### 2.2 –ü–æ–ª—É—á–µ–Ω–∏–µ SHOP_ID –∏ SECRET_KEY

1. –û—Ç–∫—Ä–æ–π —Å–æ–∑–¥–∞–Ω–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω
2. –ü–µ—Ä–µ–π–¥–∏ –≤ **"–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è" ‚Üí "API"**
3. –°–∫–æ–ø–∏—Ä—É–π –¥–∞–Ω–Ω—ã–µ:
   - **shopId** (ID –º–∞–≥–∞–∑–∏–Ω–∞) ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, `123456`
   - **–°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á** ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, `live_ABC123xyz...`

**üîê –í–ê–ñ–ù–û - –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨:**
- ‚ùå **–ù–ï –∫–æ–º–º–∏—Ç—å** —ç—Ç–∏ –∫–ª—é—á–∏ –≤ Git!
- ‚ùå **–ù–ï –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å** –Ω–∏–∫–æ–º—É –∫–ª—é—á–∏!
- ‚úÖ –•—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è Vercel

---

## ‚öôÔ∏è –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Vercel

### 3.1 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

1. –ó–∞–π–¥–∏ –≤ https://vercel.com/
2. –û—Ç–∫—Ä–æ–π —Å–≤–æ–π –ø—Ä–æ–µ–∫—Ç `vkratse`
3. –ü–µ—Ä–µ–π–¥–∏ –≤ **Settings ‚Üí Environment Variables**
4. –î–æ–±–∞–≤—å **2 –Ω–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**

**–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è 1:**
```
Name: YOOKASSA_SHOP_ID
Value: <—Ç–≤–æ–π shopId –∏–∑ —à–∞–≥–∞ 2.2>
Environments: ‚úÖ Production, ‚úÖ Preview, ‚úÖ Development
```

**–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è 2:**
```
Name: YOOKASSA_SECRET_KEY
Value: <—Ç–≤–æ–π —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –∏–∑ —à–∞–≥–∞ 2.2>
Environments: ‚úÖ Production, ‚úÖ Preview, ‚úÖ Development
```

### 3.2 Redeploy –ø—Ä–æ–µ–∫—Ç–∞

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:
1. –ü–µ—Ä–µ–π–¥–∏ –≤ **Deployments**
2. –ù–∞–π–¥–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–ª–æ–π
3. –ù–∞–∂–º–∏ **"..." ‚Üí Redeploy**
4. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏: **Redeploy**

–¢–µ–ø–µ—Ä—å –±–æ—Ç –∑–Ω–∞–µ—Ç —Ç–≤–æ–∏ API-–∫–ª—é—á–∏ YooKassa!

---

## üîó –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Webhook –≤ YooKassa

### 4.1 –ß—Ç–æ —Ç–∞–∫–æ–µ webhook?

Webhook ‚Äî —ç—Ç–æ URL, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π YooKassa –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–ª–∞—Ç–µ–∂–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ø–ª–∞—Ç–µ–∂ –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ").

### 4.2 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook URL

1. –í–µ—Ä–Ω–∏—Å—å –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç YooKassa
2. –û—Ç–∫—Ä–æ–π —Å–≤–æ–π –º–∞–≥–∞–∑–∏–Ω
3. –ü–µ—Ä–µ–π–¥–∏ –≤ **"–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è" ‚Üí "HTTP-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"**
4. –ù–∞–∂–º–∏ **"–ù–∞—Å—Ç—Ä–æ–∏—Ç—å"**

**–ó–∞–ø–æ–ª–Ω–∏ –¥–∞–Ω–Ω—ã–µ:**

- **URL –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:**
  ```
  https://vkratse.vercel.app/api/yookassa_webhook
  ```
  (–∑–∞–º–µ–Ω–∏ `vkratse` –Ω–∞ –∏–º—è —Ç–≤–æ–µ–≥–æ Vercel –ø—Ä–æ–µ–∫—Ç–∞, –µ—Å–ª–∏ –æ–Ω–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è)

- **–°–æ–±—ã—Ç–∏—è –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:** ‚úÖ –û—Ç–º–µ—Ç—å:
  - ‚úÖ `payment.succeeded` ‚Äî —É—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞
  - ‚úÖ `payment.canceled` ‚Äî –æ—Ç–º–µ–Ω–µ–Ω–Ω–∞—è –æ–ø–ª–∞—Ç–∞

- **–§–æ—Ä–º–∞—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:**
  - ‚úÖ JSON

- **–í–µ—Ä—Å–∏—è API:**
  - –í—ã–±–µ—Ä–∏ **–ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é** (–æ–±—ã—á–Ω–æ —Å–∞–º–∞—è –Ω–æ–≤–∞—è)

5. –ù–∞–∂–º–∏ **"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"**

### 4.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ webhook

YooKassa –æ—Ç–ø—Ä–∞–≤–∏—Ç —Ç–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –ï—Å–ª–∏ –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ:
- ‚úÖ –°—Ç–∞—Ç—É—Å: "–†–∞–±–æ—Ç–∞–µ—Ç"
- ‚úÖ –ó–µ–ª–µ–Ω–∞—è –≥–∞–ª–æ—á–∫–∞

–ï—Å–ª–∏ –æ—à–∏–±–∫–∞:
- –ü—Ä–æ–≤–µ—Ä—å URL (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–µ–∑ –æ–ø–µ—á–∞—Ç–æ–∫)
- –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –ø—Ä–æ–µ–∫—Ç –∑–∞–¥–µ–ø–ª–æ–µ–Ω –Ω–∞ Vercel
- –ü–æ—Å–º–æ—Ç—Ä–∏ –ª–æ–≥–∏ –≤ Vercel: **Deployments ‚Üí Functions ‚Üí yookassa_webhook**

---

## üß™ –®–∞–≥ 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π

### 5.1 –í–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞

YooKassa –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π –±–µ–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–µ–Ω–µ–≥.

1. –í –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ YooKassa –∑–∞–π–¥–∏ –≤ **"–ù–∞—Å—Ç—Ä–æ–π–∫–∏" ‚Üí "–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã"**
2. –í–∫–ª—é—á–∏ **"–¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º"**
3. –ü–æ–ª—É—á–∏ **—Ç–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏** (shop_id –∏ secret_key –¥–ª—è —Ç–µ—Å—Ç–∞)

**–û–±–Ω–æ–≤–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ Vercel –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã–µ:**
```
YOOKASSA_SHOP_ID=<—Ç–µ—Å—Ç–æ–≤—ã–π shop_id>
YOOKASSA_SECRET_KEY=<—Ç–µ—Å—Ç–æ–≤—ã–π secret_key>
```

### 5.2 –¢–µ—Å—Ç–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞

1. –û—Ç–∫—Ä–æ–π –±–æ—Ç–∞ –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å `/premium`
3. –ù–∞–∂–º–∏ **"üí≥ –ö—É–ø–∏—Ç—å Pro"**
4. –ù–∞–∂–º–∏ **"üí≥ –ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞"**
5. –ù–∞–∂–º–∏ **"üí≥ –û–ø–ª–∞—Ç–∏—Ç—å"** ‚Äî –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –æ–ø–ª–∞—Ç—ã YooKassa

**–ò—Å–ø–æ–ª—å–∑—É–π —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã:**
- **–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã:** `4111 1111 1111 1111`
- **–°—Ä–æ–∫:** –ª—é–±–æ–π –≤ –±—É–¥—É—â–µ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, `12/25`)
- **CVV:** –ª—é–±–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `123`)
- **–ò–º—è:** –ª—é–±–æ–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `TEST CARD`)

6. –ù–∞–∂–º–∏ **"–û–ø–ª–∞—Ç–∏—Ç—å"**
7. –ü–ª–∞—Ç–µ–∂ –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–π—Ç–∏ —É—Å–ø–µ—à–Ω–æ
8. –ß–µ—Ä–µ–∑ 1-5 —Å–µ–∫—É–Ω–¥ –±–æ—Ç –¥–æ–ª–∂–µ–Ω –ø—Ä–∏—Å–ª–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ: **"üéâ –û–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ!"**
9. –û—Ç–ø—Ä–∞–≤—å `/mystatus` ‚Äî –¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å **"üíé Pro"**

### 5.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –ø—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏:

**–õ–æ–≥–∏ Vercel:**
1. –ó–∞–π–¥–∏ –≤ Vercel ‚Üí Deployments ‚Üí Functions
2. –ù–∞–π–¥–∏ —Ñ—É–Ω–∫—Ü–∏—é `yookassa_webhook`
3. –°–º–æ—Ç—Ä–∏ –ª–æ–≥–∏:
   - ‚úÖ –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `Payment created successfully`
   - ‚úÖ –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `Subscription activated successfully`

**–õ–æ–≥–∏ YooKassa:**
1. –ó–∞–π–¥–∏ –≤ YooKassa ‚Üí –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
2. –ù–∞–π–¥–∏ —Å–≤–æ–π —Ç–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂
3. –ü—Ä–æ–≤–µ—Ä—å:
   - –°—Ç–∞—Ç—É—Å: `succeeded`
   - Webhook –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω: ‚úÖ

### 5.4 –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –±–æ–µ–≤–æ–π —Ä–µ–∂–∏–º

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

1. –í YooKassa –æ—Ç–∫–ª—é—á–∏ **"–¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º"**
2. –ü–æ–ª—É—á–∏ **–±–æ–µ–≤—ã–µ –∫–ª—é—á–∏** (shop_id –∏ secret_key)
3. –û–±–Ω–æ–≤–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ Vercel –Ω–∞ –±–æ–µ–≤—ã–µ:
   ```
   YOOKASSA_SHOP_ID=<–±–æ–µ–≤–æ–π shop_id>
   YOOKASSA_SECRET_KEY=<–±–æ–µ–≤–æ–π secret_key>
   ```
4. Redeploy –ø—Ä–æ–µ–∫—Ç–∞ –≤ Vercel

–ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –ø–æ–∫—É–ø–∞—Ç—å Pro —á–µ—Ä–µ–∑ —Ä–µ–∞–ª—å–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏.

---

## üõ†Ô∏è –®–∞–≥ 6: –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏

### 6.1 –ö–æ–º–∞–Ω–¥–∞ /grantpro (–¥–ª—è –∞–¥–º–∏–Ω–∞)

–¢—ã –º–æ–∂–µ—à—å –≤—Ä—É—á–Ω—É—é –≤—ã–¥–∞–≤–∞—Ç—å Pro-–ø–æ–¥–ø–∏—Å–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –¥—Ä—É–∑–µ–π, —Ç–µ—Å—Ç–µ—Ä–æ–≤, –¥–æ–Ω–∞—Ç–æ–≤ —á–µ—Ä–µ–∑ Tribute).

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```
/grantpro <user_id> <days>
```

**–ü—Ä–∏–º–µ—Ä—ã:**
```bash
# –î–∞—Ç—å –¥—Ä—É–≥—É Pro –Ω–∞ 30 –¥–Ω–µ–π
/grantpro 123456789 30

# –î–∞—Ç—å VIP –∫–ª–∏–µ–Ω—Ç—É Pro –Ω–∞ 1 –≥–æ–¥
/grantpro 987654321 365

# –î–∞—Ç—å —Ç–µ—Å—Ç–µ—Ä—É Pro –Ω–∞ 7 –¥–Ω–µ–π
/grantpro 111222333 7
```

**–ö–∞–∫ —É–∑–Ω–∞—Ç—å user_id:**
1. –ü–æ–ø—Ä–æ—Å–∏ —á–µ–ª–æ–≤–µ–∫–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å `/mystatus` –≤ –±–æ—Ç–∞
2. –ó–∞–π–¥–∏ –≤ Supabase ‚Üí Table Editor ‚Üí `subscriptions`
3. –ù–∞–π–¥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –∏–º–µ–Ω–∏ –∏–ª–∏ –≤—Ä–µ–º–µ–Ω–∏
4. –°–∫–æ–ø–∏—Ä—É–π `user_id`

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ ‚Äî —á–µ—Ä–µ–∑ –±–æ—Ç–∞:**
- –ü–æ–ø—Ä–æ—Å–∏ —á–µ–ª–æ–≤–µ–∫–∞ –Ω–∞–ø–∏—Å–∞—Ç—å –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É
- –ü–æ—Å–º–æ—Ç—Ä–∏ –ª–æ–≥–∏ Vercel ‚Üí –Ω–∞–π–¥–∏ `user_id` –≤ –ª–æ–≥–∞—Ö

### 6.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫ –≤ –ë–î

**–ß–µ—Ä–µ–∑ Supabase:**
1. –ó–∞–π–¥–∏ –≤ https://supabase.com/
2. –û—Ç–∫—Ä–æ–π —Å–≤–æ–π –ø—Ä–æ–µ–∫—Ç
3. –ü–µ—Ä–µ–π–¥–∏ –≤ **Table Editor ‚Üí subscriptions**
4. –ó–¥–µ—Å—å —Ç—ã —É–≤–∏–¥–∏—à—å –≤—Å–µ –ø–æ–¥–ø–∏—Å–∫–∏:
   - `user_id` ‚Äî –∫—Ç–æ
   - `tier` ‚Äî —Ç–∞—Ä–∏—Ñ (`free` –∏–ª–∏ `pro`)
   - `expires_at` ‚Äî –∫–æ–≥–¥–∞ –∏—Å—Ç–µ–∫–∞–µ—Ç
   - `payment_method` ‚Äî –∫–∞–∫ –æ–ø–ª–∞—Ç–∏–ª (`yookassa`, `tribute`, –∏–ª–∏ `manual_grant`)
   - `is_active` ‚Äî –∞–∫—Ç–∏–≤–Ω–∞ –ª–∏ –ø–æ–¥–ø–∏—Å–∫–∞

**SQL –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```sql
-- –í—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ Pro-–ø–æ–¥–ø–∏—Å–∫–∏
SELECT user_id, tier, expires_at, payment_method
FROM subscriptions
WHERE is_active = true AND tier = 'pro'
ORDER BY created_at DESC;

-- –ü–æ–¥–ø–∏—Å–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å–∫–æ—Ä–æ –∏—Å—Ç–µ–∫—É—Ç (–≤ —Ç–µ—á–µ–Ω–∏–µ 7 –¥–Ω–µ–π)
SELECT user_id, expires_at,
       DATE_PART('day', expires_at - NOW()) as days_left
FROM subscriptions
WHERE is_active = true
  AND expires_at IS NOT NULL
  AND expires_at < NOW() + INTERVAL '7 days'
ORDER BY expires_at ASC;

-- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
SELECT
  tier,
  COUNT(*) as count,
  SUM(CASE WHEN is_active THEN 1 ELSE 0 END) as active_count
FROM subscriptions
GROUP BY tier;
```

### 6.3 –û—Ç–∑—ã–≤ –ø–æ–¥–ø–∏—Å–∫–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –æ—Ç–∫–ª—é—á–∏—Ç—å —á—å—é-—Ç–æ –ø–æ–¥–ø–∏—Å–∫—É:

**–ß–µ—Ä–µ–∑ Supabase SQL Editor:**
```sql
-- –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
UPDATE subscriptions
SET is_active = false, updated_at = NOW()
WHERE user_id = <user_id>;
```

**–ß–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –≤ –±—É–¥—É—â–µ–º):**
```
/revokepro <user_id>
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:

1. **Conversion rate (–∫–æ–Ω–≤–µ—Ä—Å–∏—è):**
   - –°–∫–æ–ª—å–∫–æ % –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ–∫—É–ø–∞—é—Ç Pro –ø–æ—Å–ª–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ `/premium`
   - –¶–µ–ª—å: 3-5%

2. **Revenue (–≤—ã—Ä—É—á–∫–∞):**
   - –°–∫–æ–ª—å–∫–æ –¥–µ–Ω–µ–≥ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ —á–µ—Ä–µ–∑ YooKassa
   - –°–º–æ—Ç—Ä–∏ –≤ YooKassa ‚Üí –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

3. **Churn rate (–æ—Ç—Ç–æ–∫):**
   - –°–∫–æ–ª—å–∫–æ % –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ –ø—Ä–æ–¥–ª–µ–≤–∞—é—Ç –ø–æ–¥–ø–∏—Å–∫—É
   - SQL –∑–∞–ø—Ä–æ—Å –≤—ã—à–µ (–ø–æ–¥–ø–∏—Å–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å—Ç–µ–∫–ª–∏)

4. **Active Pro users:**
   ```sql
   SELECT COUNT(*) FROM subscriptions
   WHERE tier = 'pro' AND is_active = true;
   ```

---

## üö® Troubleshooting (–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º)

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ö–Ω–æ–ø–∫–∞ "–ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞" –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** YooKassa –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏–ª–∏ –∫–ª—é—á–∏ –Ω–µ–≤–µ—Ä–Ω—ã–µ

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ Vercel: `YOOKASSA_SHOP_ID` –∏ `YOOKASSA_SECRET_KEY`
2. –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –æ–Ω–∏ –Ω–µ –ø—É—Å—Ç—ã–µ
3. Redeploy –ø—Ä–æ–µ–∫—Ç–∞

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –û—à–∏–±–∫–∞ "–û–ø–ª–∞—Ç–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–≤–µ—Ä–Ω—ã–µ API-–∫–ª—é—á–∏

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å –∫–ª—é—á–∏ –≤ YooKassa (—Å–∫–æ–ø–∏—Ä—É–π –∑–∞–Ω–æ–≤–æ)
2. –û–±–Ω–æ–≤–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ Vercel
3. Redeploy

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ü–ª–∞—Ç–µ–∂ –ø—Ä–æ—à–µ–ª, –Ω–æ –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª–∞—Å—å

**–ü—Ä–∏—á–∏–Ω–∞:** Webhook –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª –∏–ª–∏ –æ—à–∏–±–∫–∞ –≤ –∫–æ–¥–µ

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ Vercel ‚Üí Functions ‚Üí `yookassa_webhook`
2. –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `Subscription activated successfully`
3. –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Äî —Å–º–æ—Ç—Ä–∏ —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏
4. –ü—Ä–æ–≤–µ—Ä—å –ë–î: –µ—Å—Ç—å –ª–∏ –∑–∞–ø–∏—Å—å –≤ `subscriptions`?

**–†—É—á–Ω–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è:**
```bash
# –ï—Å–ª–∏ –ø–ª–∞—Ç–µ–∂ –ø—Ä–æ—à–µ–ª, –Ω–æ –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª—Å—è - –∞–∫—Ç–∏–≤–∏—Ä—É–π –≤—Ä—É—á–Ω—É—é
/grantpro <user_id> 30
```

### –ü—Ä–æ–±–ª–µ–º–∞ 4: Webhook –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 500 –æ—à–∏–±–∫—É

**–ü—Ä–∏—á–∏–Ω–∞:** –û—à–∏–±–∫–∞ –≤ –∫–æ–¥–µ webhook

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ Vercel
2. –ù–∞–π–¥–∏ —Å—Ç—Ä–æ–∫—É —Å –æ—à–∏–±–∫–æ–π (traceback)
3. –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
   - –ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–∞–∫–µ—Ç `yookassa` (–¥–æ–±–∞–≤—å –≤ `requirements.txt`)
   - –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Supabase
   - –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö

---

## üí° –°–æ–≤–µ—Ç—ã –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### ‚úÖ –ß—Ç–æ –¥–µ–ª–∞—Ç—å:
- –•—Ä–∞–Ω–∏—Ç—å API-–∫–ª—é—á–∏ —Ç–æ–ª—å–∫–æ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è Vercel
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å webhook –æ—Ç YooKassa (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ –∫–æ–¥–µ)
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –ø–ª–∞—Ç–µ–∂–∏ –¥–ª—è –∞—É–¥–∏—Ç–∞
- –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ë–î –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

### ‚ùå –ß–µ–≥–æ –ù–ï –¥–µ–ª–∞—Ç—å:
- ‚ùå –ù–µ –∫–æ–º–º–∏—Ç—å API-–∫–ª—é—á–∏ –≤ Git
- ‚ùå –ù–µ –¥–µ–ª–∏—Ç—å—Å—è –∫–ª—é—á–∞–º–∏ —Å –¥—Ä—É–≥–∏–º–∏ –ª—é–¥—å–º–∏
- ‚ùå –ù–µ –≤—ã–∫–ª—é—á–∞—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π
- ‚ùå –ù–µ –¥–∞–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ Supabase –ø–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–º

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

**–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

1. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ Vercel
2. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ YooKassa
3. –ü—Ä–æ–≤–µ—Ä—å –ë–î Supabase
4. –ù–∞–ø–∏—à–∏ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É YooKassa: https://yookassa.ru/support

**–ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏:**
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è YooKassa API: https://yookassa.ru/developers/api
- Webhooks YooKassa: https://yookassa.ru/developers/using-api/webhooks
- –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ: https://yookassa.ru/developers/payment-acceptance/testing-and-going-live/testing

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-11-17
**–í–µ—Ä—Å–∏—è:** 1.0
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
